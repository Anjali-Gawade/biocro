<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>BioCro: src/CropGro.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BioCro
   &#160;<span id="projectnumber">0.92</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_crop_gro_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">CropGro.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;R.h&gt;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;Rmath.h&gt;</code><br/>
<code>#include &lt;Rinternals.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="">c3photo.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">AuxBioCro.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">Century.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">BioCro.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">AuxwillowGro.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">AuxcaneGro.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">crocent.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">c3canopy.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">soilwater.h</a>&quot;</code><br/>
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for CropGro.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="_crop_gro_8c__incl.png" border="0" usemap="#src_2_crop_gro_8c" alt=""/></div>
<map name="src_2_crop_gro_8c" id="src_2_crop_gro_8c">
<area shape="rect" id="node11" href="c3photo_8h.html" title="c3photo.h" alt="" coords="333,83,411,112"/><area shape="rect" id="node13" href="_aux_bio_cro_8h.html" title="AuxBioCro.h" alt="" coords="435,83,531,112"/><area shape="rect" id="node15" href="_century_8h.html" title="Century.h" alt="" coords="555,83,632,112"/><area shape="rect" id="node17" href="_bio_cro_8h.html" title="BioCro.h" alt="" coords="656,83,728,112"/><area shape="rect" id="node19" href="_auxwillow_gro_8h.html" title="AuxwillowGro.h" alt="" coords="752,83,864,112"/><area shape="rect" id="node21" href="_auxcane_gro_8h.html" title="AuxcaneGro.h" alt="" coords="888,83,992,112"/><area shape="rect" id="node23" href="crocent_8h.html" title="crocent.h" alt="" coords="1016,83,1091,112"/><area shape="rect" id="node25" href="c3canopy_8h.html" title="c3canopy.h" alt="" coords="120,83,208,112"/><area shape="rect" id="node31" href="soilwater_8h.html" title="soilwater.h" alt="" coords="1115,83,1200,112"/><area shape="rect" id="node35" href="swconst_8h.html" title="swconst.h" alt="" coords="1164,160,1247,189"/></map>
</div>
</div>
<p><a href="">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a53d7927717a599140da5f56aa87aa6a0"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_crop_gro_8c.html#a53d7927717a599140da5f56aa87aa6a0">CropGro</a> (SEXP LAT, SEXP DOY, SEXP HR, SEXP SOLAR, SEXP TEMP, SEXP RH, SEXP WINDSPEED, SEXP PRECIP, SEXP KD, SEXP CHILHF, SEXP NLAYERS, SEXP RHIZOME, SEXP IRTL, SEXP SENCOEFS, SEXP TIMESTEP, SEXP VECSIZE, SEXP SPLEAF, SEXP SPD, SEXP DBPCOEFS, SEXP THERMALP, SEXP VMAX, SEXP ALPHA, SEXP KPARM, SEXP THETA, SEXP BETA, SEXP RD, SEXP CATM, SEXP B0, SEXP B1, SEXP WS, SEXP SOILCOEFS, SEXP ILEAFN, SEXP KLN, SEXP VMAXB1, SEXP ALPHAB1, SEXP MRESP, SEXP SOILTYPE, SEXP WSFUN, SEXP CENTCOEFS, SEXP CENTTIMESTEP, SEXP CENTKS, SEXP SOILLAYERS, SEXP SOILDEPTHS, SEXP CWS, SEXP HYDRDIST, SEXP SECS, SEXP KPLN, SEXP LNB0, SEXP LNB1, SEXP LNFUN, SEXP UPPERTEMP, SEXP LOWERTEMP, SEXP NNITROP)</td></tr>
</table>
<h2>Function Documentation</h2>
<a class="anchor" id="a53d7927717a599140da5f56aa87aa6a0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP CropGro </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>DOY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>HR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SOLAR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>TEMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>WINDSPEED</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>PRECIP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>KD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CHILHF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>NLAYERS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>RHIZOME</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>IRTL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SENCOEFS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>TIMESTEP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>VECSIZE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SPLEAF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SPD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>DBPCOEFS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>THERMALP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>VMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>ALPHA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>KPARM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>THETA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>BETA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>RD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CATM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>B0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>B1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>WS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SOILCOEFS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>ILEAFN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>KLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>VMAXB1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>ALPHAB1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>MRESP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SOILTYPE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>WSFUN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CENTCOEFS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CENTTIMESTEP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CENTKS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SOILLAYERS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SOILDEPTHS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CWS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>HYDRDIST</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SECS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>KPLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LNB0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LNB1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LNFUN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>UPPERTEMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LOWERTEMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>NNITROP</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check if today is harvest day</p>
<p>Here is calculation for situations when plan is not emerged</p>
<p>Check if today is emergence day, IF yes, it will set emergence =1 for next day simulation</p>
<p>if today indeed is emergence day then we also need to initialze leaf biomass based on storage pool to initiate simulations </p>

<p>Definition at line <a class="el" href="#L21">21</a> of file <a class="el" href="">CropGro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> vecsize = INTEGER(VECSIZE)[0];</div>
<div class="line">    <span class="keywordtype">int</span> dailyvecsize = vecsize/24;</div>
<div class="line"><span class="comment">//    Rprintf(&quot;%i\n&quot;,vecsize);</span></div>
<div class="line">   <span class="comment">/*********** CROCENT VARIABLES***********************/</span></div>
<div class="line">   <span class="keyword">struct </span><a class="code" href="structcropcentlayer.html">cropcentlayer</a> CROPCENT;</div>
<div class="line">   <span class="keywordtype">int</span> woody, Eflag;</div>
<div class="line">   woody = 0 ; <span class="comment">// No woody Material for now</span></div>
<div class="line">   Eflag = 1; <span class="comment">// For N simulations only</span></div>
<div class="line">   <span class="keywordtype">double</span> *fake;</div>
<div class="line">   <span class="comment">// Get Defaukt parameters for miscanthus</span></div>
<div class="line">     <a class="code" href="_assigncropcent_8c.html#ac95e9f75a998d941291681ea065ee38e">assignParms</a>(&amp;CROPCENT, fake);</div>
<div class="line">  <span class="comment">// Get Initial Values oof Pool for C and N</span></div>
<div class="line">     <a class="code" href="_assigncropcent_8c.html#aa800d4852cda5d0362eae9366cdeee70">assignPools</a>(&amp;CROPCENT, fake);</div>
<div class="line">  <span class="comment">// More parameters   </span></div>
<div class="line">     <a class="code" href="_assigncropcent_8c.html#a783ef28de1722cd406c8eef2b000e83f">GetBioCroToCropcentParms</a>(&amp;CROPCENT.BcroTOCentParms,fake);</div>
<div class="line">   <span class="comment">// Timestep is alreadt set to 1440.0 minutes (1 day) in the assignParms. We need to change the parameters to daily time step</span></div>
<div class="line">     <a class="code" href="_assigncropcent_8c.html#ad109903050f83c92d9d656f66b4f12a1">CROPCENTTimescaling</a>(&amp;CROPCENT);</div>
<div class="line">     </div>
<div class="line">   <span class="keyword">struct </span><a class="code" href="struct_input_to_cropcent.html">InputToCropcent</a> leaflitter,stemlitter,rootlitter,rhizomelitter;</div>
<div class="line">   <span class="keyword">struct </span><a class="code" href="structminerals.html">minerals</a> leaflitterE,stemlitterE,rootlitterE,rhizomelitterE;</div>
<div class="line">   <span class="comment">// The below parameters aee RCESTR from fix.100 representing CE Ratio of structural material</span></div>
<div class="line">   leaflitterE.<a class="code" href="structminerals.html#a4f81bac66d6b9aa12266f35121bb8405">CN</a>=200.0;</div>
<div class="line">   leaflitterE.CP=500.0;</div>
<div class="line">   leaflitterE.CS=500.0;</div>
<div class="line">   leaflitterE.CS=500.0;</div>
<div class="line">   stemlitterE = leaflitterE;</div>
<div class="line">   rootlitterE=  leaflitterE;</div>
<div class="line">   rhizomelitterE=leaflitterE;</div>
<div class="line">   <span class="comment">/*************************************************/</span></div>
<div class="line">   </div>
<div class="line">   <span class="comment">/*********Tracegas Calculation Variables ***********/</span></div>
<div class="line">   </div>
<div class="line">    <a class="code" href="struct_s_i_t_e_p_a_r___s.html">SITEPAR_SPT</a> sitepar;</div>
<div class="line">    <a class="code" href="struct_l_a_y_e_r_p_a_r___s.html">LAYERPAR_SPT</a> layers;</div>
<div class="line">    <a class="code" href="struct_s_o_i_l___s.html">SOIL_SPT</a> soil;</div>
<div class="line">     <span class="keywordtype">double</span> *fakedouble,newminrl, ammonium,nitrate[50],sand,silt,clay,afiel,bulkd,maxt,ppt,snow,avgwfps,stormf,basef,frlechd[50],stream[60],inorglch;</div>
<div class="line">       <span class="keywordtype">double</span> critflow,wfluxout[60],newCO2,NOflux,Nn2oflux,Dn2oflux,Dn2flux,CH4,grass_lai,tree_lai,NOabsorp_grass,NOabsorp_tree,nit_amt,nreduce;</div>
<div class="line">       <span class="keywordtype">double</span> dN2lyr[60],dN2Olyr[60];  </div>
<div class="line">       <span class="keywordtype">int</span> *fakeint,texture,isdecid,isagri,jday,iindex;</div>
<div class="line">       afiel=0.3;</div>
<div class="line">       ammonium=0.0;</div>
<div class="line">       newminrl=0.0;</div>
<div class="line">       avgwfps=0.5;</div>
<div class="line">       basef=0.0;</div>
<div class="line">       bulkd=1.2;</div>
<div class="line">       CH4=0.0;</div>
<div class="line">       sand=0.33;</div>
<div class="line">       silt=0.33;</div>
<div class="line">       clay=0.33;</div>
<div class="line">       critflow=1.0;</div>
<div class="line">       inorglch=0.0;</div>
<div class="line">       isdecid=0;</div>
<div class="line">       isagri=1;</div>
<div class="line">       jday=180;</div>
<div class="line">       maxt=15;</div>
<div class="line">       newCO2=0.0;</div>
<div class="line">       newminrl=0.0;</div>
<div class="line">       ppt=0.0;</div>
<div class="line">       stormf=0.0;</div>
<div class="line">       texture=1;</div>
<div class="line">       grass_lai=0.0;</div>
<div class="line">       tree_lai=0.0;</div>
<div class="line">       <span class="keywordflow">for</span> (iindex=0;iindex&lt;60;iindex++){</div>
<div class="line">         frlechd[iindex]=0.0;</div>
<div class="line">         stream[iindex]=0.0;</div>
<div class="line">         wfluxout[iindex]=0.0;</div>
<div class="line">         dN2lyr[iindex]=0.0;</div>
<div class="line">         dN2Olyr[iindex]=0.0;</div>
<div class="line">       }</div>
<div class="line">       </div>
<div class="line">   <span class="comment">/*******************************************************/</span></div>
<div class="line"></div>
<div class="line">   </div>
<div class="line">   <span class="keyword">struct </span><a class="code" href="structcrop__phenology.html">crop_phenology</a> cropdbp;</div>
<div class="line">   <span class="keyword">static</span> <span class="keyword">struct </span><a class="code" href="structmiscanthus.html">miscanthus</a> <a class="code" href="structmiscanthus.html">miscanthus</a>, deltamiscanthus;</div>
<div class="line">   <a class="code" href="_aux_crop_gro_8c.html#acbe388bd045a9173d61d6f848716df52">createNULLmiscanthus</a>(&amp;<a class="code" href="structmiscanthus.html">miscanthus</a>,vecsize);</div>
<div class="line"></div>
<div class="line"><span class="comment">//   miscanthus.leafvec[vecsize].newbiomass=(double)vecsize;</span></div>
<div class="line"><span class="comment">//   Rprintf(&quot;%f, %i\n&quot;,miscanthus.leafvec[vecsize].newbiomass, vecsize);</span></div>
<div class="line">   <span class="keywordtype">double</span> dailynetassim, CanopyAGross, dailyGPP;</div>
<div class="line">   <span class="keywordtype">double</span> mrespLeaf, mrespStem, mrespRoot, mrespRhizome;</div>
<div class="line">   <span class="keyword">struct </span><a class="code" href="structsenthermaltemp.html">senthermaltemp</a> <a class="code" href="structsenthermaltemp.html">senthermaltemp</a>;</div>
<div class="line">   <span class="keyword">struct </span><a class="code" href="structcanopyparms.html">canopyparms</a> <a class="code" href="structcanopyparms.html">canopyparms</a>;</div>
<div class="line">   <span class="keyword">struct </span><a class="code" href="structfrost_parms.html">frostParms</a> frostparms;</div>
<div class="line">   dailynetassim=0.0;</div>
<div class="line">   dailyGPP=0.0;</div>
<div class="line">   mrespLeaf=0.0;</div>
<div class="line">   mrespStem=0.0;</div>
<div class="line">   mrespRoot=0.0;</div>
<div class="line">   mrespRhizome=0.0;</div>
<div class="line">   frostparms.<a class="code" href="structfrost_parms.html#ac6561f3ade0d5d8062369c736983abe6">leafT0</a>=-8.0;</div>
<div class="line">   frostparms.leafT100=-16.0;</div>
<div class="line">   frostparms.stemT0=-16.0;</div>
<div class="line">   frostparms.stemT100=-16.0;</div>
<div class="line">   </div>
<div class="line">   </div>
<div class="line">   <span class="comment">/***********Management Variables *************/</span></div>
<div class="line">   <span class="keyword">struct </span><a class="code" href="structmanagement.html">management</a> <a class="code" href="structmanagement.html">management</a>;</div>
<div class="line">   <a class="code" href="assign_management_8c.html#ad3cb167916b714752da2abf4065935c1">assignManagement</a>(&amp;<a class="code" href="structmanagement.html">management</a>);</div>
<div class="line">   <span class="comment">/********************************************/</span></div>
<div class="line">   </div>
<div class="line">        <span class="comment">/* This creates vectors which will collect the senesced plant</span></div>
<div class="line"><span class="comment">           material. This is needed to calculate litter and therefore carbon</span></div>
<div class="line"><span class="comment">           in the soil and then N in the soil. */</span></div>
<div class="line"></div>
<div class="line">         <span class="keywordtype">double</span> upperT=REAL(UPPERTEMP)[0];</div>
<div class="line">         <span class="keywordtype">double</span> lowerT=REAL(LOWERTEMP)[0];</div>
<div class="line"><span class="comment">/*Reading NitroP Variables */</span></div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structnitro_parms.html">nitroParms</a> nitroparms;</div>
<div class="line">        <span class="keywordtype">double</span> TEMPdoubletoint;</div>
<div class="line">        nitroparms.<a class="code" href="structnitro_parms.html#a81548389d7bb414fbf85c27cc1df21ad">ileafN</a>=REAL(NNITROP)[0];</div>
<div class="line">  nitroparms.kln=REAL(NNITROP)[1];</div>
<div class="line">        nitroparms.Vmaxb1=REAL(NNITROP)[2];</div>
<div class="line">        nitroparms.Vmaxb0=REAL(NNITROP)[3];</div>
<div class="line">        nitroparms.alphab1=REAL(NNITROP)[4];</div>
<div class="line">        nitroparms.alphab0=REAL(NNITROP)[5];</div>
<div class="line">  nitroparms.Rdb1=REAL(NNITROP)[6];</div>
<div class="line">        nitroparms.Rdb0=REAL(NNITROP)[7];</div>
<div class="line">        nitroparms.kpLN=REAL(NNITROP)[8];</div>
<div class="line">        nitroparms.lnb0=REAL(NNITROP)[9];</div>
<div class="line">        nitroparms.lnb1=REAL(NNITROP)[10];</div>
<div class="line">        TEMPdoubletoint=REAL(NNITROP)[11];</div>
<div class="line">        nitroparms.lnFun=(int)TEMPdoubletoint;</div>
<div class="line">        nitroparms.maxln=REAL(NNITROP)[12];</div>
<div class="line">        nitroparms.minln=REAL(NNITROP)[13];</div>
<div class="line">        nitroparms.daymaxln=REAL(NNITROP)[14];</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">double</span> iSp, Sp , propLeaf;</div>
<div class="line">        <span class="keywordtype">int</span> i, i2, i3;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> vmax1;</div>
<div class="line">        <span class="keywordtype">double</span> alpha1;</div>
<div class="line">        <span class="keywordtype">double</span> kparm1;</div>
<div class="line">        <span class="keywordtype">double</span> theta;</div>
<div class="line">        <span class="keywordtype">double</span> beta;</div>
<div class="line">        <span class="keywordtype">double</span> Rd1, Ca;</div>
<div class="line">        <span class="keywordtype">double</span> b01, b11;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> Leaf, Stem, Root, LAI, Grain = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> TTc = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> kLeaf = 0.0, kStem = 0.0, kRoot = 0.0, kRhizome = 0.0, kGrain = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> newLeaf, newStem = 0.0, newRoot, newRhizome, newGrain = 0.0;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Variables needed for collecting litter */</span></div>
<div class="line">        <span class="keywordtype">double</span> LeafLitter = REAL(CENTCOEFS)[20], StemLitter = REAL(CENTCOEFS)[21];</div>
<div class="line">        <span class="keywordtype">double</span> RootLitter = REAL(CENTCOEFS)[22], RhizomeLitter = REAL(CENTCOEFS)[23];</div>
<div class="line">        <span class="keywordtype">double</span> LeafLitter_d = 0.0, StemLitter_d = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> RootLitter_d = 0.0, RhizomeLitter_d = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> ALitter = 0.0, BLitter = 0.0;</div>
<div class="line">        <span class="comment">/* Maintenance respiration */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> mrc1 = REAL(MRESP)[0];</div>
<div class="line">        <span class="keywordtype">double</span> mrc2 = REAL(MRESP)[1]; </div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> waterCont;</div>
<div class="line">        <span class="keywordtype">double</span> StomWS = 1, LeafWS = 1;</div>
<div class="line">        <span class="keywordtype">int</span> timestep;</div>
<div class="line">        <span class="keywordtype">double</span> CanopyA, CanopyT;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> Rhizome;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Soil Parameters*/</span></div>
<div class="line">        <span class="keywordtype">double</span> FieldC, WiltP, phi1, phi2, soilDepth;</div>
<div class="line">        <span class="keywordtype">int</span> soilType, wsFun;</div>
<div class="line">        <span class="keywordtype">double</span> LeafN, LeafN_0, kLN;</div>
<div class="line">        <span class="keywordtype">double</span> soilEvap, TotEvap;</div>
<div class="line">        <span class="keywordtype">int</span> soillayers = INTEGER(SOILLAYERS)[0];</div>
<div class="line">        <span class="keywordtype">double</span> cwsVec[soillayers];</div>
<div class="line">        <span class="keywordflow">for</span>(i2=0;i2&lt;soillayers;i2++){</div>
<div class="line">                cwsVec[i2] = REAL(CWS)[i2];</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordtype">double</span> cwsVecSum = 0.0;</div>
<div class="line">        <span class="comment">/* Some soil related empirical coefficients */</span></div>
<div class="line">        <span class="keywordtype">double</span> rfl = REAL(SECS)[0];  <span class="comment">/* root factor lambda */</span></div>
<div class="line">        <span class="keywordtype">double</span> rsec = REAL(SECS)[1]; <span class="comment">/* radiation soil evaporation coefficient */</span></div>
<div class="line">        <span class="keywordtype">double</span> rsdf = REAL(SECS)[2]; <span class="comment">/* root soil depth factor */</span></div>
<div class="line">        <span class="keywordtype">double</span> scsf = REAL(SOILCOEFS)[6]; <span class="comment">/* stomatal conductance sensitivity factor */</span> <span class="comment">/* Rprintf(&quot;scsf %.2f&quot;,scsf); */</span></div>
<div class="line">        <span class="keywordtype">double</span> transpRes = REAL(SOILCOEFS)[7]; <span class="comment">/* Resistance to transpiration from soil to leaf */</span></div>
<div class="line">        <span class="keywordtype">double</span> leafPotTh = REAL(SOILCOEFS)[8]; <span class="comment">/* Leaf water potential threshold */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Parameters for calculating leaf water potential */</span></div>
<div class="line">        <span class="keywordtype">double</span> LeafPsim = 0.0;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Effect of Nitrogen */</span></div>
<div class="line">        <span class="keywordtype">double</span> <a class="code" href="structnitro_parms.html#a89b04bb673ac5d9fd455e0b9317bdb83">kpLN</a> = REAL(KPLN)[0];</div>
<div class="line">        <span class="keywordtype">double</span> <a class="code" href="structnitro_parms.html#a980c24e01e429167687e2ab6191f4175">lnb0</a> = REAL(LNB0)[0]; </div>
<div class="line">        <span class="keywordtype">double</span> <a class="code" href="structnitro_parms.html#a4020d72bf2f4de6d518eec319f123e2e">lnb1</a> = REAL(LNB1)[0];</div>
<div class="line">        <span class="keywordtype">int</span> lnfun = INTEGER(LNFUN)[0];</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Century */</span></div>
<div class="line">        <span class="keywordtype">double</span> MinNitro = REAL(CENTCOEFS)[19];</div>
<div class="line">        <span class="keywordtype">int</span> doyNfert = REAL(CENTCOEFS)[18];</div>
<div class="line">        <span class="keywordtype">double</span> Nfert;</div>
<div class="line">        <span class="keywordtype">double</span> SCCs[9];</div>
<div class="line">        <span class="keywordtype">double</span> Resp = 0.0;</div>
<div class="line">        <span class="keywordtype">int</span> centTimestep = INTEGER(CENTTIMESTEP)[0];</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> SeneLeaf, SeneStem, SeneRoot = 0.0, SeneRhizome = 0.0 ;</div>
<div class="line">        <span class="keywordtype">double</span> *sti , *sti2, *sti3, *sti4; </div>
<div class="line">        <span class="keywordtype">double</span> Remob;</div>
<div class="line">        <span class="keywordtype">int</span> k = 0, q = 0, m = 0, n = 0;</div>
<div class="line">        <span class="keywordtype">int</span> ri = 0;</div>
<div class="line"></div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="struct_can___str.html">Can_Str</a> Canopy;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structws__str.html">ws_str</a> WaterS;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structdbp__str.html">dbp_str</a> dbpS;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structcen_t__str.html">cenT_str</a> centS; </div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structsoil_m_l__str.html">soilML_str</a> soilMLS;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structsoil_text__str.html">soilText_str</a> soTexS; <span class="comment">/* , *soTexSp = &amp;soTexS; */</span></div>
<div class="line">        soTexS = <a class="code" href="_aux_bio_cro_8c.html#a72f93049960e067cda6e7291ff1ff21a">soilTchoose</a>(INTEGER(SOILTYPE)[0]);</div>
<div class="line"></div>
<div class="line">        centS.SCs[0] = 0.0;</div>
<div class="line">        centS.SCs[1] = 0.0;</div>
<div class="line">        centS.SCs[2] = 0.0;</div>
<div class="line">        centS.SCs[3] = 0.0;</div>
<div class="line">        centS.SCs[4] = 0.0;</div>
<div class="line">        centS.SCs[5] = 0.0;</div>
<div class="line">        centS.SCs[6] = 0.0;</div>
<div class="line">        centS.SCs[7] = 0.0;</div>
<div class="line">        centS.SCs[8] = 0.0;</div>
<div class="line">        centS.Resp = 0.0;</div>
<div class="line"></div>
<div class="line">        SEXP lists, names;</div>
<div class="line"></div>
<div class="line">        SEXP DayofYear;</div>
<div class="line">        SEXP Hour;</div>
<div class="line">        SEXP <a class="code" href="_bio_cro_8h.html#a5b6e16664a459420103984ac5409b858">CanopyAssim</a>;</div>
<div class="line">        SEXP CanopyTrans;</div>
<div class="line">        SEXP <a class="code" href="_bio_cro_8h.html#abd2c9bad12951c887e8469151c778947">Leafy</a>;</div>
<div class="line">        SEXP <a class="code" href="_bio_cro_8h.html#a929d2badff7fb301509012ee6e6a12e9">Stemy</a>;</div>
<div class="line">        SEXP <a class="code" href="_bio_cro_8h.html#ad6a54d6e671d04cd9b254a8cd1c3315c">Rooty</a>;</div>
<div class="line">        SEXP <a class="code" href="_bio_cro_8h.html#aa3741856cde2b5152c833b543abe77fc">Rhizomey</a>;</div>
<div class="line">        SEXP <a class="code" href="_bio_cro_8h.html#a46f339721a905fe9e6f60af35ec11974">Grainy</a>;</div>
<div class="line">        SEXP <a class="code" href="_bio_cro_8h.html#ac656f07a64aeba7d6ac5a3a536e993c8">LAIc</a>;</div>
<div class="line">        SEXP TTTc;</div>
<div class="line">        SEXP SoilWatCont;</div>
<div class="line">        SEXP StomatalCondCoefs;</div>
<div class="line">        SEXP LeafReductionCoefs;</div>
<div class="line">        SEXP LeafNitrogen;</div>
<div class="line">        SEXP AboveLitter;</div>
<div class="line">        SEXP BelowLitter;</div>
<div class="line">        SEXP VmaxVec;</div>
<div class="line">        SEXP AlphaVec;</div>
<div class="line">        SEXP SpVec;</div>
<div class="line">        SEXP MinNitroVec;</div>
<div class="line">        SEXP RespVec;</div>
<div class="line">        SEXP SoilEvaporation;</div>
<div class="line">        SEXP cwsMat;</div>
<div class="line">        SEXP psimMat; <span class="comment">/* Holds the soil water potential */</span></div>
<div class="line">        SEXP rdMat;</div>
<div class="line">        SEXP SCpools;</div>
<div class="line">        SEXP SNpools;</div>
<div class="line">        SEXP LeafPsimVec;</div>
<div class="line"><span class="comment">// From here, we have daily (instead of hourly) output vectors</span></div>
<div class="line">  SEXP DayafterPlanting;</div>
<div class="line">  SEXP GDD; <span class="comment">// daily vector of growing degree day</span></div>
<div class="line">  SEXP GPP; <span class="comment">// Gross Primary Productivity</span></div>
<div class="line">  SEXP NPP; <span class="comment">// Net Primary Productivity</span></div>
<div class="line">  SEXP autoRESP; <span class="comment">// Autotrophic Respiration</span></div>
<div class="line">  SEXP hetRESP; <span class="comment">// Heterotrophic Respiration</span></div>
<div class="line">  SEXP NER; <span class="comment">// Net Ecosystem Respiration</span></div>
<div class="line">  SEXP StemMResp;</div>
<div class="line">  SEXP RootMResp;</div>
<div class="line">  SEXP RhizomeMResp;</div>
<div class="line">  SEXP LeafDarkResp;</div>
<div class="line">  SEXP Stemd;</div>
<div class="line">  SEXP Leafd;</div>
<div class="line">  SEXP Rootd;</div>
<div class="line">  SEXP Rhizomed;</div>
<div class="line">  SEXP Stemlitterd;</div>
<div class="line">  SEXP Leaflitterd;</div>
<div class="line">  SEXP Rootlitterd;</div>
<div class="line">  SEXP Rhizomelitterd;</div>
<div class="line">  SEXP LAId;</div>
<div class="line">  SEXP totalSOC;</div>
<div class="line">  SEXP <a class="code" href="structstrucc1.html">strucc1</a>;</div>
<div class="line">  SEXP <a class="code" href="structstrucc2.html">strucc2</a>;</div>
<div class="line">  SEXP <a class="code" href="structmetabc1.html">metabc1</a>;</div>
<div class="line">  SEXP <a class="code" href="structmetabc2.html">metabc2</a>;</div>
<div class="line">  SEXP <a class="code" href="structsom1c1.html">som1c1</a>;</div>
<div class="line">  SEXP <a class="code" href="structsom1c2.html">som1c2</a>;</div>
<div class="line">  SEXP <a class="code" href="structsom2c1.html">som2c1</a>;</div>
<div class="line">  SEXP <a class="code" href="structsom2c2.html">som2c2</a>;</div>
<div class="line">  SEXP <a class="code" href="structsom3c.html">som3c</a>;</div>
<div class="line">  SEXP minN;</div>
<div class="line">  </div>
<div class="line"><span class="comment">// Declaring Daily variables</span></div>
<div class="line"> <span class="keywordtype">double</span>  accumulatedGDD=0.0;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">//      vecsize = length(DOY);</span></div>
<div class="line">        PROTECT(lists = allocVector(VECSXP,60));</div>
<div class="line">        PROTECT(names = allocVector(STRSXP,60));</div>
<div class="line"></div>
<div class="line">        PROTECT(DayofYear = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(Hour = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(CanopyAssim = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(CanopyTrans = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(Leafy = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(Stemy = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(Rooty = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(Rhizomey = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(Grainy = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(LAIc = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(TTTc = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(SoilWatCont = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(StomatalCondCoefs = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(LeafReductionCoefs = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(LeafNitrogen = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(AboveLitter = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(BelowLitter = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(VmaxVec = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(AlphaVec = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(SpVec = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(MinNitroVec = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(RespVec = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(SoilEvaporation = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(cwsMat = allocMatrix(REALSXP,soillayers,vecsize));</div>
<div class="line">        PROTECT(psimMat = allocMatrix(REALSXP,soillayers,vecsize));</div>
<div class="line">        PROTECT(rdMat = allocMatrix(REALSXP,soillayers,vecsize));</div>
<div class="line">        PROTECT(SCpools = allocVector(REALSXP,9));</div>
<div class="line">        PROTECT(SNpools = allocVector(REALSXP,9));</div>
<div class="line">        PROTECT(LeafPsimVec = allocVector(REALSXP,vecsize));</div>
<div class="line">  PROTECT(DayafterPlanting = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">  PROTECT(GDD = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">  PROTECT(GPP = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">  PROTECT(NPP = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">  PROTECT(autoRESP = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">  PROTECT(hetRESP = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">  PROTECT(NER = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">  PROTECT(StemMResp= allocVector(REALSXP,dailyvecsize));</div>
<div class="line">  PROTECT(RootMResp = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">  PROTECT(RhizomeMResp = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">  PROTECT(LeafDarkResp = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">  PROTECT(Stemd = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">  PROTECT(Leafd = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">  PROTECT(Rootd = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">  PROTECT(Rhizomed = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">  PROTECT(Stemlitterd = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">  PROTECT(Leaflitterd = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">  PROTECT(Rootlitterd = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">  PROTECT(Rhizomelitterd = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">  PROTECT(LAId = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">  PROTECT(totalSOC = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">  PROTECT(strucc1 = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">   PROTECT(strucc2 = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">  PROTECT(metabc1 = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">  PROTECT(metabc2 = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">   PROTECT(som1c1 = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">  PROTECT(som1c2 = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">  PROTECT(som2c1 = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">   PROTECT(som2c2 = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">  PROTECT(som3c = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">  PROTECT(minN = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">        <span class="comment">/* Picking vmax, alpha and kparm */</span></div>
<div class="line">        vmax1 = REAL(VMAX)[0];</div>
<div class="line">        alpha1 = REAL(ALPHA)[0];</div>
<div class="line">        kparm1 = REAL(KPARM)[0];</div>
<div class="line">        theta = REAL(THETA)[0];</div>
<div class="line">        beta = REAL(BETA)[0];</div>
<div class="line">        Rd1 = REAL(RD)[0];</div>
<div class="line">        Ca = REAL(CATM)[0];</div>
<div class="line">        b01 = REAL(B0)[0];</div>
<div class="line">        b11 = REAL(B1)[0];</div>
<div class="line"></div>
<div class="line">        LeafN_0 = REAL(ILEAFN)[0];</div>
<div class="line">        LeafN = LeafN_0; <span class="comment">/* Initial value of N in the leaf */</span></div>
<div class="line">        kLN = REAL(KLN)[0];</div>
<div class="line">        timestep = INTEGER(TIMESTEP)[0];</div>
<div class="line"></div>
<div class="line">        Rhizome = REAL(RHIZOME)[0];</div>
<div class="line">        Sp = REAL(SPLEAF)[0]; </div>
<div class="line">        SeneLeaf = REAL(SENCOEFS)[0];</div>
<div class="line">        SeneStem = REAL(SENCOEFS)[1];</div>
<div class="line">        SeneRoot = REAL(SENCOEFS)[2];</div>
<div class="line">        SeneRhizome = REAL(SENCOEFS)[3];</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Soil Parameters */</span></div>
<div class="line">        FieldC = REAL(SOILCOEFS)[0];</div>
<div class="line">        WiltP = REAL(SOILCOEFS)[1];</div>
<div class="line">        phi1 = REAL(SOILCOEFS)[2];</div>
<div class="line">        phi2 = REAL(SOILCOEFS)[3];</div>
<div class="line">        soilDepth = REAL(SOILCOEFS)[4];</div>
<div class="line">        waterCont = REAL(SOILCOEFS)[5];</div>
<div class="line">        wsFun = INTEGER(WSFUN)[0];</div>
<div class="line">        soilType = INTEGER(SOILTYPE)[0];</div>
<div class="line"></div>
<div class="line">        SCCs[0] = REAL(CENTCOEFS)[0];</div>
<div class="line">        SCCs[1] = REAL(CENTCOEFS)[1];</div>
<div class="line">        SCCs[2] = REAL(CENTCOEFS)[2];</div>
<div class="line">        SCCs[3] = REAL(CENTCOEFS)[3];</div>
<div class="line">        SCCs[4] = REAL(CENTCOEFS)[4];</div>
<div class="line">        SCCs[5] = REAL(CENTCOEFS)[5];</div>
<div class="line">        SCCs[6] = REAL(CENTCOEFS)[6];</div>
<div class="line">        SCCs[7] = REAL(CENTCOEFS)[7];</div>
<div class="line">        SCCs[8] = REAL(CENTCOEFS)[8];</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">/* Creating pointers to avoid calling functions REAL and INTEGER so much */</span></div>
<div class="line"><span class="comment">//  int *pt_doy=INTEGER(DOY);</span></div>
<div class="line">          <span class="keywordtype">int</span> *pt_doy;</div>
<div class="line">    pt_doy = malloc(vecsize*<span class="keyword">sizeof</span>(pt_doy));</div>
<div class="line">    pt_doy=INTEGER(DOY);</div>
<div class="line">  </div>
<div class="line"><span class="comment">//      int *pt_hr = INTEGER(HR);</span></div>
<div class="line">    <span class="keywordtype">int</span> *pt_hr;</div>
<div class="line">    pt_hr = malloc(vecsize*<span class="keyword">sizeof</span>(pt_hr));</div>
<div class="line">    pt_hr=INTEGER(HR);</div>
<div class="line">    </div>
<div class="line"><span class="comment">//      double *pt_solar = REAL(SOLAR);</span></div>
<div class="line">   <span class="keywordtype">double</span> *pt_solar;</div>
<div class="line">    pt_solar = malloc(vecsize*<span class="keyword">sizeof</span>(pt_solar));</div>
<div class="line">    pt_solar=REAL(SOLAR);</div>
<div class="line">  </div>
<div class="line"><span class="comment">//      double *pt_temp = REAL(TEMP);</span></div>
<div class="line">    <span class="keywordtype">double</span> *pt_temp;</div>
<div class="line">    pt_temp = malloc(vecsize*<span class="keyword">sizeof</span>(pt_temp));</div>
<div class="line">    pt_temp=REAL(TEMP);</div>
<div class="line">    </div>
<div class="line"><span class="comment">//      double *pt_rh = REAL(RH);</span></div>
<div class="line">    <span class="keywordtype">double</span> *pt_rh;</div>
<div class="line">    pt_rh = malloc(vecsize*<span class="keyword">sizeof</span>(pt_rh));</div>
<div class="line">    pt_rh=REAL(RH);</div>
<div class="line"><span class="comment">//      double *pt_windspeed = REAL(WINDSPEED);</span></div>
<div class="line">   <span class="keywordtype">double</span> *pt_windspeed;</div>
<div class="line">    pt_windspeed = malloc(vecsize*<span class="keyword">sizeof</span>(pt_windspeed));</div>
<div class="line">    pt_windspeed=REAL(WINDSPEED);</div>
<div class="line"><span class="comment">//      double *pt_precip = REAL(PRECIP);</span></div>
<div class="line">   <span class="keywordtype">double</span> *pt_precip;</div>
<div class="line">    pt_precip = malloc(vecsize*<span class="keyword">sizeof</span>(pt_precip));</div>
<div class="line">    pt_precip=REAL(PRECIP);</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  </div>
<div class="line">   </div>
<div class="line">        <span class="keywordtype">double</span> lat = REAL(LAT)[0];</div>
<div class="line">        <span class="keywordtype">int</span> nlayers = INTEGER(NLAYERS)[0];</div>
<div class="line">        <span class="keywordtype">int</span> ws = INTEGER(WS)[0];</div>
<div class="line">        <span class="keywordtype">double</span> kd = REAL(KD)[0];</div>
<div class="line">        <span class="keywordtype">double</span> chil = REAL(CHILHF)[0];</div>
<div class="line">        <span class="keywordtype">double</span> hf = REAL(CHILHF)[1];</div>
<div class="line"></div>
<div class="line"> </div>
<div class="line"> <span class="comment">/***Initialize Daily Variables *********/</span></div>
<div class="line">  <span class="keyword">struct </span><a class="code" href="structrespiration_parms.html">respirationParms</a> RESP;</div>
<div class="line"> RESP.<a class="code" href="structrespiration_parms.html#a2b8f8af98aa500e2a5bd146231dfedaf">growth</a>.<a class="code" href="structrespiration_parms_1_1growth.html#ab0a73f309ea34d00f3eea8d26366d2c3">stem</a>=0.3;</div>
<div class="line"> RESP.growth.root=0.3;</div>
<div class="line"> RESP.growth.rhizome=0.3;</div>
<div class="line"> </div>
<div class="line"> RESP.maint.Qstem=2.0;</div>
<div class="line"> RESP.maint.mstem=0.004;</div>
<div class="line"> </div>
<div class="line"> RESP.maint.Qroot=2.0;</div>
<div class="line"> RESP.maint.mroot=0.002;</div>
<div class="line"> </div>
<div class="line"> RESP.maint.Qrhizome=2.0;</div>
<div class="line"> RESP.maint.mrhizome=0.002;</div>
<div class="line"><span class="comment">//  Resp.growth.stem=0.3;</span></div>
<div class="line">  </div>
<div class="line">  <span class="keywordtype">double</span> LeafResp,StemResp,RootResp,RhizResp;  </div>
<div class="line">  <span class="keywordtype">double</span> gRespCoeff = 0.0;</div>
<div class="line">  <span class="keywordtype">double</span> dailydelTT = 0.0;</div>
<div class="line">  <span class="keywordtype">double</span> delTT;</div>
<div class="line">  <span class="keywordtype">double</span> Tbase=0.0;</div>
<div class="line">  dailynetassim=0.0;</div>
<div class="line">  <a class="code" href="structsenthermaltemp.html">senthermaltemp</a>.<a class="code" href="structsenthermaltemp.html#a688b68d1aacbc44584502dc6f7a66d88">leafcriticalT</a>=REAL(SENCOEFS)[0];</div>
<div class="line">  <a class="code" href="structsenthermaltemp.html">senthermaltemp</a>.<a class="code" href="structsenthermaltemp.html#a5775b59366e4cf89b17f63406685808a">stemcriticalT</a>=REAL(SENCOEFS)[1];</div>
<div class="line">  <a class="code" href="structsenthermaltemp.html">senthermaltemp</a>.<a class="code" href="structsenthermaltemp.html#ac2c9b699c368fc385e045ea5c50fbce8">rootcriticalT</a>=REAL(SENCOEFS)[2];</div>
<div class="line">  <a class="code" href="structsenthermaltemp.html">senthermaltemp</a>.<a class="code" href="structsenthermaltemp.html#ad7f2be59c7f19cd8b8b356c1b26a3922">rhizomecriticalT</a>=REAL(SENCOEFS)[3];</div>
<div class="line">  <a class="code" href="structcanopyparms.html">canopyparms</a>.<a class="code" href="structcanopyparms.html#a31204c32df46cd78a4df056e37573f7a">kN</a>=0.1;</div>
<div class="line">  <a class="code" href="structcanopyparms.html">canopyparms</a>.<a class="code" href="structcanopyparms.html#a073e7f8c57776b150c2278ff3f96264a">SLA</a>=0.1;</div>
<div class="line">  <a class="code" href="structcanopyparms.html">canopyparms</a>.<a class="code" href="structcanopyparms.html#a9e8e5b892d7cb6588df32c3f01d683bc">remobFac</a>=0.1;</div>
<div class="line">  <a class="code" href="structcanopyparms.html">canopyparms</a>.<a class="code" href="structcanopyparms.html#a695c51ee644be474b0399175b2bf1015">leafNsen</a>=40;</div>
<div class="line">  frostparms.leafT0=-20.0; <span class="comment">//REAL(FROSTP)[0];</span></div>
<div class="line">  frostparms.leafT100=-20.0;<span class="comment">//REAL(FROSTP)[1];</span></div>
<div class="line">  frostparms.stemT0=-20.0;<span class="comment">//REAL(FROSTP)[2];</span></div>
<div class="line">  frostparms.stemT100=-20.0;<span class="comment">//REAL(FROSTP)[3];</span></div>
<div class="line"> </div>
<div class="line">  propLeaf = REAL(IRTL)[0]; </div>
<div class="line">        <span class="comment">/* It is useful to assume that there is a small amount of</span></div>
<div class="line"><span class="comment">           leaf area at the begining of the growing season. */</span></div>
<div class="line"><span class="comment">//      Leaf = Rhizome * 0.001; </span></div>
<div class="line">        <span class="comment">/* Initial proportion of the rhizome that is turned</span></div>
<div class="line"><span class="comment">           into leaf the first hour */</span></div>
<div class="line"><span class="comment">//      Stem = Rhizome * 0.001;</span></div>
<div class="line"><span class="comment">//      Root = Rhizome * 0.001;</span></div>
<div class="line">          <span class="comment">/**********Assining Canopy Parameters********************/</span></div>
<div class="line">      <a class="code" href="structcanopyparms.html">canopyparms</a>.<a class="code" href="structcanopyparms.html#a9e8e5b892d7cb6588df32c3f01d683bc">remobFac</a>=0.5;</div>
<div class="line">      <span class="keywordtype">int</span> dap=0;</div>
<div class="line">      <span class="comment">/*******************************************************/</span></div>
<div class="line">  <a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a50ee911b9f901fb0d866d8915fecf9db">leaf</a>.<a class="code" href="structleaf.html#a8dcd80e29bb84007d302eeda1dde7c75">biomass</a>=0.0;</div>
<div class="line">  <a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a7a7df69b93e084f801e774fdbfec8c5f">stem</a>.<a class="code" href="structstem.html#a8dcd80e29bb84007d302eeda1dde7c75">biomass</a>=0.0;</div>
<div class="line">  <a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a3c7864ec0d9545a4805365f68740c8f7">root</a>.<a class="code" href="structroot.html#a8dcd80e29bb84007d302eeda1dde7c75">biomass</a>=0.0;</div>
<div class="line">  <a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a32b9df3fd9b9924983e00bd58cfcb093">rhizome</a>.<a class="code" href="structrhizome.html#a8dcd80e29bb84007d302eeda1dde7c75">biomass</a>=<a class="code" href="structmanagement.html">management</a>.<a class="code" href="structmanagement.html#a4b7d3f331ae6c6f522bc2d480d89c31d">emergenceparms</a>.<a class="code" href="structmanagement_1_1emergenceparms.html#a85d5413b4dd197c7d97be33c89c8b541">plantingrate</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">int</span> emergence=0;</div>
<div class="line">  <span class="keyword">struct </span><a class="code" href="structdailyclimate.html">dailyclimate</a> <a class="code" href="structdailyclimate.html">dailyclimate</a>;</div>
<div class="line">  TTc=0.0;</div>
<div class="line">  REAL(TTTc)[0]=TTc;</div>
<div class="line">  </div>
<div class="line">  </div>
<div class="line"> <span class="comment">/**************************************/</span></div>
<div class="line">  <a class="code" href="assign_management_8c.html#aabcd8dd6fd6ab4b6dbb9a7de268c11ff">updateafteremergence</a>(&amp;<a class="code" href="structmiscanthus.html">miscanthus</a>,&amp;<a class="code" href="structmanagement.html">management</a>);</div>
<div class="line">  LAI = <a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a50ee911b9f901fb0d866d8915fecf9db">leaf</a>.<a class="code" href="structleaf.html#a8dcd80e29bb84007d302eeda1dde7c75">biomass</a>*Sp;</div>
<div class="line">  <span class="keywordtype">int</span> phototype;</div>
<div class="line">  phototype=1;</div>
<div class="line">  <span class="comment">// This is specific to willow to avoid harvesting based on day of year</span></div>
<div class="line">  CROPCENT.ENV.minN=12.0; <span class="comment">//120*1000/10000 g N/m2</span></div>
<div class="line">        <span class="keywordflow">for</span>(i=0;i&lt;vecsize;i++)</div>
<div class="line"><span class="comment">//    for(i=0;i&lt;3;i++)</span></div>
<div class="line">        {</div>
<div class="line">                <span class="comment">/* First calculate the elapsed Thermal Time*/</span></div>
<div class="line">                <span class="comment">/* The idea is that here I need to divide by the time step</span></div>
<div class="line"><span class="comment">                   to calculate the thermal time. For example, a 3 hour time interval</span></div>
<div class="line"><span class="comment">                   would mean that the division would need to by 8 */</span></div>
<div class="line"><span class="comment">//       delTT=*(pt_temp+i) / (24/timestep);</span></div>
<div class="line">        delTT=<a class="code" href="_aux_crop_gro_8c.html#abf73158640994c9e3d79af089a3bf3e2">getThermaltime</a>(*(pt_temp+i), Tbase);</div>
<div class="line">        delTT=delTT/24;</div>
<div class="line"><span class="comment">//    dailydelTT+=delTT;</span></div>
<div class="line"><span class="comment">//    Rprintf(&quot;index=%i,temp=%f, delTT= %f\n&quot;, i,*(pt_temp+i),delTT);</span></div>
<div class="line"><span class="comment">//         LAI=6.0;</span></div>
<div class="line">        <span class="keywordflow">if</span>(emergence==0)</div>
<div class="line">            {</div>
<div class="line">            TTc +=delTT;</div>
<div class="line">            REAL(TTTc)[i] =REAL(TTTc)[i-1]+delTT ;</div>
<div class="line">            CanopyA = 0.0;</div>
<div class="line">            CanopyAGross =0.0;</div>
<div class="line">                        CanopyT = 0.0;</div>
<div class="line">            <a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a5d45301a3c18815e58686469cb430dfe">autoresp</a>.<a class="code" href="struct_daily_auto_resp.html#a8d66bb670f4fff50eac6d0af4b34f27d">leafdarkresp</a>=0;</div>
<div class="line">            }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line"><span class="comment">//         Rprintf(&quot;Before Canopy Function, Phototype = %i, i= %i, Assim=%f, Leaf=%f, LAI=%f, Specific Leaf Area = %f \n&quot;, phototype,i, Canopy.Assim, miscanthus.leaf.biomass, LAI,Sp);</span></div>
<div class="line">                        TTc +=delTT;</div>
<div class="line">                        REAL(TTTc)[i] =REAL(TTTc)[i-1]+delTT ;</div>
<div class="line">            </div>
<div class="line">            <span class="keywordflow">if</span>(phototype==1)</div>
<div class="line">            {</div>
<div class="line">                Canopy = <a class="code" href="_aux_bio_cro_8c.html#ad67c5b654f4bceb23717a84244291ea0">CanAC</a>(LAI, *(pt_doy+i), *(pt_hr+i),</div>
<div class="line">                               *(pt_solar+i), *(pt_temp+i),</div>
<div class="line">                               *(pt_rh+i), *(pt_windspeed+i),</div>
<div class="line">                               lat, nlayers,</div>
<div class="line">                               vmax1,alpha1,kparm1,</div>
<div class="line">                               theta,beta,Rd1,Ca,b01,b11,StomWS,</div>
<div class="line">                               ws, kd,</div>
<div class="line">                               chil, hf,LeafN, kpLN, lnb0, lnb1, lnfun,upperT,lowerT,nitroparms);</div>
<div class="line"><span class="comment">//             Rprintf(&quot;C4 canopy\n&quot;);</span></div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span>(phototype==2)</div>
<div class="line">            {</div>
<div class="line">             <span class="keywordtype">double</span> jmax1,o2;</div>
<div class="line">             vmax1=100.0;</div>
<div class="line">             jmax1=180.0;</div>
<div class="line">             o2=210.0;</div>
<div class="line">             b01=0.08;</div>
<div class="line">             b11=5.0;</div>
<div class="line">             theta=0.7;</div>
<div class="line">             Canopy = <a class="code" href="_auxwillow_gro_8c.html#a5a18f68430b9e6ed1be3d294b179f8a6">newc3CanAC</a>(LAI, *(pt_doy+i), *(pt_hr+i),</div>
<div class="line">                       *(pt_solar+i), *(pt_temp+i),</div>
<div class="line">                               *(pt_rh+i), *(pt_windspeed+i),</div>
<div class="line">                               lat, nlayers,</div>
<div class="line">                               vmax1,jmax1,Rd1,Ca,o2,b01,b11,theta,kd,hf,LeafN, kpLN, lnb0, lnb1, lnfun, StomWS, ws);</div>
<div class="line">             Rprintf(<span class="stringliteral">&quot;C3 Canopy\n&quot;</span>);</div>
<div class="line">            }</div>
<div class="line"><span class="comment">//             Rprintf(&quot;After Canopy Function,Phototype= %i, i= %i, Assim=%f, Leaf=%f, LAI=%f, Specific Leaf Area = %f \n&quot;, phototype,i, Canopy.Assim, miscanthus.leaf.biomass, LAI,Sp);</span></div>
<div class="line">                        CanopyA = Canopy.Assim * timestep;</div>
<div class="line">            CanopyAGross =Canopy.GrossAssim*timestep;</div>
<div class="line">                        CanopyT = Canopy.Trans * timestep;</div>
<div class="line"> <span class="comment">//           Rprintf(&quot;NetA=%f, Gross A= %f, Trans=%f \n&quot;,CanopyA, CanopyAGross);</span></div>
<div class="line">            }</div>
<div class="line">                <span class="comment">/* Inserting the multilayer model */</span></div>
<div class="line">                  <span class="keywordflow">if</span>(soillayers &gt; 1)</div>
<div class="line">            {</div>
<div class="line">                        soilMLS = <a class="code" href="_aux_bio_cro_8c.html#a5537e2a57efaaf41b401666bb9e22062">soilML</a>(*(pt_precip+i), CanopyT, &amp;cwsVec[0], soilDepth, REAL(SOILDEPTHS), FieldC, WiltP,</div>
<div class="line">                            phi1, phi2, soTexS, wsFun, INTEGER(SOILLAYERS)[0], <a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a3c7864ec0d9545a4805365f68740c8f7">root</a>.<a class="code" href="structroot.html#a8dcd80e29bb84007d302eeda1dde7c75">biomass</a>, </div>
<div class="line">                                                    LAI, 0.68, *(pt_temp+i), *(pt_solar), *(pt_windspeed+i), *(pt_rh+i), </div>
<div class="line">                                                    INTEGER(HYDRDIST)[0], rfl, rsec, rsdf);</div>
<div class="line"></div>
<div class="line">            StomWS = soilMLS.rcoefPhoto;</div>
<div class="line">            LeafWS = soilMLS.rcoefSpleaf;</div>
<div class="line">            soilEvap = soilMLS.SoilEvapo;</div>
<div class="line">                                <span class="keywordflow">for</span>(i3=0;i3&lt;soillayers;i3++)</div>
<div class="line">                      {</div>
<div class="line">                                        cwsVec[i3] = soilMLS.cws[i3];</div>
<div class="line">                                        cwsVecSum += cwsVec[i3];</div>
<div class="line">                                        REAL(cwsMat)[i3 + i*soillayers] = soilMLS.cws[i3];</div>
<div class="line">                                        REAL(rdMat)[i3 + i*soillayers] = soilMLS.rootDist[i3];</div>
<div class="line">                                  }</div>
<div class="line"></div>
<div class="line">                              waterCont = cwsVecSum / soillayers;</div>
<div class="line">                              cwsVecSum = 0.0;</div>
<div class="line"></div>
<div class="line">                      }</div>
<div class="line">      <span class="keywordflow">else</span></div>
<div class="line">          {</div>
<div class="line"></div>
<div class="line">                        soilEvap = <a class="code" href="_aux_bio_cro_8c.html#ac96acf762dd39d5ff20d71788b0ca566">SoilEvapo</a>(LAI, 0.68, *(pt_temp+i), *(pt_solar+i), waterCont, FieldC, WiltP, </div>
<div class="line">                                                   *(pt_windspeed+i), *(pt_rh+i), rsec);</div>
<div class="line">                        TotEvap = soilEvap + CanopyT;</div>
<div class="line">                        WaterS = <a class="code" href="_aux_bio_cro_8c.html#a8dfc137af141b612fc3cde9b49b0fc5f">watstr</a>(*(pt_precip+i),TotEvap,waterCont,soilDepth,FieldC,WiltP,phi1,phi2,soilType, wsFun);   </div>
<div class="line">                        waterCont = WaterS.awc;</div>
<div class="line">                        StomWS = WaterS.rcoefPhoto ; </div>
<div class="line">                        LeafWS = WaterS.rcoefSpleaf;</div>
<div class="line">                        REAL(cwsMat)[i] = waterCont;</div>
<div class="line">                        REAL(psimMat)[i] = WaterS.psim;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(wsFun == 4)</div>
<div class="line">                  {</div>
<div class="line">                                    LeafPsim = WaterS.psim - (CanopyT * 1e3 * 1e-4 * 1.0/3600.0) * transpRes;</div>
<div class="line">                  <span class="keywordflow">if</span>(LeafPsim &lt; leafPotTh){</div>
<div class="line">                                          StomWS = 1 - ((leafPotTh - LeafPsim)/1000 * scsf);</div>
<div class="line">                                          <span class="keywordflow">if</span>(StomWS &lt; 0.1) StomWS = 0.1;</div>
<div class="line">                                   }<span class="keywordflow">else</span>{</div>
<div class="line">                                    StomWS = 1;</div>
<div class="line">                                  }</div>
<div class="line">                        }<span class="keywordflow">else</span>{</div>
<div class="line">                                  LeafPsim = 0;</div>
<div class="line">                }</div>
<div class="line">                                    </div>
<div class="line"><span class="comment">/****************Evaluating Daily Maintenance R espiration and Gross canopy assimilation******************/</span></div>
<div class="line"></div>
<div class="line">  StemResp=<a class="code" href="_auxcane_gro_8c.html#a5fd25059bc26f2c7be4d785b6978bccd">MRespiration</a>(<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a7a7df69b93e084f801e774fdbfec8c5f">stem</a>.<a class="code" href="structstem.html#a8dcd80e29bb84007d302eeda1dde7c75">biomass</a>, RESP.maint.Qstem, RESP.maint.mstem, *(pt_temp+i), timestep);</div>
<div class="line">  <a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a5d45301a3c18815e58686469cb430dfe">autoresp</a>.<a class="code" href="struct_daily_auto_resp.html#ab8390a37f1d1bd3f9c2e031a5c6136c9">stemmaint</a>+=StemResp;</div>
<div class="line">  RootResp=<a class="code" href="_auxcane_gro_8c.html#a5fd25059bc26f2c7be4d785b6978bccd">MRespiration</a>(<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a3c7864ec0d9545a4805365f68740c8f7">root</a>.<a class="code" href="structroot.html#a8dcd80e29bb84007d302eeda1dde7c75">biomass</a>, RESP.maint.Qroot, RESP.maint.mroot, *(pt_temp+i), timestep);</div>
<div class="line">  <a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a5d45301a3c18815e58686469cb430dfe">autoresp</a>.<a class="code" href="struct_daily_auto_resp.html#a6f7a5ab9d53c13f3f662028b5cd03749">rootmaint</a>+=RootResp;</div>
<div class="line">  RhizResp=<a class="code" href="_auxcane_gro_8c.html#a5fd25059bc26f2c7be4d785b6978bccd">MRespiration</a>(<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a32b9df3fd9b9924983e00bd58cfcb093">rhizome</a>.<a class="code" href="structrhizome.html#a8dcd80e29bb84007d302eeda1dde7c75">biomass</a>, RESP.maint.Qrhizome, RESP.maint.mrhizome, *(pt_temp+i), timestep);</div>
<div class="line">  <a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a5d45301a3c18815e58686469cb430dfe">autoresp</a>.<a class="code" href="struct_daily_auto_resp.html#a15cbc15ef42b16ca578855e51cc27a3f">rhizomemaint</a>+=RhizResp;</div>
<div class="line">  <a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a5d45301a3c18815e58686469cb430dfe">autoresp</a>.<a class="code" href="struct_daily_auto_resp.html#a8d66bb670f4fff50eac6d0af4b34f27d">leafdarkresp</a>+=(CanopyAGross-CanopyA);</div>
<div class="line">  dailynetassim+=CanopyA;<span class="comment">//Net Canopy Assimilation</span></div>
<div class="line">  <a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#adecb6ea5ce5c1bb7fb1c442a661bdf48">GPP</a>+=CanopyAGross;</div>
<div class="line"> <span class="comment">/**********************************************************************************/</span></div>
<div class="line"><span class="comment">//  Rprintf(&quot;%f,%f,%f,%f,%f\n&quot;,*(pt_solar+i),*(pt_temp+i),*(pt_precip+i),*(pt_rh+i),*(pt_windspeed+i));</span></div>
<div class="line"></div>
<div class="line">   <span class="keywordflow">if</span>(i % 24== 0)</div>
<div class="line">   {</div>
<div class="line">  <span class="comment">// update daily climate structure</span></div>
<div class="line">   <a class="code" href="_aux_crop_gro_8c.html#a775c34b3755514f1f5e991c40ca904c1">getdailyclimate</a>(&amp;<a class="code" href="structdailyclimate.html">dailyclimate</a>, pt_doy,pt_solar,pt_temp, pt_rh, pt_windspeed,pt_precip,i,vecsize);  </div>
<div class="line">  <span class="comment">// calculate GDDD for today only if crop is growing, otherwise set it to zero</span></div>
<div class="line">   dailydelTT = (emergence ==1) ? <a class="code" href="_aux_crop_gro_8c.html#abf73158640994c9e3d79af089a3bf3e2">getThermaltime</a>(<a class="code" href="structdailyclimate.html">dailyclimate</a>.<a class="code" href="structdailyclimate.html#a9fb78358ae4b0a049a0d1b37dc4cffec">temp</a>, Tbase):0.0;</div>
<div class="line">   <span class="comment">// Update day after planting today</span></div>
<div class="line">   REAL(DayafterPlanting)[dap]=dap;  </div>
<div class="line">   <span class="comment">// update GDD (accumulated thermal time) upto today</span></div>
<div class="line">   accumulatedGDD+=((dap==0)? 0:dailydelTT);</div>
<div class="line"><span class="comment">//   REAL(GDD)[dap]=((dap==0)? 0:REAL(GDD)[dap-1])+dailydelTT;</span></div>
<div class="line">     REAL(GDD)[dap]=accumulatedGDD;</div>
<div class="line">     <span class="keywordtype">double</span> oldstandingN, newstandingN, Ndemand;</div>
<div class="line">     oldstandingN=(<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a50ee911b9f901fb0d866d8915fecf9db">leaf</a>.<a class="code" href="structleaf.html#a8dcd80e29bb84007d302eeda1dde7c75">biomass</a>+<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a7a7df69b93e084f801e774fdbfec8c5f">stem</a>.<a class="code" href="structstem.html#a8dcd80e29bb84007d302eeda1dde7c75">biomass</a>+<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a3c7864ec0d9545a4805365f68740c8f7">root</a>.<a class="code" href="structroot.html#a8dcd80e29bb84007d302eeda1dde7c75">biomass</a>+<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a32b9df3fd9b9924983e00bd58cfcb093">rhizome</a>.<a class="code" href="structrhizome.html#a8dcd80e29bb84007d302eeda1dde7c75">biomass</a>)*0.4*100/40.0; <span class="comment">// carbohydrta to C to g/m2 to N</span></div>
<div class="line">     <a class="code" href="_aux_crop_gro_8c.html#a6a4e88f385a2e7893147accbd32a21c9">dailymiscanthus</a>(&amp;<a class="code" href="structmiscanthus.html">miscanthus</a>, REAL(DBPCOEFS),REAL(THERMALP),accumulatedGDD, *(pt_temp+i), dailynetassim,&amp;<a class="code" href="structsenthermaltemp.html">senthermaltemp</a>, &amp;<a class="code" href="structcanopyparms.html">canopyparms</a>,&amp;frostparms,i,dailydelTT,&amp;RESP,emergence);     </div>
<div class="line">     newstandingN=(<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a50ee911b9f901fb0d866d8915fecf9db">leaf</a>.<a class="code" href="structleaf.html#a8dcd80e29bb84007d302eeda1dde7c75">biomass</a>+<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a7a7df69b93e084f801e774fdbfec8c5f">stem</a>.<a class="code" href="structstem.html#a8dcd80e29bb84007d302eeda1dde7c75">biomass</a>+<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a3c7864ec0d9545a4805365f68740c8f7">root</a>.<a class="code" href="structroot.html#a8dcd80e29bb84007d302eeda1dde7c75">biomass</a>+<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a32b9df3fd9b9924983e00bd58cfcb093">rhizome</a>.<a class="code" href="structrhizome.html#a8dcd80e29bb84007d302eeda1dde7c75">biomass</a>)*0.4*100/40.0; <span class="comment">// carbohydrta to C to g/m2 to N</span></div>
<div class="line">      Ndemand =newstandingN - oldstandingN;</div>
<div class="line">     <span class="comment">/***** Check if plant is already emerged, then growth needs to be simulated ***/</span> </div>
<div class="line">          <span class="keywordflow">if</span>(emergence==1)</div>
<div class="line">          {</div>
<div class="line">            <span class="comment">/*** Simulate miscanthus growth ***/</span></div>
<div class="line"><span class="comment">//              dailymiscanthus(&amp;miscanthus, REAL(DBPCOEFS),REAL(THERMALP),accumulatedGDD, *(pt_temp+i), dailynetassim,&amp;senthermaltemp, &amp;canopyparms,&amp;frostparms,i,dailydelTT,&amp;RESP,emergence);</span></div>
<div class="line"><span class="comment">//              Rprintf(&quot;DPY= %i, GDD=%f\n&quot;,dailyclimate.doy,accumulatedGDD);</span></div>
<div class="line"><span class="comment"></span>                 <span class="keywordflow">if</span>(<a class="code" href="structdailyclimate.html">dailyclimate</a>.<a class="code" href="structdailyclimate.html#ad738d9ec1dae43aa473f0c5e5751e54e">doy</a>==<a class="code" href="structmanagement.html">management</a>.<a class="code" href="structmanagement.html#ab54ed07e5409c46397cc379eb3355fd7">harvestparms</a>.<a class="code" href="structmanagement_1_1harvestparms.html#a1d260882bc4979d7a0b94376f09b8341">harvestdoy</a>)</div>
<div class="line">                {</div>
<div class="line">                  emergence=0;                        <span class="comment">//Emergence is set back to zero</span></div>
<div class="line">                  REAL(GDD)[dap]=0.0;                 <span class="comment">//Set GDD back to zero to restart phenology from beginning</span></div>
<div class="line">                  <a class="code" href="assign_management_8c.html#a3709ea03ef6d8f952d2a06b16b7b031c">updateafterharvest</a>(&amp;<a class="code" href="structmiscanthus.html">miscanthus</a>,&amp;<a class="code" href="structmanagement.html">management</a>); <span class="comment">// Use harvest parameters to implement pracices such as removingor leaving residues </span></div>
<div class="line">                  Rprintf(<span class="stringliteral">&quot;in CropGRO, harvest day %i\n&quot;</span>,i);</div>
<div class="line">                }         </div>
<div class="line">          }</div>
<div class="line">          <span class="keywordflow">else</span></div>
<div class="line">          {      </div>
<div class="line">                  emergence=<a class="code" href="_aux_crop_gro_8c.html#a181e9d3d89503bf4e3a3d19f61fd0c68">CheckEmergence</a>(&amp;<a class="code" href="structdailyclimate.html">dailyclimate</a>,<a class="code" href="structmanagement.html">management</a>.<a class="code" href="structmanagement.html#a4b7d3f331ae6c6f522bc2d480d89c31d">emergenceparms</a>.<a class="code" href="structmanagement_1_1emergenceparms.html#a054f8fb38b9c169dbde921b5eed322e7">emergenceTemp</a>); </div>
<div class="line">                  <span class="keywordflow">if</span>((<a class="code" href="structdailyclimate.html">dailyclimate</a>.<a class="code" href="structdailyclimate.html#ad738d9ec1dae43aa473f0c5e5751e54e">doy</a>==120)&amp;&amp;(phototype==2))emergence=1;</div>
<div class="line">                  <span class="keywordflow">if</span>(emergence==1)</div>
<div class="line">                  {</div>
<div class="line"><span class="comment">//                    Rprintf(&quot;BEFORE leaf=%f, rhizome=%f \n&quot;,miscanthus.leaf.biomass,miscanthus.rhizome.biomass);</span></div>
<div class="line">                  <a class="code" href="assign_management_8c.html#aabcd8dd6fd6ab4b6dbb9a7de268c11ff">updateafteremergence</a>(&amp;<a class="code" href="structmiscanthus.html">miscanthus</a>,&amp;<a class="code" href="structmanagement.html">management</a>);</div>
<div class="line"><span class="comment">//                         Rprintf(&quot;AFTER leaf=%f, rhizome=%f \n&quot;,miscanthus.leaf.biomass,miscanthus.rhizome.biomass);</span></div>
<div class="line">                      Rprintf(<span class="stringliteral">&quot;in CropGRO, emergence day %i\n&quot;</span>,i);</div>
<div class="line">                      accumulatedGDD=0.0;</div>
<div class="line">                      TTc=0.0;</div>
<div class="line"><span class="comment">//                  miscanthus.leaf.biomass=0.02*  miscanthus.rhizome.biomass;</span></div>
<div class="line">                  LAI = <a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a50ee911b9f901fb0d866d8915fecf9db">leaf</a>.<a class="code" href="structleaf.html#a8dcd80e29bb84007d302eeda1dde7c75">biomass</a>* Sp;</div>
<div class="line">                   CROPCENT.ENV.minN+=12.0; <span class="comment">// adding fertilization on the emergence day</span></div>
<div class="line">                  }</div>
<div class="line"><span class="comment">//                   dailymiscanthus(&amp;miscanthus, REAL(DBPCOEFS),REAL(THERMALP),accumulatedGDD, *(pt_temp+i), dailynetassim,&amp;senthermaltemp, &amp;canopyparms,&amp;frostparms,i,dailydelTT,&amp;RESP,emergence);</span></div>
<div class="line">                 <span class="comment">// updatedormantstage(&amp;miscanthus);</span></div>
<div class="line">               </div>
<div class="line">          }</div>
<div class="line">                  LAI=<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a50ee911b9f901fb0d866d8915fecf9db">leaf</a>.<a class="code" href="structleaf.html#a8dcd80e29bb84007d302eeda1dde7c75">biomass</a>*Sp;</div>
<div class="line"><span class="comment">//                  Rprintf(&quot;%i,%i,%f,%f\n&quot;,emergence,dap, iSp, Sp);</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">/****************************************************************************/</span></div>
<div class="line"><span class="comment">// CROPCENT SIMULATION BEGINS HHERE    </span></div>
<div class="line"><span class="comment">//</span></div>
<div class="line"><span class="comment">// Perhaps it is better to insert a function ImplementManagement. Implement Management Functions can do following things</span></div>
<div class="line"><span class="comment">// Implement Harvest Management, removing biomass and leaving a fraction of litter, which can then be used to update structures for updating the input to soil biogeochemistry</span></div>
<div class="line"><span class="comment">// Implement N application, which will affect N available for plants and also N dynamics of soil</span></div>
<div class="line"><span class="comment">// Implement Irrigation, which can change soil water status, affecting plant growth and soil biogeochemistry</span></div>
<div class="line"><span class="comment">// Implement Tillage which will change decomposition rate of difference soil pools</span></div>
<div class="line"></div>
<div class="line"><span class="comment">//Now here We are simpyl taking litter vector and creating new structures to send to soil biogeochemistry simulations</span></div>
<div class="line"></div>
<div class="line"><span class="comment">//   BiocroToCrocent(&amp;LeafLitter,leaf.fallrate,leaf.lignin, &amp;leaf.E, isotoperatio, 1, 0,leaflitter);</span></div>
<div class="line">   </div>
<div class="line">    <a class="code" href="_auxcropcent_8c.html#a8d0acdc6b1e768df361c4b7d6309f3f4">BiocroToCrocent</a>(&amp;<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a50ee911b9f901fb0d866d8915fecf9db">leaf</a>.<a class="code" href="structleaf.html#a06d13f10deee250608c73c56529eff6f">litter</a>,1.0,0.2, &amp;leaflitterE, 1.0, 1, 0,&amp;leaflitter);</div>
<div class="line">    <a class="code" href="_auxcropcent_8c.html#a8d0acdc6b1e768df361c4b7d6309f3f4">BiocroToCrocent</a>(&amp;<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a7a7df69b93e084f801e774fdbfec8c5f">stem</a>.<a class="code" href="structstem.html#a06d13f10deee250608c73c56529eff6f">litter</a>,1.0,0.2, &amp;stemlitterE, 1.0, 1, 0,&amp;stemlitter);</div>
<div class="line">    <a class="code" href="_auxcropcent_8c.html#a8d0acdc6b1e768df361c4b7d6309f3f4">BiocroToCrocent</a>(&amp;<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a3c7864ec0d9545a4805365f68740c8f7">root</a>.<a class="code" href="structroot.html#a06d13f10deee250608c73c56529eff6f">litter</a>,1.0,0.2, &amp;rootlitterE, 1.0, 0, 0,&amp;leaflitter);</div>
<div class="line">    <a class="code" href="_auxcropcent_8c.html#a8d0acdc6b1e768df361c4b7d6309f3f4">BiocroToCrocent</a>(&amp;<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a32b9df3fd9b9924983e00bd58cfcb093">rhizome</a>.<a class="code" href="structrhizome.html#a06d13f10deee250608c73c56529eff6f">litter</a>,1.0,0.2, &amp;rhizomelitterE, 1.0, 0, 0,&amp;rhizomelitter);</div>
<div class="line">    </div>
<div class="line">    </div>
<div class="line"><span class="comment">//    Rprintf(&quot;Biomass in g C/m2=%f, CN =%f, Lignin = %f , surface=%i, woody=%i \n&quot;,leaflitter.C.totalC,leaflitter.E.CN,leaflitter.lignin,leaflitter.surface,leaflitter.woody);</span></div>
<div class="line">     <span class="keywordflow">if</span>(leaflitter.C.totalC &gt;0.0) </div>
<div class="line">     {</div>
<div class="line">      Rprintf(<span class="stringliteral">&quot;Before updating from litter strucc1 = %f,structCN=%f, metabcpool =%f \n&quot;</span>, CROPCENT.strucc1.C.totalC,CROPCENT.strucc1.E.CN,CROPCENT.metabc1.C.totalC);</div>
<div class="line">      <a class="code" href="_auxcropcent_8c.html#a0d832df70c4ff5aab5a48d5d528d6727">UpdateCropcentPoolsFromBioCro</a>(&amp;CROPCENT, &amp;leaflitter);</div>
<div class="line">      Rprintf(<span class="stringliteral">&quot;After updating from litter strucc1 = %f, structCN=%f,metabcpool =%f \n&quot;</span>, CROPCENT.strucc1.C.totalC, CROPCENT.strucc1.E.CN,CROPCENT.metabc1.C.totalC);</div>
<div class="line">     }</div>
<div class="line">      <span class="keywordflow">if</span>(stemlitter.C.totalC &gt;0.0) </div>
<div class="line">     {</div>
<div class="line">      <a class="code" href="_auxcropcent_8c.html#a0d832df70c4ff5aab5a48d5d528d6727">UpdateCropcentPoolsFromBioCro</a>(&amp;CROPCENT, &amp;stemlitter);</div>
<div class="line">     }</div>
<div class="line">      <span class="keywordflow">if</span>(rootlitter.C.totalC &gt;0.0) </div>
<div class="line">     {</div>
<div class="line">      <a class="code" href="_auxcropcent_8c.html#a0d832df70c4ff5aab5a48d5d528d6727">UpdateCropcentPoolsFromBioCro</a>(&amp;CROPCENT, &amp;rootlitter);</div>
<div class="line">     }</div>
<div class="line">      <span class="keywordflow">if</span>(rhizomelitter.C.totalC &gt;0.0) </div>
<div class="line">     {</div>
<div class="line">      <a class="code" href="_auxcropcent_8c.html#a0d832df70c4ff5aab5a48d5d528d6727">UpdateCropcentPoolsFromBioCro</a>(&amp;CROPCENT, &amp;rhizomelitter);</div>
<div class="line">     }</div>
<div class="line">      </div>
<div class="line">       newminrl =CROPCENT.ENV.minN;</div>
<div class="line">       <a class="code" href="_assigncropcent_8c.html#a020720a87f6de54d10b4512bbab7c078">assignENV</a>(&amp;CROPCENT,fake,fake,fake,fake,fake,fake,fake);</div>
<div class="line">       <a class="code" href="_assigncropcent_8c.html#a25a4ef27c891cbfa3b135629a3619829">assignFluxRatios</a>(&amp;CROPCENT);</div>
<div class="line">       <a class="code" href="_auxcropcent_8c.html#a94d21c0db2c289adca8162282f804a55">decomposeCROPCENT</a>(&amp;CROPCENT, woody,Eflag);</div>
<div class="line">       <a class="code" href="_auxcropcent_8c.html#a3452cdc8d9adc0bc9b37aa46afcdc480">updatecropcentpools</a>(&amp;CROPCENT);</div>
<div class="line">       CROPCENT.ENV.minN-=Ndemand;</div>
<div class="line">       CROPCENT.ENV.minN=(CROPCENT.ENV.minN&lt;0)?1e-6:CROPCENT.ENV.minN;</div>
<div class="line">       CROPCENT.ENV.minN=CROPCENT.ENV.minN-newminrl; <span class="comment">//current minus old is newminrl</span></div>
<div class="line">       </div>
<div class="line">      <span class="comment">/*</span></div>
<div class="line"><span class="comment">       trace_gas_model(fakeint,fakedouble ,&amp;newminrl, &amp;ammonium, nitrate,</span></div>
<div class="line"><span class="comment">                         &amp;texture, &amp;sand, &amp;silt, &amp;clay,</span></div>
<div class="line"><span class="comment">                         &amp;afiel, &amp;bulkd, &amp;maxt, &amp;ppt,</span></div>
<div class="line"><span class="comment">                         &amp;snow, &amp;avgwfps, &amp;stormf,</span></div>
<div class="line"><span class="comment">                         &amp;basef, frlechd, stream,</span></div>
<div class="line"><span class="comment">                         &amp;inorglch, &amp;critflow, wfluxout,</span></div>
<div class="line"><span class="comment">                         &amp;newCO2, &amp;NOflux, &amp;Nn2oflux, &amp;Dn2oflux,</span></div>
<div class="line"><span class="comment">                         &amp;Dn2flux, &amp;CH4, &amp;isdecid,</span></div>
<div class="line"><span class="comment">                         &amp;isagri, &amp;grass_lai, &amp;tree_lai,</span></div>
<div class="line"><span class="comment">                         &amp;NOabsorp_grass, &amp;NOabsorp_tree,</span></div>
<div class="line"><span class="comment">                         &amp;nit_amt, &amp;nreduce, </span></div>
<div class="line"><span class="comment">                         dN2lyr,dN2Olyr,sitepar,layers,soil);</span></div>
<div class="line"><span class="comment">        */</span></div>
<div class="line">       </div>
<div class="line">       <a class="code" href="crocent_8h.html#a3dafec998af130260251875bbca7628d">printcropcentout</a>(CROPCENT,</div>
<div class="line">                        &amp;REAL(totalSOC)[dap],</div>
<div class="line">                        &amp;REAL(strucc1)[dap],</div>
<div class="line">                        &amp;REAL(strucc2)[dap],</div>
<div class="line">                        &amp;REAL(metabc1)[dap],</div>
<div class="line">                        &amp;REAL(metabc2)[dap],</div>
<div class="line">                        &amp;REAL(som1c1)[dap],</div>
<div class="line">                        &amp;REAL(som1c2)[dap],</div>
<div class="line">                        &amp;REAL(som2c1)[dap],</div>
<div class="line">                        &amp;REAL(som2c2)[dap],</div>
<div class="line">                        &amp;REAL(som3c)[dap],</div>
<div class="line">                        &amp;REAL(minN)[dap]);</div>
<div class="line"></div>
<div class="line"><span class="comment">// </span></div>
<div class="line"><span class="comment">// BiocroToCrocent(&amp;RootLitter,root.fallrate,root.lignin, &amp;root.E, isotoperatio, 0, 0,rootlitter);</span></div>
<div class="line"><span class="comment">// BiocroToCrocent(&amp;RhizomeLitter,rhiz.fallrate,rhiz.lignin, &amp;rhiz.E, isotoperatio, 0, 0,rhizomelitter);</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// Also We need to update cropcent layer environment based on soil properties,Temperature, and soil moisture.This will influence actual decomposition rate</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// Now need to use structures to change the Cadded to soils based on structures. It is like adding into soil pools based on characteristic of the litter </span></div>
<div class="line"></div>
<div class="line"><span class="comment">// Now we can simulate decomposition of the SOC</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// Now we need to revert back decomposition coefficients, which may have been modified by differen factors, such as tillage etc. so they do not keep recycled.</span></div>
<div class="line"></div>
<div class="line"><span class="comment">// Take all the outputs and send them to R for plotting purpose</span></div>
<div class="line"><span class="comment">/***************************************************************************/</span></div>
<div class="line">   REAL(GPP)[dap]=<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#adecb6ea5ce5c1bb7fb1c442a661bdf48">GPP</a>;</div>
<div class="line">   REAL(LeafDarkResp)[dap]=<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a5d45301a3c18815e58686469cb430dfe">autoresp</a>.<a class="code" href="struct_daily_auto_resp.html#a8d66bb670f4fff50eac6d0af4b34f27d">leafdarkresp</a>;</div>
<div class="line">   REAL(StemMResp)[dap]=<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a5d45301a3c18815e58686469cb430dfe">autoresp</a>.<a class="code" href="struct_daily_auto_resp.html#ab8390a37f1d1bd3f9c2e031a5c6136c9">stemmaint</a>;</div>
<div class="line">   REAL(RootMResp)[dap]=<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a5d45301a3c18815e58686469cb430dfe">autoresp</a>.<a class="code" href="struct_daily_auto_resp.html#a6f7a5ab9d53c13f3f662028b5cd03749">rootmaint</a>;</div>
<div class="line">   REAL(RhizomeMResp)[dap]=<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a5d45301a3c18815e58686469cb430dfe">autoresp</a>.<a class="code" href="struct_daily_auto_resp.html#a15cbc15ef42b16ca578855e51cc27a3f">rhizomemaint</a>;</div>
<div class="line">   REAL(autoRESP)[dap]= <a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a5d45301a3c18815e58686469cb430dfe">autoresp</a>.<a class="code" href="struct_daily_auto_resp.html#ab5af64ba12e40aefe7080187c140895a">total</a>;</div>
<div class="line">   <a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a202954d5c2e6e693758833c6f0f48f43">NPP</a>=<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#adecb6ea5ce5c1bb7fb1c442a661bdf48">GPP</a>-<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a5d45301a3c18815e58686469cb430dfe">autoresp</a>.<a class="code" href="struct_daily_auto_resp.html#ab5af64ba12e40aefe7080187c140895a">total</a>;</div>
<div class="line">   REAL(NPP)[dap]=<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a202954d5c2e6e693758833c6f0f48f43">NPP</a>;</div>
<div class="line">   REAL(Stemd)[dap]=<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a7a7df69b93e084f801e774fdbfec8c5f">stem</a>.<a class="code" href="structstem.html#a8dcd80e29bb84007d302eeda1dde7c75">biomass</a>;</div>
<div class="line">   REAL(Leafd)[dap]=<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a50ee911b9f901fb0d866d8915fecf9db">leaf</a>.<a class="code" href="structleaf.html#a8dcd80e29bb84007d302eeda1dde7c75">biomass</a>;</div>
<div class="line">   REAL(Rootd)[dap]=<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a3c7864ec0d9545a4805365f68740c8f7">root</a>.<a class="code" href="structroot.html#a8dcd80e29bb84007d302eeda1dde7c75">biomass</a>;</div>
<div class="line">   REAL(Rhizomed)[dap]=<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a32b9df3fd9b9924983e00bd58cfcb093">rhizome</a>.<a class="code" href="structrhizome.html#a8dcd80e29bb84007d302eeda1dde7c75">biomass</a>;</div>
<div class="line">   REAL(Stemlitterd)[dap]=<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a7a7df69b93e084f801e774fdbfec8c5f">stem</a>.<a class="code" href="structstem.html#a06d13f10deee250608c73c56529eff6f">litter</a>;</div>
<div class="line">   REAL(Leaflitterd)[dap]=<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a50ee911b9f901fb0d866d8915fecf9db">leaf</a>.<a class="code" href="structleaf.html#a06d13f10deee250608c73c56529eff6f">litter</a>;</div>
<div class="line">   REAL(Rootlitterd)[dap]=<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a3c7864ec0d9545a4805365f68740c8f7">root</a>.<a class="code" href="structroot.html#a06d13f10deee250608c73c56529eff6f">litter</a>;</div>
<div class="line">   REAL(Rhizomelitterd)[dap]=<a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a32b9df3fd9b9924983e00bd58cfcb093">rhizome</a>.<a class="code" href="structrhizome.html#a06d13f10deee250608c73c56529eff6f">litter</a>;</div>
<div class="line">   REAL(LAId)[dap]=LAI;</div>
<div class="line">   </div>
<div class="line">    <a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a5d45301a3c18815e58686469cb430dfe">autoresp</a>.<a class="code" href="struct_daily_auto_resp.html#a8d66bb670f4fff50eac6d0af4b34f27d">leafdarkresp</a>=0.0;</div>
<div class="line">    <a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a5d45301a3c18815e58686469cb430dfe">autoresp</a>.<a class="code" href="struct_daily_auto_resp.html#ab8390a37f1d1bd3f9c2e031a5c6136c9">stemmaint</a>=0.0;</div>
<div class="line">    <a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a5d45301a3c18815e58686469cb430dfe">autoresp</a>.<a class="code" href="struct_daily_auto_resp.html#a6f7a5ab9d53c13f3f662028b5cd03749">rootmaint</a>=0.0;</div>
<div class="line">    <a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a5d45301a3c18815e58686469cb430dfe">autoresp</a>.<a class="code" href="struct_daily_auto_resp.html#a15cbc15ef42b16ca578855e51cc27a3f">rhizomemaint</a>=0.0;  </div>
<div class="line">    <a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#adecb6ea5ce5c1bb7fb1c442a661bdf48">GPP</a>=0;</div>
<div class="line">    <a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a202954d5c2e6e693758833c6f0f48f43">NPP</a>=0;</div>
<div class="line">    dailynetassim=0.0;</div>
<div class="line">    dailyGPP=0.0;</div>
<div class="line">    dap+=1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line">                MinNitro = centS.MinN; <span class="comment">/* These should be kg / m^2 per week? */</span></div>
<div class="line">                Resp = centS.Resp;</div>
<div class="line">                SCCs[0] = centS.SCs[0];</div>
<div class="line">                SCCs[1] = centS.SCs[1];</div>
<div class="line">                SCCs[2] = centS.SCs[2];</div>
<div class="line">                SCCs[3] = centS.SCs[3];</div>
<div class="line">                SCCs[4] = centS.SCs[4];</div>
<div class="line">                SCCs[5] = centS.SCs[5];</div>
<div class="line">                SCCs[6] = centS.SCs[6];</div>
<div class="line">                SCCs[7] = centS.SCs[7];</div>
<div class="line">                SCCs[8] = centS.SCs[8];</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line">                ALitter = LeafLitter + StemLitter;</div>
<div class="line">                BLitter = RootLitter + RhizomeLitter;</div>
<div class="line">    </div>
<div class="line">                <span class="comment">/* Here I could add a soil and nitrogen carbon component. I have soil</span></div>
<div class="line"><span class="comment">                   moisture, I have temperature and root and rhizome biomass */</span></div>
<div class="line"></div>
<div class="line">                REAL(DayofYear)[i] =  INTEGER(DOY)[i];</div>
<div class="line">                REAL(Hour)[i] =  INTEGER(HR)[i];</div>
<div class="line">                REAL(CanopyAssim)[i] =  CanopyA;</div>
<div class="line">                REAL(CanopyTrans)[i] =  CanopyT; </div>
<div class="line">                REAL(Leafy)[i] = <a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a50ee911b9f901fb0d866d8915fecf9db">leaf</a>.<a class="code" href="structleaf.html#a8dcd80e29bb84007d302eeda1dde7c75">biomass</a>; <span class="comment">//Leaf;</span></div>
<div class="line">                REAL(Stemy)[i] = <a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a7a7df69b93e084f801e774fdbfec8c5f">stem</a>.<a class="code" href="structstem.html#a8dcd80e29bb84007d302eeda1dde7c75">biomass</a>; <span class="comment">// Stem;</span></div>
<div class="line">                REAL(Rooty)[i] =  <a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a3c7864ec0d9545a4805365f68740c8f7">root</a>.<a class="code" href="structroot.html#a8dcd80e29bb84007d302eeda1dde7c75">biomass</a>; <span class="comment">//Root;</span></div>
<div class="line">                REAL(Rhizomey)[i] = <a class="code" href="structmiscanthus.html">miscanthus</a>.<a class="code" href="structmiscanthus.html#a32b9df3fd9b9924983e00bd58cfcb093">rhizome</a>.<a class="code" href="structrhizome.html#a8dcd80e29bb84007d302eeda1dde7c75">biomass</a>; <span class="comment">//Rhizome;</span></div>
<div class="line">                REAL(Grainy)[i] = Grain;</div>
<div class="line">                REAL(LAIc)[i] = LAI;</div>
<div class="line">                REAL(SoilWatCont)[i] = waterCont;</div>
<div class="line">                REAL(StomatalCondCoefs)[i] = StomWS;</div>
<div class="line">                REAL(LeafReductionCoefs)[i] = LeafWS;</div>
<div class="line">                REAL(LeafNitrogen)[i] = LeafN;</div>
<div class="line">                REAL(AboveLitter)[i] = ALitter;</div>
<div class="line">                REAL(BelowLitter)[i] = BLitter;</div>
<div class="line">                REAL(VmaxVec)[i] = vmax1;</div>
<div class="line">                REAL(AlphaVec)[i] = alpha1;</div>
<div class="line">                REAL(SpVec)[i] = Sp;</div>
<div class="line">                REAL(MinNitroVec)[i] = MinNitro/ (24*centTimestep);</div>
<div class="line">                REAL(RespVec)[i] = Resp / (24*centTimestep);</div>
<div class="line">                REAL(SoilEvaporation)[i] = soilEvap;</div>
<div class="line">                REAL(LeafPsimVec)[i] = LeafPsim;</div>
<div class="line">    </div>
<div class="line">}</div>
<div class="line"></div>
<div class="line"><span class="comment">/* Populating the results of the Century model */</span></div>
<div class="line"></div>
<div class="line">                REAL(SCpools)[0] = centS.SCs[0];</div>
<div class="line">                REAL(SCpools)[1] = centS.SCs[1];</div>
<div class="line">                REAL(SCpools)[2] = centS.SCs[2];</div>
<div class="line">                REAL(SCpools)[3] = centS.SCs[3];</div>
<div class="line">                REAL(SCpools)[4] = centS.SCs[4];</div>
<div class="line">                REAL(SCpools)[5] = centS.SCs[5];</div>
<div class="line">                REAL(SCpools)[6] = centS.SCs[6];</div>
<div class="line">                REAL(SCpools)[7] = centS.SCs[7];</div>
<div class="line">                REAL(SCpools)[8] = centS.SCs[8];</div>
<div class="line"></div>
<div class="line">                REAL(SNpools)[0] = centS.SNs[0];</div>
<div class="line">                REAL(SNpools)[1] = centS.SNs[1];</div>
<div class="line">                REAL(SNpools)[2] = centS.SNs[2];</div>
<div class="line">                REAL(SNpools)[3] = centS.SNs[3];</div>
<div class="line">                REAL(SNpools)[4] = centS.SNs[4];</div>
<div class="line">                REAL(SNpools)[5] = centS.SNs[5];</div>
<div class="line">                REAL(SNpools)[6] = centS.SNs[6];</div>
<div class="line">                REAL(SNpools)[7] = centS.SNs[7];</div>
<div class="line">                REAL(SNpools)[8] = centS.SNs[8];</div>
<div class="line"></div>
<div class="line">        SET_VECTOR_ELT(lists,0,DayofYear);</div>
<div class="line">        SET_VECTOR_ELT(lists,1,Hour);</div>
<div class="line">        SET_VECTOR_ELT(lists,2,CanopyAssim);</div>
<div class="line">        SET_VECTOR_ELT(lists,3,CanopyTrans);</div>
<div class="line">        SET_VECTOR_ELT(lists,4,Leafy);</div>
<div class="line">        SET_VECTOR_ELT(lists,5,Stemy);</div>
<div class="line">        SET_VECTOR_ELT(lists,6,Rooty);</div>
<div class="line">        SET_VECTOR_ELT(lists,7,Rhizomey);</div>
<div class="line">        SET_VECTOR_ELT(lists,8,Grainy);</div>
<div class="line">        SET_VECTOR_ELT(lists,9,LAIc);</div>
<div class="line">        SET_VECTOR_ELT(lists,10,TTTc);</div>
<div class="line">        SET_VECTOR_ELT(lists,11,SoilWatCont);</div>
<div class="line">        SET_VECTOR_ELT(lists,12,StomatalCondCoefs);</div>
<div class="line">        SET_VECTOR_ELT(lists,13,LeafReductionCoefs);</div>
<div class="line">        SET_VECTOR_ELT(lists,14,LeafNitrogen);</div>
<div class="line">        SET_VECTOR_ELT(lists,15,AboveLitter);</div>
<div class="line">        SET_VECTOR_ELT(lists,16,BelowLitter);</div>
<div class="line">        SET_VECTOR_ELT(lists,17,VmaxVec);</div>
<div class="line">        SET_VECTOR_ELT(lists,18,AlphaVec);</div>
<div class="line">        SET_VECTOR_ELT(lists,19,SpVec);</div>
<div class="line">        SET_VECTOR_ELT(lists,20,MinNitroVec);</div>
<div class="line">        SET_VECTOR_ELT(lists,21,RespVec);</div>
<div class="line">        SET_VECTOR_ELT(lists,22,SoilEvaporation);</div>
<div class="line">        SET_VECTOR_ELT(lists,23,cwsMat);</div>
<div class="line">        SET_VECTOR_ELT(lists,24,psimMat);</div>
<div class="line">        SET_VECTOR_ELT(lists,25,rdMat);</div>
<div class="line">        SET_VECTOR_ELT(lists,26,SCpools);</div>
<div class="line">        SET_VECTOR_ELT(lists,27,SNpools);</div>
<div class="line">        SET_VECTOR_ELT(lists,28,LeafPsimVec);</div>
<div class="line">  SET_VECTOR_ELT(lists,29,DayafterPlanting);</div>
<div class="line">  SET_VECTOR_ELT(lists,30,GDD);</div>
<div class="line">  SET_VECTOR_ELT(lists,31,GPP);</div>
<div class="line">  SET_VECTOR_ELT(lists,32,NPP);</div>
<div class="line">  SET_VECTOR_ELT(lists,33,autoRESP);  </div>
<div class="line">  SET_VECTOR_ELT(lists,34,hetRESP);</div>
<div class="line">  SET_VECTOR_ELT(lists,35,NER);</div>
<div class="line">  SET_VECTOR_ELT(lists,36,StemMResp);</div>
<div class="line">  SET_VECTOR_ELT(lists,37,RootMResp);</div>
<div class="line">  SET_VECTOR_ELT(lists,38,RhizomeMResp);</div>
<div class="line">  SET_VECTOR_ELT(lists,39,LeafDarkResp);</div>
<div class="line">  SET_VECTOR_ELT(lists,40,Stemd);</div>
<div class="line">  SET_VECTOR_ELT(lists,41,Leafd);</div>
<div class="line">  SET_VECTOR_ELT(lists,42,Rootd);</div>
<div class="line">  SET_VECTOR_ELT(lists,43,Rhizomed);</div>
<div class="line">  SET_VECTOR_ELT(lists,44,Stemlitterd);</div>
<div class="line">  SET_VECTOR_ELT(lists,45,Leaflitterd);</div>
<div class="line">  SET_VECTOR_ELT(lists,46,Rootlitterd);</div>
<div class="line">  SET_VECTOR_ELT(lists,47,Rhizomelitterd);</div>
<div class="line">  SET_VECTOR_ELT(lists,48,LAId);</div>
<div class="line">  SET_VECTOR_ELT(lists,49,totalSOC);</div>
<div class="line">  SET_VECTOR_ELT(lists,50,strucc1);</div>
<div class="line">  SET_VECTOR_ELT(lists,51,strucc2);</div>
<div class="line">  SET_VECTOR_ELT(lists,52,metabc1);</div>
<div class="line">  SET_VECTOR_ELT(lists,53,metabc1);</div>
<div class="line">  SET_VECTOR_ELT(lists,54,som1c1);</div>
<div class="line">  SET_VECTOR_ELT(lists,55,som1c2);</div>
<div class="line">  SET_VECTOR_ELT(lists,56,som2c1);</div>
<div class="line">  SET_VECTOR_ELT(lists,57,som2c2);</div>
<div class="line">  SET_VECTOR_ELT(lists,58,som3c);</div>
<div class="line">  SET_VECTOR_ELT(lists,59,minN);</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        SET_STRING_ELT(names,0,mkChar(<span class="stringliteral">&quot;DayofYear&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,1,mkChar(<span class="stringliteral">&quot;Hour&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,2,mkChar(<span class="stringliteral">&quot;CanopyAssim&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,3,mkChar(<span class="stringliteral">&quot;CanopyTrans&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,4,mkChar(<span class="stringliteral">&quot;Leaf&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,5,mkChar(<span class="stringliteral">&quot;Stem&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,6,mkChar(<span class="stringliteral">&quot;Root&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,7,mkChar(<span class="stringliteral">&quot;Rhizome&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,8,mkChar(<span class="stringliteral">&quot;Grain&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,9,mkChar(<span class="stringliteral">&quot;LAI&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,10,mkChar(<span class="stringliteral">&quot;ThermalT&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,11,mkChar(<span class="stringliteral">&quot;SoilWatCont&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,12,mkChar(<span class="stringliteral">&quot;StomatalCondCoefs&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,13,mkChar(<span class="stringliteral">&quot;LeafReductionCoefs&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,14,mkChar(<span class="stringliteral">&quot;LeafNitrogen&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,15,mkChar(<span class="stringliteral">&quot;AboveLitter&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,16,mkChar(<span class="stringliteral">&quot;BelowLitter&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,17,mkChar(<span class="stringliteral">&quot;VmaxVec&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,18,mkChar(<span class="stringliteral">&quot;AlphaVec&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,19,mkChar(<span class="stringliteral">&quot;SpVec&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,20,mkChar(<span class="stringliteral">&quot;MinNitroVec&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,21,mkChar(<span class="stringliteral">&quot;RespVec&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,22,mkChar(<span class="stringliteral">&quot;SoilEvaporation&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,23,mkChar(<span class="stringliteral">&quot;cwsMat&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,24,mkChar(<span class="stringliteral">&quot;psimMat&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,25,mkChar(<span class="stringliteral">&quot;rdMat&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,26,mkChar(<span class="stringliteral">&quot;SCpools&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,27,mkChar(<span class="stringliteral">&quot;SNpools&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,28,mkChar(<span class="stringliteral">&quot;LeafPsimVec&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,29,mkChar(<span class="stringliteral">&quot;DayafterPlanting&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,30,mkChar(<span class="stringliteral">&quot;GDD&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,31,mkChar(<span class="stringliteral">&quot;GPP&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,32,mkChar(<span class="stringliteral">&quot;NPP&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,33,mkChar(<span class="stringliteral">&quot;autoRESP&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,34,mkChar(<span class="stringliteral">&quot;hetRESP&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,35,mkChar(<span class="stringliteral">&quot;NER&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,36,mkChar(<span class="stringliteral">&quot;StemMResp&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,37,mkChar(<span class="stringliteral">&quot;RootMResp&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,38,mkChar(<span class="stringliteral">&quot;RhizomeMResp&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,39,mkChar(<span class="stringliteral">&quot;LeafDarkResp&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,40,mkChar(<span class="stringliteral">&quot;Stemd&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,41,mkChar(<span class="stringliteral">&quot;Leafd&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,42,mkChar(<span class="stringliteral">&quot;Rootd&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,43,mkChar(<span class="stringliteral">&quot;Rhizomed&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,44,mkChar(<span class="stringliteral">&quot;Stemlitterd&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,45,mkChar(<span class="stringliteral">&quot;Leaflitterd&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,46,mkChar(<span class="stringliteral">&quot;Rootlitterd&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,47,mkChar(<span class="stringliteral">&quot;Rhizomelitterd&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,48,mkChar(<span class="stringliteral">&quot;LAId&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,49,mkChar(<span class="stringliteral">&quot;totalSOC&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,50,mkChar(<span class="stringliteral">&quot;strucc1&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,51,mkChar(<span class="stringliteral">&quot;strucc2&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,52,mkChar(<span class="stringliteral">&quot;metabc1&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,53,mkChar(<span class="stringliteral">&quot;metabc1&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,54,mkChar(<span class="stringliteral">&quot;som1c1&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,55,mkChar(<span class="stringliteral">&quot;som1c2&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,56,mkChar(<span class="stringliteral">&quot;som2c1&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,57,mkChar(<span class="stringliteral">&quot;som2c2&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,58,mkChar(<span class="stringliteral">&quot;som3c&quot;</span>));</div>
<div class="line">   SET_STRING_ELT(names,59,mkChar(<span class="stringliteral">&quot;minN&quot;</span>));</div>
<div class="line">        setAttrib(lists,R_NamesSymbol,names);</div>
<div class="line">        UNPROTECT(62);</div>
<div class="line">        <span class="keywordflow">return</span>(lists);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="_crop_gro_8c.html">CropGro.c</a></li>
    <li class="footer">Generated on Wed Jan 22 2014 09:27:26 for BioCro by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.1.2 </li>
  </ul>
</div>
</body>
</html>
