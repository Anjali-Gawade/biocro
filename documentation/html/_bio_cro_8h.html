<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>BioCro: src/BioCro.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BioCro
   &#160;<span id="projectnumber">0.92</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_bio_cro_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">BioCro.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="_bio_cro_8h__dep__incl.png" border="0" usemap="#src_2_bio_cro_8hdep" alt=""/></div>
<map name="src_2_bio_cro_8hdep" id="src_2_bio_cro_8hdep">
<area shape="rect" id="node3" href="_aux_bio_cro_8c.html" title="src/AuxBioCro.c" alt="" coords="5,83,123,112"/><area shape="rect" id="node5" href="_aux_crop_gro_8c.html" title="src/AuxCropGro.c" alt="" coords="147,83,272,112"/><area shape="rect" id="node7" href="_auxwillow_gro_8c.html" title="src/AuxwillowGro.c" alt="" coords="296,83,429,112"/><area shape="rect" id="node9" href="_bio_cro_8c.html" title="src/BioCro.c" alt="" coords="453,83,547,112"/><area shape="rect" id="node11" href="cane_gro_8c.html" title="src/caneGro.c" alt="" coords="571,83,675,112"/><area shape="rect" id="node13" href="_crop_gro_8c.html" title="src/CropGro.c" alt="" coords="699,83,803,112"/><area shape="rect" id="node15" href="dailywillow_8c.html" title="src/dailywillow.c" alt="" coords="827,83,944,112"/><area shape="rect" id="node17" href="maize_gro_8c.html" title="src/maizeGro.c" alt="" coords="968,83,1077,112"/><area shape="rect" id="node19" href="willow_cent_8c.html" title="src/willowCent.c" alt="" coords="1101,83,1219,112"/><area shape="rect" id="node21" href="willow_gro_8c.html" title="src/willowGro.c" alt="" coords="1243,83,1355,112"/></map>
</div>
</div>
<p><a href="">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a9e38198cf133d59230f6d1f6beac12bc"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a9e38198cf133d59230f6d1f6beac12bc">RSS_BG</a> (double oStem[], double oLeaf[], double oRhizome[], double oRoot[], double oGrain[], double oLAI[], double sStem[], double sLeaf[], double sRhizome[], double sRoot[], double sGrain[], double sLAI[], int N1Dat)</td></tr>
<tr class="memitem:aa289681c71425537eb6fccb7ae92962a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#aa289681c71425537eb6fccb7ae92962a">BioGro</a> (double lat, int doy[], int hr[], double solar[], double temp[], double rh[], double windspeed[], double precip[], double kd, double chil, double heightf, int nlayers, double iRhizome, double irtl, double sencoefs[], int timestep, int vecsize, double Sp, double SpD, double dbpcoefs[25], double thermalp[], double vmax1, double alpha1, double kparm, double theta, double beta, double Rd, double Catm, double b0, double b1, double soilcoefs[], double ileafn, double kLN, double vmaxb1, double alphab1, double mresp[], int soilType, int wsFun, int ws, double centcoefs[], double centks[], int centTimestep, int soilLayers, double soilDepths[], double cws[], int hydrDist, double secs[], double kpLN, double lnb0, double lnb1, int lnfun, double upperT, double lowerT, struct <a class="el" href="structnitro_parms.html">nitroParms</a> nitroP)</td></tr>
<tr class="memitem:ad67c5b654f4bceb23717a84244291ea0"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="struct_can___str.html">Can_Str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#ad67c5b654f4bceb23717a84244291ea0">CanAC</a> (double LAI, int DOY, int hr, double solarR, double Temp, double RH, double WindSpeed, double lat, int nlayers, double Vmax, double Alpha, double Kparm, double theta, double beta, double Rd, double Catm, double b0, double b1, double StomataWS, int ws, double kd, double chil, double heightf, double leafN, double kpLN, double lnb0, double lnb1, int lnfun, double upperT, double lowerT, struct <a class="el" href="structnitro_parms.html">nitroParms</a> nitroP)</td></tr>
<tr class="memitem:af2fd78212ed1cfbe6bd2d77f6ec851ec"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="struct_can___str.html">Can_Str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#af2fd78212ed1cfbe6bd2d77f6ec851ec">c3CanAC</a> (double LAI, int DOY, int hr, double solarR, double Temp, double RH, double WindSpeed, double lat, int nlayers, double Vmax, double Jmax, double Rd, double Catm, double o2, double b0, double b1, double theta, double kd, double heightf, double leafN, double kpLN, double lnb0, double lnb1, int lnfun, double StomWS, int ws)</td></tr>
<tr class="memitem:a5a18f68430b9e6ed1be3d294b179f8a6"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="struct_can___str.html">Can_Str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a5a18f68430b9e6ed1be3d294b179f8a6">newc3CanAC</a> (double LAI, int DOY, int hr, double solarR, double Temp, double RH, double WindSpeed, double lat, int nlayers, double Vmax, double Jmax, double Rd, double Catm, double o2, double b0, double b1, double theta, double kd, double heightf, double leafN, double kpLN, double lnb0, double lnb1, int lnfun, double StomWS, int ws)</td></tr>
<tr class="memitem:a4dc70ed4086616dabcbc7565d36d247b"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structdbp__str.html">dbp_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a4dc70ed4086616dabcbc7565d36d247b">sel_dbp_coef</a> (double coefs[25], double TherPrds[6], double TherTime)</td></tr>
<tr class="memitem:aeb35169469ef33705592a28743d105bf"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#aeb35169469ef33705592a28743d105bf">resp</a> (double comp, double mrc, double temp)</td></tr>
<tr class="memitem:a8dfc137af141b612fc3cde9b49b0fc5f"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structws__str.html">ws_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a8dfc137af141b612fc3cde9b49b0fc5f">watstr</a> (double precipit, double evapo, double cws, double soildepth, double fieldc, double wiltp, double phi1, double phi2, int soiltype, int wsFun)</td></tr>
<tr class="memitem:a1ac23d61d399453a3837e85128f04b6f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a1ac23d61d399453a3837e85128f04b6f">SoilEvapo</a> (double LAI, double k, double AirTemp, double DirectRad, double awc, double fieldc, double wiltp, double winds, double RelH, double rsec)</td></tr>
<tr class="memitem:a5537e2a57efaaf41b401666bb9e22062"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structsoil_m_l__str.html">soilML_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a5537e2a57efaaf41b401666bb9e22062">soilML</a> (double precipit, double transp, double *cws, double soildepth, double *depths, double fieldc, double wiltp, double phi1, double phi2, struct <a class="el" href="structsoil_text__str.html">soilText_str</a> soTexS, int wsFun, int layers, double rootDB, double LAI, double k, double AirTemp, double IRad, double winds, double RelH, int hydrDist, double rfl, double rsec, double rsdf)</td></tr>
<tr class="memitem:a2b62fa0d37af87f9af219e7b0d56f34d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a2b62fa0d37af87f9af219e7b0d56f34d">TempToSWVC</a> (double Temp)</td></tr>
<tr class="memitem:abd35797ea11e52f0c527d40a9c1c0b7d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#abd35797ea11e52f0c527d40a9c1c0b7d">TempToSFS</a> (double Temp)</td></tr>
<tr class="memitem:abea4623ebab0e4ea7d9be5af1fd80344"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#abea4623ebab0e4ea7d9be5af1fd80344">TempToLHV</a> (double Temp)</td></tr>
<tr class="memitem:aef4a29370ba3b33794837905d82f3b86"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#aef4a29370ba3b33794837905d82f3b86">TempToDdryA</a> (double Temp)</td></tr>
<tr class="memitem:a247148ac54cf7d8c851326de6093b71e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a247148ac54cf7d8c851326de6093b71e">RHprof</a> (double RH, int nlayers)</td></tr>
<tr class="memitem:a43b0d68a959084dc4f4dc099c8901107"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a43b0d68a959084dc4f4dc099c8901107">WINDprof</a> (double WindSpeed, double LAI, int nlayers)</td></tr>
<tr class="memitem:acb415c4c261f9fc0140240ad46007c87"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#acb415c4c261f9fc0140240ad46007c87">sunML</a> (double Idir, double Idiff, double LAI, int nlayers, double cosTheta, double kd, double chil, double heightf)</td></tr>
<tr class="memitem:a46827eb56108821fe82228553f535293"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a46827eb56108821fe82228553f535293">lightME</a> (double lat, int DOY, int td)</td></tr>
<tr class="memitem:ab2c40f1d5cbe9760e48568b236467a16"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structcen_t__str.html">cenT_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#ab2c40f1d5cbe9760e48568b236467a16">Century</a> (double *LeafL, double *StemL, double *RootL, double *RhizL, double smoist, double stemp, int timestep, double SCs[9], double leachWater, double Nfert, double MinN, double precip, double LeafL_Ln, double StemL_Ln, double RootL_Ln, double RhizL_Ln, double LeafL_N, double StemL_N, double RootL_N, double RhizL_N, int soilType, double Ks_cf[8])</td></tr>
<tr class="memitem:ab1f878344b2d2444f096bd0da2cb9f24"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="struct_f_l__str.html">FL_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#ab1f878344b2d2444f096bd0da2cb9f24">FmLcFun</a> (double Lig, double Nit)</td></tr>
<tr class="memitem:a3f6a4f8b6e407fdca09efcebc32bf86c"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structflow__str.html">flow_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a> (double *SC, double CNratio, double A, double Lc, double Tm, double <a class="el" href="_bio_cro_8h.html#aeb35169469ef33705592a28743d105bf">resp</a>, int kno, double Ks[8])</td></tr>
<tr class="memitem:a1061dc2ec428954d1e4fd2abd8e17957"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a1061dc2ec428954d1e4fd2abd8e17957">AbiotEff</a> (double smoist, double stemp)</td></tr>
<tr class="memitem:a054d5ae3a62e6217a0d4e5093b79bb25"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a054d5ae3a62e6217a0d4e5093b79bb25">sel_phen</a> (int phen)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a5b6e16664a459420103984ac5409b858"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a5b6e16664a459420103984ac5409b858">CanopyAssim</a> [8760]</td></tr>
<tr class="memitem:abd2c9bad12951c887e8469151c778947"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#abd2c9bad12951c887e8469151c778947">Leafy</a> [8760]</td></tr>
<tr class="memitem:a929d2badff7fb301509012ee6e6a12e9"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a929d2badff7fb301509012ee6e6a12e9">Stemy</a> [8760]</td></tr>
<tr class="memitem:ad6a54d6e671d04cd9b254a8cd1c3315c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#ad6a54d6e671d04cd9b254a8cd1c3315c">Rooty</a> [8760]</td></tr>
<tr class="memitem:aa3741856cde2b5152c833b543abe77fc"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#aa3741856cde2b5152c833b543abe77fc">Rhizomey</a> [8760]</td></tr>
<tr class="memitem:a46f339721a905fe9e6f60af35ec11974"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#a46f339721a905fe9e6f60af35ec11974">Grainy</a> [8760]</td></tr>
<tr class="memitem:ac656f07a64aeba7d6ac5a3a536e993c8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_bio_cro_8h.html#ac656f07a64aeba7d6ac5a3a536e993c8">LAIc</a> [8760]</td></tr>
</table>
<h2>Function Documentation</h2>
<a class="anchor" id="a1061dc2ec428954d1e4fd2abd8e17957"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double AbiotEff </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>smoist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>stemp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L570">570</a> of file <a class="el" href="">Century.c</a>.</p>
<div class="fragment"><div class="line">                                            {</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">double</span> ans;</div>
<div class="line">  <span class="keywordtype">double</span> TempEff = 0.0, MoisEff;</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span>(stemp &lt; 35){</div>
<div class="line">    TempEff = 1.0087 / (1 + (46.2 * exp(-0.1899 * stemp)));</div>
<div class="line">  }<span class="keywordflow">else</span>{</div>
<div class="line">    TempEff = -0.0826 * stemp + 3.84;</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line">  MoisEff = 1.0267 / (1 + 14.7 * exp(-6.5 * smoist));</div>
<div class="line"></div>
<div class="line">  ans = TempEff * MoisEff;</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">return</span>(ans);</div>
<div class="line"></div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aa289681c71425537eb6fccb7ae92962a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BioGro </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>doy</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hr</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>solar</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rh</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>windspeed</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>precip</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>chil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>heightf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>iRhizome</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>irtl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sencoefs</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>vecsize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Sp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>SpD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dbpcoefs</em>[25], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>thermalp</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>vmax1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alpha1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kparm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Catm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soilcoefs</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>ileafn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>vmaxb1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>alphab1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mresp</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>soilType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>wsFun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>centcoefs</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>centks</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>centTimestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>soilLayers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soilDepths</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cws</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hydrDist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>secs</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kpLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lnfun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>upperT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lowerT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structnitro_parms.html">nitroParms</a>&#160;</td>
          <td class="paramname"><em>nitroP</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L1870">1870</a> of file <a class="el" href="">BioCro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line"></div>
<div class="line">        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#a5b6e16664a459420103984ac5409b858">CanopyAssim</a>[8760] ;</div>
<div class="line">        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#abd2c9bad12951c887e8469151c778947">Leafy</a>[8760] ;</div>
<div class="line">        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#a929d2badff7fb301509012ee6e6a12e9">Stemy</a>[8760] ;</div>
<div class="line">        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#ad6a54d6e671d04cd9b254a8cd1c3315c">Rooty</a>[8760] ;</div>
<div class="line">        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#aa3741856cde2b5152c833b543abe77fc">Rhizomey</a>[8760] ;</div>
<div class="line">        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#a46f339721a905fe9e6f60af35ec11974">Grainy</a>[8760] ;</div>
<div class="line">        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#ac656f07a64aeba7d6ac5a3a536e993c8">LAIc</a>[8760] ;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> newLeafcol[8760];</div>
<div class="line">        <span class="keywordtype">double</span> newStemcol[8760];</div>
<div class="line">        <span class="keywordtype">double</span> newRootcol[8760];</div>
<div class="line">        <span class="keywordtype">double</span> newRhizomecol[8760];</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">int</span> i, i3;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> Leaf, Stem, Root, Rhizome, LAI, Grain = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> TTc = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> kLeaf = 0.0, kStem = 0.0, kRoot = 0.0, kRhizome = 0.0, kGrain = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> newLeaf, newStem = 0.0, newRoot, newRhizome = 0.0, newGrain = 0.0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> litter[4];</div>
<div class="line">        litter[0] = centcoefs[19];</div>
<div class="line">        litter[1] = centcoefs[20];</div>
<div class="line">        litter[2] = centcoefs[21];</div>
<div class="line">        litter[3] = centcoefs[22];</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Variables needed for collecting litter */</span></div>
<div class="line">        <span class="keywordtype">double</span> LeafLitter = litter[0], StemLitter = litter[1];</div>
<div class="line">        <span class="keywordtype">double</span> RootLitter = litter[2], RhizomeLitter = litter[3];</div>
<div class="line">        <span class="keywordtype">double</span> LeafLitter_d = 0.0, StemLitter_d = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> RootLitter_d = 0.0, RhizomeLitter_d = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> ALitter = 0.0, BLitter = 0.0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> *sti , *sti2, *sti3, *sti4; </div>
<div class="line">        <span class="keywordtype">double</span> Remob;</div>
<div class="line">        <span class="keywordtype">int</span> k = 0, q = 0, m = 0, n = 0;</div>
<div class="line">        <span class="keywordtype">int</span> ri = 0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> StomWS = 1, LeafWS = 1;</div>
<div class="line">        <span class="keywordtype">double</span> CanopyA, CanopyT;</div>
<div class="line">        <span class="keywordtype">double</span> vmax, alpha;</div>
<div class="line">        <span class="keywordtype">double</span> LeafN_0 = ileafn;</div>
<div class="line">        <span class="keywordtype">double</span> LeafN = ileafn; <span class="comment">/* Need to set it because it is used by CanA before it is computed */</span></div>
<div class="line">        <span class="keywordtype">double</span> iSp = Sp;</div>
<div class="line">        vmax = vmax1;</div>
<div class="line">        alpha = alpha1;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Century */</span></div>
<div class="line">        <span class="keywordtype">double</span> MinNitro = centcoefs[18];</div>
<div class="line">        <span class="keywordtype">double</span> SCCs[9];</div>
<div class="line">        <span class="keywordtype">double</span> Resp;</div>
<div class="line"></div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> mrc1 = mresp[0];</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> mrc2 = mresp[1];</div>
<div class="line"></div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="struct_can___str.html">Can_Str</a> Canopy;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structws__str.html">ws_str</a> WaterS;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structdbp__str.html">dbp_str</a> dbpS;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structcen_t__str.html">cenT_str</a> centS;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structsoil_m_l__str.html">soilML_str</a> soilMLS;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structsoil_text__str.html">soilText_str</a> soTexS; <span class="comment">/* , *soTexSp = &amp;soTexS; */</span></div>
<div class="line">        soTexS = <a class="code" href="_aux_bio_cro_8c.html#a72f93049960e067cda6e7291ff1ff21a">soilTchoose</a>(soilType);</div>
<div class="line"></div>
<div class="line">        Rhizome = iRhizome;</div>
<div class="line">        Leaf = Rhizome * irtl;</div>
<div class="line">        Stem = Rhizome * 0.001;</div>
<div class="line">        Root = Rhizome * 0.001;</div>
<div class="line">        LAI = Leaf * Sp;</div>
<div class="line"></div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> FieldC = soilcoefs[0];</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> WiltP = soilcoefs[1];</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> phi1 = soilcoefs[2];</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> phi2 = soilcoefs[3];</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> soilDepth = soilcoefs[4];</div>
<div class="line">        <span class="keywordtype">double</span> waterCont = soilcoefs[5];</div>
<div class="line">        <span class="keywordtype">double</span> soilEvap, TotEvap;</div>
<div class="line"></div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> SeneLeaf = sencoefs[0];</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> SeneStem = sencoefs[1];</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> SeneRoot = sencoefs[2];</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> SeneRhizome = sencoefs[3];</div>
<div class="line"></div>
<div class="line">        SCCs[0] = centcoefs[0];</div>
<div class="line">        SCCs[1] = centcoefs[1];</div>
<div class="line">        SCCs[2] = centcoefs[2];</div>
<div class="line">        SCCs[3] = centcoefs[3];</div>
<div class="line">        SCCs[4] = centcoefs[4];</div>
<div class="line">        SCCs[5] = centcoefs[5];</div>
<div class="line">        SCCs[6] = centcoefs[6];</div>
<div class="line">        SCCs[7] = centcoefs[7];</div>
<div class="line">        SCCs[8] = centcoefs[8];</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Creation of pointers outside the loop */</span></div>
<div class="line">        sti = &amp;newLeafcol[0]; <span class="comment">/* This creates sti to be a pointer to the position 0</span></div>
<div class="line"><span class="comment">                                 in the newLeafcol vector */</span></div>
<div class="line">        sti2 = &amp;newStemcol[0];</div>
<div class="line">        sti3 = &amp;newRootcol[0];</div>
<div class="line">        sti4 = &amp;newRhizomecol[0];</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span>(i=0;i&lt;vecsize;i++)</div>
<div class="line">        {</div>
<div class="line">                <span class="comment">/* First calculate the elapsed Thermal Time*/</span></div>
<div class="line">                TTc += (temp[i] / (24/timestep));</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Do the magic! Calculate growth*/</span></div>
<div class="line"></div>
<div class="line">                Canopy = <a class="code" href="_aux_bio_cro_8c.html#ad67c5b654f4bceb23717a84244291ea0">CanAC</a>(LAI,doy[i],hr[i],</div>
<div class="line">                               solar[i],temp[i],rh[i],windspeed[i],</div>
<div class="line">                               lat,nlayers,vmax,alpha,kparm,theta,beta,</div>
<div class="line">                               Rd,Catm,b0,b1,StomWS,ws,kd, chil,</div>
<div class="line">                               heightf, LeafN, kpLN, lnb0, lnb1, lnfun,upperT,lowerT,nitroP);</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line">                CanopyA = Canopy.Assim * timestep;</div>
<div class="line">                CanopyT = Canopy.Trans * timestep;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(ISNAN(CanopyA)){</div>
<div class="line">                        Rprintf(<span class="stringliteral">&quot;LAI %.2f \n&quot;</span>,LAI); </div>
<div class="line">                        Rprintf(<span class="stringliteral">&quot;Leaf %.2f \n&quot;</span>,Leaf);</div>
<div class="line">                        Rprintf(<span class="stringliteral">&quot;irtl %.2f \n&quot;</span>,irtl);</div>
<div class="line">                        Rprintf(<span class="stringliteral">&quot;Rhizome %.2f \n&quot;</span>,Rhizome);</div>
<div class="line">                        Rprintf(<span class="stringliteral">&quot;Sp %.2f \n&quot;</span>,Sp);   </div>
<div class="line">                        Rprintf(<span class="stringliteral">&quot;doy[i] %.i %.i \n&quot;</span>,i,doy[i]); </div>
<div class="line">                        Rprintf(<span class="stringliteral">&quot;hr[i] %.i %.i \n&quot;</span>,i,hr[i]); </div>
<div class="line">                        Rprintf(<span class="stringliteral">&quot;solar[i] %.i %.2f \n&quot;</span>,i,solar[i]); </div>
<div class="line">                        Rprintf(<span class="stringliteral">&quot;temp[i] %.i %.2f \n&quot;</span>,i,temp[i]); </div>
<div class="line">                        Rprintf(<span class="stringliteral">&quot;rh[i] %.i %.2f \n&quot;</span>,i,rh[i]); </div>
<div class="line">                        Rprintf(<span class="stringliteral">&quot;windspeed[i] %.i %.2f \n&quot;</span>,i,windspeed[i]);</div>
<div class="line">                        Rprintf(<span class="stringliteral">&quot;lat %.i %.2f \n&quot;</span>,i,lat);</div>
<div class="line">                        Rprintf(<span class="stringliteral">&quot;nlayers %.i %.i \n&quot;</span>,i,nlayers);   </div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(soilLayers &gt; 1){</div>
<div class="line">                        soilMLS = <a class="code" href="_aux_bio_cro_8c.html#a5537e2a57efaaf41b401666bb9e22062">soilML</a>(precip[i], CanopyT, &amp;cws[0], soilDepth, soilDepths, FieldC, WiltP,</div>
<div class="line">                                         phi1, phi2, soTexS, wsFun, soilLayers, Root,</div>
<div class="line">                                         LAI, 0.68, temp[i], solar[i], windspeed[i], rh[i], hydrDist,</div>
<div class="line">                                         secs[0], secs[1], secs[2]);</div>
<div class="line"></div>
<div class="line">                        StomWS = soilMLS.rcoefPhoto;</div>
<div class="line">                        LeafWS = soilMLS.rcoefSpleaf;</div>
<div class="line">                        soilEvap = soilMLS.SoilEvapo;</div>
<div class="line">                        <span class="keywordflow">for</span>(i3=0;i3&lt;soilLayers;i3++){</div>
<div class="line">                                cws[i3] = soilMLS.cws[i3];</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                }<span class="keywordflow">else</span>{</div>
<div class="line"></div>
<div class="line">                        soilEvap = <a class="code" href="_aux_bio_cro_8c.html#ac96acf762dd39d5ff20d71788b0ca566">SoilEvapo</a>(LAI, 0.68, temp[i], solar[i], waterCont, FieldC, WiltP, windspeed[i], rh[i], secs[1]);</div>
<div class="line">                        TotEvap = soilEvap + CanopyT;</div>
<div class="line">                        WaterS = <a class="code" href="_aux_bio_cro_8c.html#a8dfc137af141b612fc3cde9b49b0fc5f">watstr</a>(precip[i],TotEvap,waterCont,soilDepth,FieldC,WiltP,phi1,phi2,soilType, wsFun);   </div>
<div class="line">                        waterCont = WaterS.awc;</div>
<div class="line">                        StomWS = WaterS.rcoefPhoto ;</div>
<div class="line">                        LeafWS = WaterS.rcoefSpleaf;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Picking the dry biomass partitioning coefficients */</span></div>
<div class="line">                dbpS = <a class="code" href="_aux_bio_cro_8c.html#a4dc70ed4086616dabcbc7565d36d247b">sel_dbp_coef</a>(dbpcoefs, thermalp, TTc);</div>
<div class="line"></div>
<div class="line">                kLeaf = dbpS.kLeaf;</div>
<div class="line">                kStem = dbpS.kStem;</div>
<div class="line">                kRoot = dbpS.kRoot;</div>
<div class="line">                kRhizome = dbpS.kRhiz;</div>
<div class="line">                kGrain = dbpS.kGrain;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(ISNAN(kRhizome) || ISNAN(kLeaf) || ISNAN(kRoot) || ISNAN(kStem) || ISNAN(kGrain)){</div>
<div class="line">                        Rprintf(<span class="stringliteral">&quot;kLeaf %.2f, kStem %.2f, kRoot %.2f, kRhizome %.2f, kGrain %.2f \n&quot;</span>,kLeaf,kStem,kRoot,kRhizome,kGrain);</div>
<div class="line">                        Rprintf(<span class="stringliteral">&quot;iter %i \n&quot;</span>,i);</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(i % 24*centTimestep == 0){</div>
<div class="line">                        LeafLitter_d = LeafLitter * ((0.1/30)*centTimestep);</div>
<div class="line">                        StemLitter_d = StemLitter * ((0.1/30)*centTimestep);</div>
<div class="line">                        RootLitter_d = RootLitter * ((0.1/30)*centTimestep);</div>
<div class="line">                        RhizomeLitter_d = RhizomeLitter * ((0.1/30)*centTimestep);</div>
<div class="line">       </div>
<div class="line">                        LeafLitter -= LeafLitter_d;</div>
<div class="line">                        StemLitter -= StemLitter_d;</div>
<div class="line">                        RootLitter -= RootLitter_d;</div>
<div class="line">                        RhizomeLitter -= RhizomeLitter_d;</div>
<div class="line">       </div>
<div class="line">                        centS = <a class="code" href="_bio_cro_8h.html#ab2c40f1d5cbe9760e48568b236467a16">Century</a>(&amp;LeafLitter_d,&amp;StemLitter_d,&amp;RootLitter_d,&amp;RhizomeLitter_d,</div>
<div class="line">                                        waterCont,temp[i],centTimestep,SCCs,WaterS.runoff,</div>
<div class="line">                                        centcoefs[17], <span class="comment">/* N fertilizer*/</span></div>
<div class="line">                                        MinNitro, <span class="comment">/* initial Mineral nitrogen */</span></div>
<div class="line">                                        precip[i], <span class="comment">/* precipitation */</span></div>
<div class="line">                                        centcoefs[9], <span class="comment">/* Leaf litter lignin */</span></div>
<div class="line">                                        centcoefs[10], <span class="comment">/* Stem litter lignin */</span></div>
<div class="line">                                        centcoefs[11], <span class="comment">/* Root litter lignin */</span></div>
<div class="line">                                        centcoefs[12], <span class="comment">/* Rhizome litter lignin */</span></div>
<div class="line">                                        centcoefs[13], <span class="comment">/* Leaf litter N */</span></div>
<div class="line">                                        centcoefs[14], <span class="comment">/* Stem litter N */</span></div>
<div class="line">                                        centcoefs[15],  <span class="comment">/* Root litter N */</span></div>
<div class="line">                                        centcoefs[16],   <span class="comment">/* Rhizome litter N */</span></div>
<div class="line">                                        soilType, centks);</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Here I can insert the code for Nitrogen limitations on photosynthesis</span></div>
<div class="line"><span class="comment">                   parameters. This is taken From Harley et al. (1992) Modelling cotton under</span></div>
<div class="line"><span class="comment">                   elevated CO2. PCE. This is modeled as a simple linear relationship between</span></div>
<div class="line"><span class="comment">                   leaf nitrogen and vmax and alpha. Leaf Nitrogen should be modulated by N</span></div>
<div class="line"><span class="comment">                   availability and possibly by the Thermal time accumulated.*/</span></div>
<div class="line"></div>
<div class="line">                MinNitro = centS.MinN;</div>
<div class="line">                Resp = centS.Resp;</div>
<div class="line">     </div>
<div class="line">                SCCs[0] = centS.SCs[0];</div>
<div class="line">                SCCs[1] = centS.SCs[1];</div>
<div class="line">                SCCs[2] = centS.SCs[2];</div>
<div class="line">                SCCs[3] = centS.SCs[3];</div>
<div class="line">                SCCs[4] = centS.SCs[4];</div>
<div class="line">                SCCs[5] = centS.SCs[5];</div>
<div class="line">                SCCs[6] = centS.SCs[6];</div>
<div class="line">                SCCs[7] = centS.SCs[7];</div>
<div class="line">                SCCs[8] = centS.SCs[8];</div>
<div class="line"></div>
<div class="line">                LeafN = LeafN_0 * exp(-kLN * TTc); </div>
<div class="line">                vmax = (LeafN_0 - LeafN) * vmaxb1 + vmax1;</div>
<div class="line">                alpha = (LeafN_0 - LeafN) * alphab1 + alpha1;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(kLeaf &gt; 0)</div>
<div class="line">                {</div>
<div class="line">                        newLeaf = CanopyA * kLeaf * LeafWS ; </div>
<div class="line">                        <span class="comment">/*  The major effect of water stress is on leaf expansion rate. See Boyer (1970)</span></div>
<div class="line"><span class="comment">                            Plant. Phys. 46, 233-235. For this the water stress coefficient is different</span></div>
<div class="line"><span class="comment">                            for leaf and vmax. */</span></div>
<div class="line">                        <span class="comment">/* Tissue respiration. See Amthor (1984) PCE 7, 561-*/</span> </div>
<div class="line">                        <span class="comment">/* The 0.02 and 0.03 are constants here but vary depending on species</span></div>
<div class="line"><span class="comment">                           as pointed out in that reference. */</span></div>
<div class="line">                        newLeaf = <a class="code" href="_aux_bio_cro_8c.html#aeb35169469ef33705592a28743d105bf">resp</a>(newLeaf, mrc1, temp[i]);</div>
<div class="line"></div>
<div class="line">                        *(sti+i) = newLeaf; <span class="comment">/* This populates the vector newLeafcol. It makes sense</span></div>
<div class="line"><span class="comment">                                               to use i because when kLeaf is negative no new leaf is</span></div>
<div class="line"><span class="comment">                                               being accumulated and thus would not be subjected to senescence */</span></div>
<div class="line">                }<span class="keywordflow">else</span>{</div>
<div class="line"></div>
<div class="line">                        newLeaf = Leaf * kLeaf ;</div>
<div class="line">                        Rhizome += kRhizome * -newLeaf * 0.9; <span class="comment">/* 0.9 is the efficiency of retranslocation */</span></div>
<div class="line">                        Stem += kStem * -newLeaf   * 0.9;</div>
<div class="line">                        Root += kRoot * -newLeaf * 0.9;</div>
<div class="line">                        Grain += kGrain * -newLeaf * 0.9;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(TTc &lt; SeneLeaf){</div>
<div class="line"></div>
<div class="line">                        Leaf += newLeaf;</div>
<div class="line"></div>
<div class="line">                }<span class="keywordflow">else</span>{</div>
<div class="line">    </div>
<div class="line">                        Leaf += newLeaf - *(sti+k); <span class="comment">/* This means that the new value of leaf is</span></div>
<div class="line"><span class="comment">                                                       the previous value plus the newLeaf</span></div>
<div class="line"><span class="comment">                                                       (Senescence might start when there is</span></div>
<div class="line"><span class="comment">                                                       still leaf being produced) minus the leaf</span></div>
<div class="line"><span class="comment">                                                       produced at the corresponding k.*/</span></div>
<div class="line">                        Remob = *(sti+k) * 0.6 ;</div>
<div class="line">                        LeafLitter += *(sti+k) * 0.4; <span class="comment">/* Collecting the leaf litter */</span> </div>
<div class="line">                        Rhizome += kRhizome * Remob;</div>
<div class="line">                        Stem += kStem * Remob; </div>
<div class="line">                        Root += kRoot * Remob;</div>
<div class="line">                        Grain += kGrain * Remob;</div>
<div class="line">                        k++;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* The specific leaf area declines with the growing season at least in</span></div>
<div class="line"><span class="comment">                   Miscanthus.  See Danalatos, Nalianis and Kyritsis &quot;Growth and Biomass</span></div>
<div class="line"><span class="comment">                   Productivity of Miscanthus sinensis &quot;Giganteus&quot; under optimum cultural</span></div>
<div class="line"><span class="comment">                   management in north-eastern greece*/</span></div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(i%24 == 0){</div>
<div class="line">                        Sp = iSp - (doy[i] - doy[0]) * SpD;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Rprintf(&quot;Sp %.2f \n&quot;, Sp); */</span></div>
<div class="line"></div>
<div class="line">                LAI = Leaf * Sp ;</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* New Stem*/</span></div>
<div class="line">                <span class="keywordflow">if</span>(kStem &gt; 0)</div>
<div class="line">                {</div>
<div class="line">                        newStem = CanopyA * kStem ;</div>
<div class="line">                        newStem = <a class="code" href="_aux_bio_cro_8c.html#aeb35169469ef33705592a28743d105bf">resp</a>(newStem, mrc1, temp[i]);</div>
<div class="line">                        *(sti2+i) = newStem;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(TTc &lt; SeneStem){</div>
<div class="line"></div>
<div class="line">                        Stem += newStem;</div>
<div class="line"></div>
<div class="line">                }<span class="keywordflow">else</span>{</div>
<div class="line"></div>
<div class="line">                        Stem += newStem - *(sti2+q);</div>
<div class="line">                        StemLitter += *(sti2+q);</div>
<div class="line">                        q++;</div>
<div class="line"></div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(kRoot &gt; 0)</div>
<div class="line">                {</div>
<div class="line">                        newRoot = CanopyA * kRoot ;</div>
<div class="line">                        newRoot = <a class="code" href="_aux_bio_cro_8c.html#aeb35169469ef33705592a28743d105bf">resp</a>(newRoot, mrc2, temp[i]);</div>
<div class="line">                        *(sti3+i) = newRoot;</div>
<div class="line">                }<span class="keywordflow">else</span>{</div>
<div class="line"></div>
<div class="line">                        newRoot = Root * kRoot ;</div>
<div class="line">                        Rhizome += kRhizome * -newRoot * 0.9;</div>
<div class="line">                        Stem += kStem * -newRoot       * 0.9;</div>
<div class="line">                        Leaf += kLeaf * -newRoot * 0.9;</div>
<div class="line">                        Grain += kGrain * -newRoot * 0.9;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(TTc &lt; SeneRoot){</div>
<div class="line"></div>
<div class="line">                        Root += newRoot;</div>
<div class="line"></div>
<div class="line">                }<span class="keywordflow">else</span>{</div>
<div class="line"></div>
<div class="line">                        Root += newRoot - *(sti3+m);</div>
<div class="line">                        RootLitter += *(sti3+m);</div>
<div class="line">                        m++;</div>
<div class="line"></div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(kRhizome &gt; 0)</div>
<div class="line">                {</div>
<div class="line">                        newRhizome = CanopyA * kRhizome ;</div>
<div class="line">                        newRhizome = <a class="code" href="_aux_bio_cro_8c.html#aeb35169469ef33705592a28743d105bf">resp</a>(newRhizome, mrc2, temp[i]);</div>
<div class="line">                        *(sti4+ri) = newRhizome;</div>
<div class="line">                        <span class="comment">/* Here i will not work because the rhizome goes from being a source</span></div>
<div class="line"><span class="comment">                           to a sink. I need its own index. Let&#39;s call it rhizome&#39;s i or ri.*/</span></div>
<div class="line">                        ri++;</div>
<div class="line">                }<span class="keywordflow">else</span>{</div>
<div class="line"></div>
<div class="line">                        <span class="keywordflow">if</span>(Rhizome &lt; 0){</div>
<div class="line">                                Rhizome = 1e-4;</div>
<div class="line">                                warning(<span class="stringliteral">&quot;Rhizome became negative&quot;</span>);</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                        newRhizome = Rhizome * kRhizome;</div>
<div class="line">                        Root += kRoot * -newRhizome ;</div>
<div class="line">                        Stem += kStem * -newRhizome ;</div>
<div class="line">                        Leaf += kLeaf * -newRhizome ;</div>
<div class="line">                        Grain += kGrain * -newRhizome;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(TTc &lt; SeneRhizome){</div>
<div class="line"></div>
<div class="line">                        Rhizome += newRhizome;</div>
<div class="line"></div>
<div class="line">                }<span class="keywordflow">else</span> {</div>
<div class="line"></div>
<div class="line">                        Rhizome += newRhizome - *(sti4+n);</div>
<div class="line">                        RhizomeLitter += *(sti4+n);</div>
<div class="line">                        n++;</div>
<div class="line"></div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>((kGrain &lt; 1e-10) || (TTc &lt; thermalp[4])){</div>
<div class="line">                        newGrain = 0.0;</div>
<div class="line">                        Grain += newGrain;</div>
<div class="line">                }<span class="keywordflow">else</span>{</div>
<div class="line">                        newGrain = CanopyA * kGrain;</div>
<div class="line">                        <span class="comment">/* No respiration for grain at the moment */</span></div>
<div class="line">                        <span class="comment">/* No senescence either */</span></div>
<div class="line">                        Grain += newGrain;  </div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                ALitter += LeafLitter + StemLitter;</div>
<div class="line">                BLitter += RootLitter + RhizomeLitter;</div>
<div class="line"></div>
<div class="line">                CanopyAssim[i] =  CanopyA;</div>
<div class="line">                Leafy[i] = Leaf;</div>
<div class="line">                Stemy[i] = Stem;</div>
<div class="line">                Rooty[i] =  Root;</div>
<div class="line">                Rhizomey[i] = Rhizome;</div>
<div class="line">                Grainy[i] = Grain;</div>
<div class="line">                LAIc[i] = LAI;</div>
<div class="line">        }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af2fd78212ed1cfbe6bd2d77f6ec851ec"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="struct_can___str.html">Can_Str</a> c3CanAC </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>DOY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>solarR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>WindSpeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Vmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Jmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Catm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>o2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>heightf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>leafN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kpLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lnfun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>StomWS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ws</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L295">295</a> of file <a class="el" href="">AuxwillowGro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line"></div>
<div class="line">   <span class="keyword">struct </span><a class="code" href="struct_e_t___str.html">ET_Str</a> tmp5_ET , tmp6_ET; </div>
<div class="line">   <span class="keyword">struct </span><a class="code" href="structc3__str.html">c3_str</a> tmpc3={0,0,0,0};</div>
<div class="line">   <span class="keyword">struct </span><a class="code" href="structc3__str.html">c3_str</a> tmpc32={0,0,0,0}; </div>
<div class="line">   <span class="keyword">struct </span><a class="code" href="struct_can___str.html">Can_Str</a> ans={0,0,0};</div>
<div class="line"></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> cf = 3600 * 1e-6 * 30 * 1e-6 * 10000;</div>
<div class="line"><span class="comment">/* Need a different conversion factor for transpiration */</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> cf2 = 3600 * 1e-3 * 18 * 1e-6 * 10000; </div>
<div class="line">        </div>
<div class="line">  <span class="keywordtype">int</span> i;</div>
<div class="line">  <span class="keywordtype">double</span> Idir, Idiff, cosTh;</div>
<div class="line">  <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#ac656f07a64aeba7d6ac5a3a536e993c8">LAIc</a>;</div>
<div class="line">  <span class="keywordtype">double</span> IDir, IDiff, Itot,rh, WindS;</div>
<div class="line">  <span class="keywordtype">double</span> TempIdir,TempIdiff,AssIdir,AssIdiff;</div>
<div class="line">  <span class="keywordtype">double</span>  pLeafsun, pLeafshade;</div>
<div class="line">  <span class="keywordtype">double</span> Leafsun, Leafshade;</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">double</span> CanopyA = 0.0;</div>
<div class="line">  <span class="keywordtype">double</span> GCanopyA = 0.0;</div>
<div class="line">  <span class="keywordtype">double</span> GAssIdir = 0.0;</div>
<div class="line">  <span class="keywordtype">double</span> GAssIdiff = 0.0; </div>
<div class="line">  <span class="keywordtype">double</span> CanopyT =0.0;;</div>
<div class="line">  <span class="keywordtype">double</span> CanopyPe = 0.0;</div>
<div class="line">  <span class="keywordtype">double</span> CanopyPr = 0.0;</div>
<div class="line">  <span class="keywordtype">double</span> CanopyC = 0.0;</div>
<div class="line">  <span class="keywordtype">double</span> chil=1.0;</div>
<div class="line">  <span class="keywordtype">double</span> CanHeight;</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">double</span> vmax1;</div>
<div class="line">  <span class="keywordtype">double</span> leafN_lay;</div>
<div class="line">  </div>
<div class="line"> <span class="comment">/* double StomWS;</span></div>
<div class="line"><span class="comment"> /* int ws;</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">        /* For Assimilation */</span></div>
<div class="line">        <span class="comment">/* 3600 converts seconds to hours */</span></div>
<div class="line">        <span class="comment">/* 1e-6 converts micro mols to mols */</span></div>
<div class="line">        <span class="comment">/* 30 is the grams in one mol of CO2 */</span></div>
<div class="line">        <span class="comment">/* 1e-6 converts g to Mg */</span></div>
<div class="line">        <span class="comment">/* 10000 scales from meter squared to hectare */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* For Transpiration */</span></div>
<div class="line">        <span class="comment">/* 3600 converts seconds to hours */</span></div>
<div class="line">        <span class="comment">/* 1e-3 converts mili mols to mols */</span></div>
<div class="line">        <span class="comment">/* 18 is the grams in one mol of H20 */</span></div>
<div class="line">        <span class="comment">/* 1e-6 converts g to Mg */</span></div>
<div class="line">        <span class="comment">/* 10000 scales from meter squared to hectare */</span></div>
<div class="line"></div>
<div class="line">         <a class="code" href="_aux_bio_cro_8c.html#a46827eb56108821fe82228553f535293">lightME</a>(lat,DOY,hr);</div>
<div class="line"></div>
<div class="line">  Idir = <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[0] * solarR;</div>
<div class="line">  Idiff = <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[1] * solarR;</div>
<div class="line">  cosTh = <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[2];</div>
<div class="line"></div>
<div class="line"><span class="comment">/* sun multilayer model. As a side effect it populates the layIdir, layItotal, layFsun, layHeight,</span></div>
<div class="line"><span class="comment">layIdiff, layShade vectors. */</span></div>
<div class="line">    </div>
<div class="line">    <a class="code" href="_aux_bio_cro_8c.html#acb415c4c261f9fc0140240ad46007c87">sunML</a>(Idir,Idiff,LAI,nlayers,cosTh,kd,chil,heightf);</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* results from multilayer model */</span></div>
<div class="line">    LAIc = LAI / nlayers;</div>
<div class="line">    <span class="comment">/* Next I need the RH and wind profile */</span></div>
<div class="line"></div>
<div class="line">    <a class="code" href="_aux_bio_cro_8c.html#a247148ac54cf7d8c851326de6093b71e">RHprof</a>(RH,nlayers);</div>
<div class="line">    <span class="comment">/* It populates tmp4. */</span></div>
<div class="line"></div>
<div class="line">     <a class="code" href="_aux_bio_cro_8c.html#a43b0d68a959084dc4f4dc099c8901107">WINDprof</a>(WindSpeed,LAI,nlayers);</div>
<div class="line">    <span class="comment">/* It populates tmp3. */</span></div>
<div class="line"></div>
<div class="line">     <a class="code" href="_aux_bio_cro_8c.html#aa65c89edaec63830e4dd568a89d12fa2">LNprof</a>(leafN, LAI, nlayers, kpLN);</div>
<div class="line">    <span class="comment">/* It populates tmp5 */</span></div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Next use the EvapoTrans function */</span></div>
<div class="line">    CanopyA=0.0;</div>
<div class="line">    CanopyT=0.0;</div>
<div class="line">    GCanopyA=0.0;</div>
<div class="line">    <span class="keywordflow">for</span>(i=0;i&lt;nlayers;i++)</div>
<div class="line">    {</div>
<div class="line"><span class="comment">/* vmax depends on leaf nitrogen and this in turn depends on the layer */</span></div>
<div class="line">      leafN_lay = <a class="code" href="_aux_bio_cro_8h.html#aaa2add75bf14b805a4da749043e7be33">tmp5</a>[--<a class="code" href="_aux_bio_cro_8h.html#a39f70a6dfb72439e2f4e0f03f27c0813">tp5</a>];</div>
<div class="line">            <span class="keywordflow">if</span>(lnfun == 0){</div>
<div class="line">                    vmax1 = Vmax;</div>
<div class="line">            }<span class="keywordflow">else</span>{</div>
<div class="line">                    vmax1 = leafN_lay * lnb1 + lnb0;</div>
<div class="line"><span class="comment">/* For now alpha is not affected by leaf nitrogen */</span></div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            IDir = <a class="code" href="_aux_bio_cro_8h.html#ab0638a2083d3e8d4c1ac43a116da1ad8">layIdir</a>[--<a class="code" href="_aux_bio_cro_8h.html#a287f9452c1f62b4c5c9ec0616503fb8e">sp1</a>];</div>
<div class="line">            Itot = <a class="code" href="_aux_bio_cro_8h.html#a1e5f45a584d3c5541472f92c5875e4ea">layItotal</a>[--<a class="code" href="_aux_bio_cro_8h.html#a959c4cc4acdec59096dac039bfdb627b">sp3</a>];</div>
<div class="line">            </div>
<div class="line">            rh = <a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>[--<a class="code" href="_aux_bio_cro_8h.html#a36e4d9011835445995335074adedad9a">tp4</a>];</div>
<div class="line">            WindS = <a class="code" href="_aux_bio_cro_8h.html#a15219c620f8cdf6d8cf731e485e2c668">tmp3</a>[--<a class="code" href="_aux_bio_cro_8h.html#af8b40a97721000892ae5e0ac624af4c6">tp3</a>];</div>
<div class="line"></div>
<div class="line">            pLeafsun = <a class="code" href="_aux_bio_cro_8h.html#a029005f88756e3761a72c104fae0d57b">layFsun</a>[--<a class="code" href="_aux_bio_cro_8h.html#a25e1abfffbd0ba6bcb9e7d2b6c847c04">sp4</a>];</div>
<div class="line">            CanHeight = <a class="code" href="_aux_bio_cro_8h.html#a5ebe5f68c3871953059c08a083acdb9c">layHeight</a>[--<a class="code" href="_aux_bio_cro_8h.html#ac86af9361847656ad3514e64ad9e9842">sp6</a>];</div>
<div class="line">            Leafsun = LAIc * pLeafsun;</div>
<div class="line"><span class="comment">/* Need a new evapo transpiration function specifically for c3*/</span></div>
<div class="line">            tmp5_ET = <a class="code" href="_auxwillow_gro_8h.html#a14fc4c1327518e9237f587b37400ac97">c3EvapoTrans</a>(IDir,Itot,Temp,rh,WindS,LAIc,CanHeight,</div>
<div class="line">                                 Vmax,Jmax,Rd,b0,b1,Catm,o2,theta);</div>
<div class="line">            TempIdir = Temp + tmp5_ET.Deltat;</div>
<div class="line">            tmpc3 = <a class="code" href="c3photo_8c.html#ad30b1a99fb440301345822cb38fb5cbe">c3photoC</a>(IDir,TempIdir,rh,Vmax,Jmax,Rd,b0,b1,Catm,o2,theta,StomWS,ws);</div>
<div class="line">            AssIdir = tmpc3.<a class="code" href="structc3__str.html#a7adeee8f55ac1ffe5e9c226823ae4251">Assim</a>;</div>
<div class="line">      GAssIdir =tmpc3.<a class="code" href="structc3__str.html#ac2cb333c4e7bdd22c4c9672c80ed977f">GrossAssim</a>;</div>
<div class="line"></div>
<div class="line">            IDiff = <a class="code" href="_aux_bio_cro_8h.html#a0b8103786ef18d899e25c932a2eb5b88">layIdiff</a>[--<a class="code" href="_aux_bio_cro_8h.html#a972c42de1800efab3685fc8a47e05da5">sp2</a>];</div>
<div class="line">            pLeafshade = <a class="code" href="_aux_bio_cro_8h.html#a5a00a948cd8575f53c71ee1f4b799da5">layFshade</a>[--<a class="code" href="_aux_bio_cro_8h.html#a048d95ccd2cc9d2f00c78c97343c9a6a">sp5</a>];</div>
<div class="line">            Leafshade = LAIc * pLeafshade;</div>
<div class="line">            tmp6_ET = <a class="code" href="_auxwillow_gro_8h.html#a14fc4c1327518e9237f587b37400ac97">c3EvapoTrans</a>(IDiff,Itot,Temp,rh,WindS,LAIc,CanHeight,</div>
<div class="line">                         Vmax,Jmax,Rd,b0,b1,Catm,o2,theta);</div>
<div class="line">            TempIdiff = Temp + tmp6_ET.Deltat;</div>
<div class="line">            tmpc32 = <a class="code" href="c3photo_8c.html#ad30b1a99fb440301345822cb38fb5cbe">c3photoC</a>(IDiff,TempIdir,rh,Vmax,Jmax,Rd,b0,b1,Catm,o2,theta,StomWS,ws);</div>
<div class="line">            AssIdiff = tmpc32.<a class="code" href="structc3__str.html#a7adeee8f55ac1ffe5e9c226823ae4251">Assim</a>;</div>
<div class="line">      GAssIdiff = tmpc32.<a class="code" href="structc3__str.html#ac2cb333c4e7bdd22c4c9672c80ed977f">GrossAssim</a>;</div>
<div class="line"></div>
<div class="line">                CanopyA =CanopyA + Leafsun * AssIdir + Leafshade * AssIdiff;</div>
<div class="line">                CanopyT = CanopyT+Leafsun * tmp5_ET.TransR + Leafshade * tmp6_ET.TransR;</div>
<div class="line">    GCanopyA =GCanopyA+ Leafsun * GAssIdir + Leafshade * GAssIdiff;</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">/*## These are micro mols of CO2 per m2 per sec for Assimilation</span></div>
<div class="line"><span class="comment">          ## and mili mols of H2O per m2 per sec for Transpiration</span></div>
<div class="line"><span class="comment">          ## Need to convert to </span></div>
<div class="line"><span class="comment">          ## 3600 converts seconds to hours</span></div>
<div class="line"><span class="comment">          ## 10^-6 converts micro mols to mols</span></div>
<div class="line"><span class="comment">          ## 30 converts mols of CO2 to grams</span></div>
<div class="line"><span class="comment">          ## (1/10^6) converts grams to Mg</span></div>
<div class="line"><span class="comment">          ## 10000 scales up to ha */</span></div>
<div class="line"><span class="comment">/* A similar conversion is made for water but</span></div>
<div class="line"><span class="comment">   replacing 30 by 18 and mili mols are converted to</span></div>
<div class="line"><span class="comment">   mols (instead of micro) */</span></div>
<div class="line">        ans.<a class="code" href="struct_can___str.html#a7adeee8f55ac1ffe5e9c226823ae4251">Assim</a> = cf * CanopyA ;</div>
<div class="line">        ans.<a class="code" href="struct_can___str.html#af8fba6423eb33d2551d878ee6675cb79">Trans</a> = cf2 * CanopyT; </div>
<div class="line">  ans.<a class="code" href="struct_can___str.html#ac2cb333c4e7bdd22c4c9672c80ed977f">GrossAssim</a>=cf*GCanopyA;</div>
<div class="line"><span class="comment">//  Rprintf(&quot;CF= %f ,Gross Canopy = %f \n&quot;, cf,GCanopyA);</span></div>
<div class="line"><span class="comment">//  Rprintf(&quot;C3photo function is returnin Direst Anet=%f, Agross=%f. Diffuses Anet=%f, Agross=%f \n&quot;,AssIdir,GAssIdir,AssIdiff,GAssIdiff);</span></div>
<div class="line"><span class="comment">//  Rprintf(&quot;C3 Can function is returning CanA=%f, CanT=%f, CanGrossA =%f\n&quot;,ans.Assim, ans.Trans, ans.GrossAssim);</span></div>
<div class="line">        <span class="keywordflow">return</span>(ans);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad67c5b654f4bceb23717a84244291ea0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="struct_can___str.html">Can_Str</a> CanAC </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>DOY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>solarR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>WindSpeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Vmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kparm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Catm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>StomataWS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>chil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>heightf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>leafN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kpLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lnfun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>upperT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lowerT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structnitro_parms.html">nitroParms</a>&#160;</td>
          <td class="paramname"><em>nitroP</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L539">539</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line"></div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="struct_e_t___str.html">ET_Str</a> tmp5_ET, tmp6_ET;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="struct_can___str.html">Can_Str</a> ans;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structc4__str.html">c4_str</a> tmpc4;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structc4__str.html">c4_str</a> tmpc42;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <span class="keywordtype">double</span> Idir, Idiff, cosTh;</div>
<div class="line">        <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#ac656f07a64aeba7d6ac5a3a536e993c8">LAIc</a>;</div>
<div class="line">        <span class="keywordtype">double</span> IDir, IDiff, Itot, rh, WS;</div>
<div class="line">        <span class="keywordtype">double</span> pLeafsun, pLeafshade;</div>
<div class="line">        <span class="keywordtype">double</span> Leafsun, Leafshade;</div>
<div class="line">        <span class="keywordtype">double</span> CanHeight;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> vmax1, leafN_lay;</div>
<div class="line">        <span class="keywordtype">double</span> TempIdir,TempIdiff,AssIdir,AssIdiff,GAssIdir,GAssIdiff;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> CanopyA, CanopyT,GCanopyA;</div>
<div class="line"></div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> cf = 3600 * 1e-6 * 30 * 1e-6 * 10000;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> cf2 = 3600 * 1e-3 * 18 * 1e-6 * 10000; </div>
<div class="line"></div>
<div class="line">        <span class="comment">/* For Assimilation */</span></div>
<div class="line">        <span class="comment">/* 3600 converts seconds to hours */</span></div>
<div class="line">        <span class="comment">/* 1e-6 converts micro mols to mols */</span></div>
<div class="line">        <span class="comment">/* 30 is the grams in one mol of CO2 */</span></div>
<div class="line">        <span class="comment">/* 1e-6 converts g to Mg */</span></div>
<div class="line">        <span class="comment">/* 10000 scales from meter squared to hectare */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* For Transpiration */</span></div>
<div class="line">        <span class="comment">/* 3600 converts seconds to hours */</span></div>
<div class="line">        <span class="comment">/* 1e-3 converts mili mols to mols */</span></div>
<div class="line">        <span class="comment">/* 18 is the grams in one mol of H20 */</span></div>
<div class="line">        <span class="comment">/* 1e-6 converts g to Mg */</span></div>
<div class="line">        <span class="comment">/* 10000 scales from meter squared to hectare */</span></div>
<div class="line"></div>
<div class="line">        <a class="code" href="_aux_bio_cro_8c.html#a46827eb56108821fe82228553f535293">lightME</a>(lat,DOY,hr);</div>
<div class="line"></div>
<div class="line">        Idir = <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[0] * solarR;</div>
<div class="line">        Idiff = <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[1] * solarR;</div>
<div class="line">        cosTh = <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[2];</div>
<div class="line">    </div>
<div class="line">        <a class="code" href="_aux_bio_cro_8c.html#acb415c4c261f9fc0140240ad46007c87">sunML</a>(Idir,Idiff,LAI,nlayers,cosTh, kd, chil, heightf);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* results from multilayer model */</span></div>
<div class="line">        LAIc = LAI / nlayers;</div>
<div class="line">        <span class="comment">/* Next I need the RH and wind profile */</span></div>
<div class="line">        <a class="code" href="_aux_bio_cro_8c.html#a247148ac54cf7d8c851326de6093b71e">RHprof</a>(RH,nlayers);</div>
<div class="line">        <a class="code" href="_aux_bio_cro_8c.html#a43b0d68a959084dc4f4dc099c8901107">WINDprof</a>(WindSpeed,LAI,nlayers);</div>
<div class="line"></div>
<div class="line">        <a class="code" href="_aux_bio_cro_8c.html#aa65c89edaec63830e4dd568a89d12fa2">LNprof</a>(leafN, LAI, nlayers, kpLN);</div>
<div class="line">        <span class="comment">/* It populates tmp5 */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Next use the EvapoTrans function */</span></div>
<div class="line">        CanopyA=0.0;</div>
<div class="line">        GCanopyA=0.0;</div>
<div class="line">        CanopyT=0.0;</div>
<div class="line">        <span class="keywordflow">for</span>(i=0;i&lt;nlayers;i++)</div>
<div class="line">        {</div>
<div class="line">                leafN_lay = <a class="code" href="_aux_bio_cro_8h.html#aaa2add75bf14b805a4da749043e7be33">tmp5</a>[--<a class="code" href="_aux_bio_cro_8h.html#a39f70a6dfb72439e2f4e0f03f27c0813">tp5</a>];</div>
<div class="line">                <span class="keywordflow">if</span>(lnfun == 0){</div>
<div class="line">                        vmax1 = Vmax;</div>
<div class="line">                }<span class="keywordflow">else</span>{</div>
<div class="line">                        vmax1 = leafN_lay * lnb1 + lnb0;</div>
<div class="line">               <span class="comment">/* For now alpha is not affected by leaf nitrogen */</span></div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                IDir = <a class="code" href="_aux_bio_cro_8h.html#ab0638a2083d3e8d4c1ac43a116da1ad8">layIdir</a>[--<a class="code" href="_aux_bio_cro_8h.html#a287f9452c1f62b4c5c9ec0616503fb8e">sp1</a>];</div>
<div class="line">                Itot = <a class="code" href="_aux_bio_cro_8h.html#a1e5f45a584d3c5541472f92c5875e4ea">layItotal</a>[--<a class="code" href="_aux_bio_cro_8h.html#a959c4cc4acdec59096dac039bfdb627b">sp3</a>];</div>
<div class="line"></div>
<div class="line">                rh = <a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>[--<a class="code" href="_aux_bio_cro_8h.html#a36e4d9011835445995335074adedad9a">tp4</a>];</div>
<div class="line">                WS = <a class="code" href="_aux_bio_cro_8h.html#a15219c620f8cdf6d8cf731e485e2c668">tmp3</a>[--<a class="code" href="_aux_bio_cro_8h.html#af8b40a97721000892ae5e0ac624af4c6">tp3</a>];</div>
<div class="line">                pLeafsun = <a class="code" href="_aux_bio_cro_8h.html#a029005f88756e3761a72c104fae0d57b">layFsun</a>[--<a class="code" href="_aux_bio_cro_8h.html#a25e1abfffbd0ba6bcb9e7d2b6c847c04">sp4</a>];</div>
<div class="line">                CanHeight = <a class="code" href="_aux_bio_cro_8h.html#a5ebe5f68c3871953059c08a083acdb9c">layHeight</a>[--<a class="code" href="_aux_bio_cro_8h.html#ac86af9361847656ad3514e64ad9e9842">sp6</a>];</div>
<div class="line">                Leafsun = LAIc * pLeafsun;</div>
<div class="line">                tmp5_ET = <a class="code" href="_aux_bio_cro_8c.html#a05f213f4cb25cf49735180ff3b883107">EvapoTrans</a>(IDir,Itot,Temp,rh,WS,LAIc,CanHeight,StomataWS,ws,vmax1,Alpha,Kparm,theta,beta,Rd,b0,b1,upperT,lowerT,Catm);</div>
<div class="line">                TempIdir = Temp + tmp5_ET.Deltat;</div>
<div class="line">                tmpc4 = <a class="code" href="c4photo_8c.html#ae71c7850944d255a9b995a06fdb305aa">c4photoC</a>(IDir,TempIdir,rh,vmax1,Alpha,Kparm,theta,beta,Rd,b0,b1,StomataWS, Catm, ws,upperT,lowerT);</div>
<div class="line">                AssIdir = tmpc4.Assim;</div>
<div class="line">    GAssIdir =tmpc4.GrossAssim;</div>
<div class="line"></div>
<div class="line">                IDiff = <a class="code" href="_aux_bio_cro_8h.html#a0b8103786ef18d899e25c932a2eb5b88">layIdiff</a>[--<a class="code" href="_aux_bio_cro_8h.html#a972c42de1800efab3685fc8a47e05da5">sp2</a>];</div>
<div class="line">                pLeafshade = <a class="code" href="_aux_bio_cro_8h.html#a5a00a948cd8575f53c71ee1f4b799da5">layFshade</a>[--<a class="code" href="_aux_bio_cro_8h.html#a048d95ccd2cc9d2f00c78c97343c9a6a">sp5</a>];</div>
<div class="line">                Leafshade = LAIc * pLeafshade;</div>
<div class="line">                tmp6_ET = <a class="code" href="_aux_bio_cro_8c.html#a05f213f4cb25cf49735180ff3b883107">EvapoTrans</a>(IDiff,Itot,Temp,rh,WS,LAIc,CanHeight,StomataWS,ws,vmax1,Alpha,Kparm,theta,beta,Rd,b0,b1,upperT,lowerT,Catm);</div>
<div class="line">                TempIdiff = Temp + tmp6_ET.Deltat;</div>
<div class="line">                tmpc42 = <a class="code" href="c4photo_8c.html#ae71c7850944d255a9b995a06fdb305aa">c4photoC</a>(IDiff,TempIdiff,rh,vmax1,Alpha,Kparm,theta,beta,Rd,b0,b1,StomataWS, Catm, ws,upperT,lowerT);</div>
<div class="line">                AssIdiff = tmpc42.Assim;</div>
<div class="line">    GAssIdiff = tmpc42.GrossAssim;</div>
<div class="line">                CanopyA += Leafsun * AssIdir + Leafshade * AssIdiff;</div>
<div class="line">    GCanopyA += Leafsun * GAssIdir + Leafshade * GAssIdiff;</div>
<div class="line"><span class="comment">// I am evaluating CanopyT using Penman Method because it gives realistic results</span></div>
<div class="line"><span class="comment">// IN future canopyT needs to be fixed</span></div>
<div class="line"><span class="comment">//                CanopyT += Leafsun * tmp5_ET.TransR + Leafshade * tmp6_ET.TransR;</span></div>
<div class="line">                CanopyT += Leafsun * tmp5_ET.EPenman + Leafshade * tmp6_ET.EPenman;</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">/*## These are micro mols of CO2 per m2 per sec for Assimilation</span></div>
<div class="line"><span class="comment">          ## and mili mols of H2O per m2 per sec for Transpiration</span></div>
<div class="line"><span class="comment">          ## Need to convert to </span></div>
<div class="line"><span class="comment">          ## 3600 converts seconds to hours</span></div>
<div class="line"><span class="comment">          ## 10^-6 converts micro mols to mols</span></div>
<div class="line"><span class="comment">          ## 30 converts mols of CO2 to grams</span></div>
<div class="line"><span class="comment">          ## (1/10^6) converts grams to Mg</span></div>
<div class="line"><span class="comment">          ## 10000 scales up to ha */</span></div>
<div class="line"><span class="comment">/* A similar conversion is made for water but</span></div>
<div class="line"><span class="comment">   replacing 30 by 18 and mili mols are converted to</span></div>
<div class="line"><span class="comment">   mols (instead of micro) */</span></div>
<div class="line">        ans.Assim = cf * CanopyA ;</div>
<div class="line">        ans.Trans = cf2 * CanopyT; </div>
<div class="line">        ans.GrossAssim=cf*GCanopyA;</div>
<div class="line">        <span class="keywordflow">return</span>(ans);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab2c40f1d5cbe9760e48568b236467a16"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structcen_t__str.html">cenT_str</a> Century </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>LeafL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>StemL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>RootL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>RhizL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>smoist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>stemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>timestep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>SCs</em>[9], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>leachWater</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Nfert</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>MinN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>precip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LeafL_Ln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>StemL_Ln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RootL_Ln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RhizL_Ln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LeafL_N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>StemL_N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RootL_N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RhizL_N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>soilType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Ks_cf</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L21">21</a> of file <a class="el" href="">Century.c</a>.</p>
<div class="fragment"><div class="line">                                        {</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Converting Mg ha^-1 to g m^-2 */</span></div>
<div class="line">  <span class="comment">/* 1 Mg = 1e6 grams*/</span></div>
<div class="line">  <span class="comment">/* 1 ha = 1e4 m^2 */</span>  </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> cf = 100;</div>
<div class="line">  *LeafL *= cf; </div>
<div class="line">  *StemL *= cf;</div>
<div class="line">  *RootL *= cf;</div>
<div class="line">  *RhizL *= cf;</div>
<div class="line"></div>
<div class="line">  <span class="keyword">struct </span><a class="code" href="structcen_t__str.html">cenT_str</a> tmp;</div>
<div class="line">  <span class="keyword">struct </span><a class="code" href="structsoil_text__str.html">soilText_str</a> soilTemp;</div>
<div class="line"></div>
<div class="line">  <span class="keyword">struct </span><a class="code" href="struct_f_l__str.html">FL_str</a> FmLc_Leaf, FmLc_Stem, FmLc_Root, FmLc_Rhiz;</div>
<div class="line">  <span class="keyword">struct </span><a class="code" href="structflow__str.html">flow_str</a> C1_5_Leaf, C2_5_Leaf, C1_5_Stem, C2_5_Stem;</div>
<div class="line">  <span class="keyword">struct </span><a class="code" href="structflow__str.html">flow_str</a> C1_7_Leaf_Ln, C1_7_Stem_Ln;</div>
<div class="line">  <span class="keyword">struct </span><a class="code" href="structflow__str.html">flow_str</a> C3_6_Root, C4_6_Root, C3_6_Rhiz, C4_6_Rhiz;</div>
<div class="line">  <span class="keyword">struct </span><a class="code" href="structflow__str.html">flow_str</a> C3_7_Root_Ln, C3_7_Rhiz_Ln;</div>
<div class="line">  <span class="keyword">struct </span><a class="code" href="structflow__str.html">flow_str</a> C5_7, C6, C7, C8_6;</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">double</span> C6_7, C6_8, C6_9, C7_6, C7_8;</div>
<div class="line">  <span class="keywordtype">double</span> C_ap, C_al, C_sp; </div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">double</span> SC1_Leaf, SC2_Leaf, SC1_Stem, SC2_Stem;</div>
<div class="line">  <span class="keywordtype">double</span> SC3_Root, SC4_Root, SC3_Rhiz, SC4_Rhiz;</div>
<div class="line"></div>
<div class="line"><span class="comment">/*  </span></div>
<div class="line"><span class="comment">    I need the separate fractions of Leaf Litter and Stem Litter </span></div>
<div class="line"><span class="comment">  Because they have different lignin to N ratios </span></div>
<div class="line"><span class="comment">  Presumably, the rhizome and root are similar </span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">  There is an issue here that I should be careful about I&#39;m importing </span></div>
<div class="line"><span class="comment">  biomass, but need only carbon in some of these calculations </span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">  I also need to determine the initial values of carbon for each </span></div>
<div class="line"><span class="comment">  component </span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"></div>
<div class="line">  soilTemp = <a class="code" href="_aux_bio_cro_8c.html#a72f93049960e067cda6e7291ff1ff21a">soilTchoose</a>(soilType);  </div>
<div class="line">  <span class="keywordtype">double</span> T = soilTemp.clay + soilTemp.silt; <span class="comment">/*  silt plus clay content of the soil */</span></div>
<div class="line">  <span class="keywordtype">double</span> Ts = soilTemp.sand; <span class="comment">/*  Sand content of the soil */</span></div>
<div class="line">  <span class="keywordtype">double</span> Tc = soilTemp.clay; <span class="comment">/*  Clay content of the soil */</span></div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">double</span> CN_structural = 150;</div>
<div class="line">  <span class="keywordtype">double</span> CN_surface;</div>
<div class="line">  <span class="keywordtype">double</span> CN_active ;</div>
<div class="line">  <span class="keywordtype">double</span> CN_slow ;</div>
<div class="line">  <span class="keywordtype">double</span> CN_passive ;</div>
<div class="line">  </div>
<div class="line">  <span class="keywordtype">double</span> SN1, SN2, SN3, SN4, SN5, SN6, SN7, SN8, SN9;</div>
<div class="line">  <span class="keywordtype">double</span> SC1, SC2, SC3, SC4, SC5, SC6, SC7, SC8, SC9;</div>
<div class="line">  <span class="keywordtype">double</span> Abiot;</div>
<div class="line">  <span class="keywordtype">double</span> Na = 0.0, Nf = 0.0;</div>
<div class="line">  <span class="keywordtype">double</span> PlantN;</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">double</span> SC1_Leaf_Ln, SC1_Stem_Ln;</div>
<div class="line">  <span class="keywordtype">double</span> SC3_Root_Ln, SC3_Rhiz_Ln;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Converting from Mg ha^-1 to g m^-2 */</span></div>
<div class="line">  SC1 = SCs[0] * cf;</div>
<div class="line">  SC2 = SCs[1] * cf;</div>
<div class="line">  SC3 = SCs[2] * cf;</div>
<div class="line">  SC4 = SCs[3] * cf;</div>
<div class="line">  SC5 = SCs[4] * cf;</div>
<div class="line">  SC6 = SCs[5] * cf;</div>
<div class="line">  SC7 = SCs[6] * cf;</div>
<div class="line">  SC8 = SCs[7] * cf;</div>
<div class="line">  SC9 = SCs[8] * cf;</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">double</span> <a class="code" href="structflow__str.html#a2e85af08e1b5ef823f43b8fea56f85d7">MinN</a> = 0.0, <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a> = 0.0;</div>
<div class="line">  </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> respC1_5 = 0.6;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> respC1_7 = 0.3;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> respC3_7 = 0.3;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> respC2_5 = 0.6;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> respC3_6 = 0.55;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> respC4_6 = 0.55;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> respC5_7 = 0.6;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> respC6 = 0.85 - 0.68 * T;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> respC7 = 0.55;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> respC8 = 0.55;</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">double</span> Ks[8];</div>
<div class="line">  </div>
<div class="line">  <span class="comment">/*  Tm is the effect of soil texture on active SOM turnover */</span></div>
<div class="line">  <span class="keywordtype">double</span> Tm = 1 - 0.75 * T;</div>
<div class="line"></div>
<div class="line"><span class="comment">/*    The flow constants are taken from the paper </span></div>
<div class="line"><span class="comment">      and Parton et al. 1993 Global Biogeochemistry pg 785 </span></div>
<div class="line"><span class="comment">      but </span></div>
<div class="line"><span class="comment">      Parton et al. 1987 SSSJ 51:1173 </span></div>
<div class="line"><span class="comment">      is also relevant</span></div>
<div class="line"><span class="comment">    </span></div>
<div class="line"><span class="comment">      double Ksy[ ] = { 3.9, 4.9, 7.3, 6.0, 14.8, 18.5, 0.2, 0.0045 };     The units are year^-1  </span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">      To get the rates per week we can divide by 52</span></div>
<div class="line"><span class="comment">      To get the rates poer day we can divide by 365</span></div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"><span class="comment">/* It seems that the rates are the ones reported in Parton et al. 1993 Global Biogeochemical Cycles */</span></div>
<div class="line"><span class="comment">/* These are annual rates and to convert to other time steps the model should be run accordingly */</span></div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Rprintf(&quot;Ks[3] : %f Ks[4] : %f \n&quot;,Ks[3],Ks[4]); */</span></div>
<div class="line">    <span class="comment">/* Rprintf(&quot;Ks[5] : %f Ks[6] : %f \n&quot;,Ks[5],Ks[6]); */</span></div>
<div class="line"></div>
<div class="line">     <span class="keywordflow">if</span>(timestep == 7){</div>
<div class="line">       Ks[0] = Ks_cf[0] / 52 ;</div>
<div class="line">       Ks[1] = Ks_cf[1] / 52 ;</div>
<div class="line">       Ks[2] = Ks_cf[2] / 52 ;</div>
<div class="line">       Ks[3] = Ks_cf[3] / 52 ;</div>
<div class="line">       Ks[4] = Ks_cf[4] / 52 ;</div>
<div class="line">       Ks[5] = Ks_cf[5] / 52 ;</div>
<div class="line">       Ks[6] = Ks_cf[6] / 52 ;</div>
<div class="line">       Ks[7] = Ks_cf[7] / 52 ;</div>
<div class="line">     }<span class="keywordflow">else</span></div>
<div class="line">     <span class="keywordflow">if</span>(timestep == 1){   </div>
<div class="line">       Ks[0] = Ks_cf[0] / 365 ; </div>
<div class="line">       Ks[1] = Ks_cf[1] / 365 ; </div>
<div class="line">       Ks[2] = Ks_cf[2] / 365 ; </div>
<div class="line">       Ks[3] = Ks_cf[3] / 365 ; </div>
<div class="line">       Ks[4] = Ks_cf[4] / 365 ; </div>
<div class="line">       Ks[5] = Ks_cf[5] / 365 ; </div>
<div class="line">       Ks[6] = Ks_cf[6] / 365 ; </div>
<div class="line">       Ks[7] = Ks_cf[7] / 365 ;  </div>
<div class="line">     } </div>
<div class="line"></div>
<div class="line"><span class="comment">/* Nitrogen processes </span></div>
<div class="line"><span class="comment">    N deposition */</span></div>
<div class="line"></div>
<div class="line">  Na = 0.21 + 0.0028 * precip * 0.10 ;  <span class="comment">/*precipitation is entered in mm</span></div>
<div class="line"><span class="comment">                                          but it is needed in cm for this</span></div>
<div class="line"><span class="comment">                                           equation. Idem below */</span></div>
<div class="line"></div>
<div class="line">  <span class="comment">/*  N fixation */</span></div>
<div class="line">  Nf = -0.18 + 0.014 * precip * 0.10 ; </div>
<div class="line"></div>
<div class="line">  <span class="comment">/* The resulting N is in g N m^-2 yr^-1 </span></div>
<div class="line"><span class="comment">   Conversions</span></div>
<div class="line"><span class="comment">   g =&gt; Mg : multiply by 1e-6</span></div>
<div class="line"><span class="comment">   m^2 =&gt; ha : multiply by 1e4</span></div>
<div class="line"><span class="comment">   year to week : divide by 52 */</span></div>
<div class="line">  <span class="keywordflow">if</span>(timestep == 7){</div>
<div class="line">     Na /=  52;</div>
<div class="line">     Nf /=  52;</div>
<div class="line">  }<span class="keywordflow">else</span></div>
<div class="line">  <span class="keywordflow">if</span>(timestep == 1){</div>
<div class="line">     Na /=  365;</div>
<div class="line">     Nf /=  365;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line"><span class="comment">/*   Rprintf(&quot;Na : %f \n&quot;,Na); */</span></div>
<div class="line"><span class="comment">/*   Rprintf(&quot;Nf : %f \n&quot;,Nf); */</span></div>
<div class="line"><span class="comment">/*   Nitrogen in the form of fertilizer */</span></div>
<div class="line"><span class="comment">/*   The input units should be in g N m^2 */</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/*   Rprintf(&quot;Nfert : %f iMinN : %f \n&quot;,Nfert,iMinN); */</span></div>
<div class="line">  MinN = Na + Nf + Nfert + iMinN;</div>
<div class="line"></div>
<div class="line"><span class="comment">/*   Rprintf(&quot;MinN 0: %f \n&quot;,MinN); */</span></div>
<div class="line"></div>
<div class="line">  PlantN = *LeafL * LeafL_N + *StemL * StemL_N;</div>
<div class="line"></div>
<div class="line">  CN_surface = 20 - PlantN * 5;</div>
<div class="line">  CN_active = 15 - MinN * 6;</div>
<div class="line">  CN_slow = 20 - MinN * 4;</div>
<div class="line">  CN_passive = 10 - MinN * 1.5;</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span>(PlantN &gt; 2) CN_surface = 10;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/*   Here 2 is g m^-2 */</span></div>
<div class="line">  <span class="keywordflow">if</span>(MinN &gt; 2){</div>
<div class="line">    CN_active = 3;</div>
<div class="line">    CN_passive = 7;</div>
<div class="line">    CN_slow = 12;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  SN1 = SC1 / CN_structural; </div>
<div class="line">  SN2 = SC2 / CN_active;</div>
<div class="line">  SN3 = SC3 / CN_structural;</div>
<div class="line">  SN4 = SC4 / CN_active;</div>
<div class="line">  SN5 = SC5 / CN_active;</div>
<div class="line">  SN6 = SC6 / CN_active;</div>
<div class="line">  SN7 = SC7 / CN_slow;</div>
<div class="line">  SN8 = SC8 / CN_passive;</div>
<div class="line">  SN9 = SC9 / CN_passive;</div>
<div class="line"></div>
<div class="line"><span class="comment">/*  Need to calculate the effect of temperature and moisture. */</span></div>
<div class="line"></div>
<div class="line">  Abiot = <a class="code" href="_bio_cro_8h.html#a1061dc2ec428954d1e4fd2abd8e17957">AbiotEff</a>(smoist, stemp);</div>
<div class="line"></div>
<div class="line"><span class="comment">/*    Calculate Fm and Lc separately for each component */</span></div>
<div class="line">  FmLc_Leaf = <a class="code" href="_bio_cro_8h.html#ab1f878344b2d2444f096bd0da2cb9f24">FmLcFun</a>(LeafL_Ln,LeafL_N);</div>
<div class="line">  FmLc_Stem = <a class="code" href="_bio_cro_8h.html#ab1f878344b2d2444f096bd0da2cb9f24">FmLcFun</a>(StemL_Ln,StemL_N);</div>
<div class="line">  FmLc_Root = <a class="code" href="_bio_cro_8h.html#ab1f878344b2d2444f096bd0da2cb9f24">FmLcFun</a>(RootL_Ln,RootL_N);</div>
<div class="line">  FmLc_Rhiz = <a class="code" href="_bio_cro_8h.html#ab1f878344b2d2444f096bd0da2cb9f24">FmLcFun</a>(RhizL_Ln,RhizL_N);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/*  Surface Metabolic Carbon */</span></div>
<div class="line">  SC2_Leaf = FmLc_Leaf.Fm * *LeafL;</div>
<div class="line">  SC2_Stem = FmLc_Stem.Fm * *StemL;</div>
<div class="line">  <span class="comment">/*  Root Metabolic Carbon */</span></div>
<div class="line">  SC4_Root = FmLc_Root.Fm * *RootL;</div>
<div class="line">  SC4_Rhiz = FmLc_Rhiz.Fm * *RhizL;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/*  Surface Structural Carbon */</span></div>
<div class="line">  SC1_Leaf = (1 - FmLc_Leaf.Fm) * *LeafL;</div>
<div class="line">  SC1_Stem = (1 - FmLc_Stem.Fm) * *StemL;</div>
<div class="line">  <span class="comment">/* Lignin content needs to be considered separately */</span></div>
<div class="line">  SC1_Leaf_Ln = SC1_Leaf * LeafL_Ln;</div>
<div class="line">  SC1_Stem_Ln = SC1_Stem * StemL_Ln;</div>
<div class="line">  SC1_Leaf = SC1_Leaf - SC1_Leaf_Ln;</div>
<div class="line">  SC1_Stem = SC1_Stem - SC1_Stem_Ln;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/*  Root Structural Carbon */</span></div>
<div class="line">  SC3_Root = (1 - FmLc_Root.Fm) * *RootL;</div>
<div class="line">  SC3_Rhiz = (1 - FmLc_Rhiz.Fm) * *RhizL;</div>
<div class="line">  <span class="comment">/* Lignin content needs to be considered separately */</span></div>
<div class="line">  SC3_Root_Ln = SC3_Root * RootL_Ln;</div>
<div class="line">  SC3_Rhiz_Ln = SC3_Rhiz * RhizL_Ln;</div>
<div class="line">  SC3_Root = SC3_Root - SC3_Root_Ln;</div>
<div class="line">  SC3_Rhiz = SC3_Rhiz - SC3_Rhiz_Ln;</div>
<div class="line"></div>
<div class="line"><span class="comment">/*    T is silt plus clay content </span></div>
<div class="line"><span class="comment">    Ls is fraction of structural C that is lignin </span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">    Structural Surface Litter C to Surface Microbe C </span></div>
<div class="line"><span class="comment">    1 =&gt; 5 </span></div>
<div class="line"><span class="comment">    2 =&gt; 5 </span></div>
<div class="line"><span class="comment">    dC1/dt = Ki * Lc * A * Ci </span></div>
<div class="line"><span class="comment">    Leaf */</span></div>
<div class="line">  SC1_Leaf +=  0.3 * SC1;</div>
<div class="line">  SC2_Leaf +=  0.3 * SC2;</div>
<div class="line"></div>
<div class="line">  C1_5_Leaf = <a class="code" href="_bio_cro_8h.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC1_Leaf,CN_surface,Abiot,FmLc_Leaf.Lc,Tm,respC1_5,1,Ks);</div>
<div class="line">  C2_5_Leaf = <a class="code" href="_bio_cro_8h.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC2_Leaf,CN_surface,Abiot,FmLc_Leaf.Lc,Tm,respC1_5,5,Ks);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/*  Stem */</span></div>
<div class="line">  SC1_Stem = SC1_Stem + 0.7 * SC1;</div>
<div class="line">  SC2_Stem = SC2_Stem + 0.7 * SC2;</div>
<div class="line"></div>
<div class="line">  C1_5_Stem = <a class="code" href="_bio_cro_8h.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC1_Stem,CN_surface,Abiot,FmLc_Stem.Lc,Tm,respC2_5,1,Ks);</div>
<div class="line">  C2_5_Stem = <a class="code" href="_bio_cro_8h.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC2_Stem,CN_surface,Abiot,FmLc_Stem.Lc,Tm,respC2_5,5,Ks);</div>
<div class="line"></div>
<div class="line">  SC1_Leaf = C1_5_Leaf.SC;</div>
<div class="line">  SC2_Leaf = C2_5_Leaf.SC;</div>
<div class="line">  SC1_Stem = C1_5_Stem.SC;</div>
<div class="line">  SC2_Stem = C2_5_Stem.SC;</div>
<div class="line"></div>
<div class="line"> <span class="comment">/*   Adding the ligning content */</span></div>
<div class="line">  C1_7_Leaf_Ln = <a class="code" href="_bio_cro_8h.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC1_Leaf_Ln,CN_surface,Abiot,FmLc_Leaf.Lc,Tm,respC1_7,1,Ks);</div>
<div class="line">  C1_7_Stem_Ln = <a class="code" href="_bio_cro_8h.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC1_Stem_Ln,CN_surface,Abiot,FmLc_Stem.Lc,Tm,respC1_7,1,Ks);</div>
<div class="line">  </div>
<div class="line">  <span class="comment">/* Flow from SC1.lignin to SC7 */</span></div>
<div class="line">  SC7 += C1_7_Leaf_Ln.fC + C1_7_Stem_Ln.fC ;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/*  Collect respiration */</span></div>
<div class="line">  <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a> = C1_5_Leaf.Resp + C2_5_Leaf.Resp +</div>
<div class="line">         C1_5_Stem.Resp + C2_5_Stem.Resp +</div>
<div class="line">         C1_7_Leaf_Ln.Resp + C1_7_Stem_Ln.Resp;</div>
<div class="line">  <span class="comment">/*  Collect mineralized Nitrogen */</span></div>
<div class="line">  MinN += C1_5_Leaf.MinN + C2_5_Leaf.MinN +</div>
<div class="line">          C1_5_Stem.MinN + C2_5_Stem.MinN +</div>
<div class="line">          C1_7_Leaf_Ln.MinN + C1_7_Stem_Ln.MinN;</div>
<div class="line"></div>
<div class="line"><span class="comment">/*   Rprintf(&quot;MinN 1: %f \n&quot;,MinN); */</span></div>
<div class="line">  <span class="comment">/*  Updating the Soil Carbon Pools 1 and 2  */</span></div>
<div class="line">  SC1 = C1_5_Leaf.SC + C1_5_Stem.SC + C1_7_Leaf_Ln.SC + C1_7_Stem_Ln.SC ;</div>
<div class="line">  SC2 = C2_5_Leaf.SC + C2_5_Stem.SC ;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/*  Updating the Nitrogen Carbon Pools 1 and 2 */</span></div>
<div class="line">  SN1 = SC1 / CN_structural + SN1;</div>
<div class="line">  SN2 = SC2 / CN_surface + SN2;</div>
<div class="line">  </div>
<div class="line"><span class="comment">/*    Structural Root Litter C to Soil Microbe C */</span></div>
<div class="line"><span class="comment">/*    4 =&gt; 6 */</span></div>
<div class="line"><span class="comment">/*    3 =&gt; 6 */</span></div>
<div class="line"><span class="comment">/*    Root */</span></div>
<div class="line">  SC3_Root = SC3_Root + 0.3 * SC3;</div>
<div class="line">  SC4_Root = SC4_Root + 0.3 * SC4;</div>
<div class="line">  C3_6_Root = <a class="code" href="_bio_cro_8h.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC3_Root,CN_active,Abiot,FmLc_Root.Lc,Tm,respC3_6,2,Ks);</div>
<div class="line">  C4_6_Root = <a class="code" href="_bio_cro_8h.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC4_Root,CN_active,Abiot,FmLc_Root.Lc,Tm,respC3_6,6,Ks);</div>
<div class="line"><span class="comment">/*    Rhizome */</span></div>
<div class="line">  SC3_Rhiz = SC3_Rhiz + 0.7 * SC3;</div>
<div class="line">  SC4_Rhiz = SC4_Rhiz + 0.7 * SC4;</div>
<div class="line">  C3_6_Rhiz = <a class="code" href="_bio_cro_8h.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC3_Rhiz,CN_active,Abiot,FmLc_Rhiz.Lc,Tm,respC4_6,2,Ks);</div>
<div class="line">  C4_6_Rhiz = <a class="code" href="_bio_cro_8h.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC4_Rhiz,CN_active,Abiot,FmLc_Rhiz.Lc,Tm,respC4_6,6,Ks);</div>
<div class="line"></div>
<div class="line">  SC3_Root = C3_6_Root.SC;</div>
<div class="line">  SC4_Root = C4_6_Root.SC;</div>
<div class="line">  SC3_Rhiz = C3_6_Rhiz.SC;</div>
<div class="line">  SC4_Rhiz = C4_6_Rhiz.SC;</div>
<div class="line"></div>
<div class="line">  C3_7_Root_Ln = <a class="code" href="_bio_cro_8h.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC3_Root_Ln,CN_slow,Abiot,FmLc_Root.Lc,Tm,respC3_7,2,Ks);</div>
<div class="line">  C3_7_Rhiz_Ln = <a class="code" href="_bio_cro_8h.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC3_Rhiz_Ln,CN_slow,Abiot,FmLc_Rhiz.Lc,Tm,respC3_7,2,Ks);</div>
<div class="line"></div>
<div class="line">  SC7 += C3_7_Root_Ln.fC + C3_7_Rhiz_Ln.fC ; </div>
<div class="line"> <span class="comment">/*   Collect respiration */</span></div>
<div class="line">  <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a> += C3_6_Root.Resp + C4_6_Root.Resp +</div>
<div class="line">           C3_6_Rhiz.Resp + C4_6_Rhiz.Resp;</div>
<div class="line"></div>
<div class="line"><span class="comment">/*    Collect mineralized Nitrogen */</span></div>
<div class="line">  MinN += C3_6_Root.MinN + C4_6_Root.MinN +</div>
<div class="line">           C3_6_Rhiz.MinN + C4_6_Rhiz.MinN + </div>
<div class="line">           C3_7_Root_Ln.MinN + C3_7_Rhiz_Ln.MinN;</div>
<div class="line"></div>
<div class="line"><span class="comment">/*   Rprintf(&quot;MinN 2: %f \n&quot;,MinN); */</span></div>
<div class="line"><span class="comment">/*   Updating the Soil Carbon Pools 3 and 4 */</span></div>
<div class="line">  SC3 = C3_6_Root.SC + C3_6_Rhiz.SC + C3_7_Root_Ln.SC + C3_7_Rhiz_Ln.SC;</div>
<div class="line">  SC4 = C4_6_Root.SC + C4_6_Rhiz.SC ;</div>
<div class="line"></div>
<div class="line"><span class="comment">/*   Updating the Nitrogen pools 3 and 4 */</span></div>
<div class="line">  SN3 += SC3 / CN_structural ;</div>
<div class="line">  SN4 += SC4 / CN_active ;</div>
<div class="line"></div>
<div class="line"><span class="comment">/*    Updating the Soil Carbon Pool 5 */</span></div>
<div class="line">  SC5 += C1_5_Leaf.fC + C1_5_Stem.fC + C2_5_Leaf.fC + C2_5_Stem.fC ;</div>
<div class="line"></div>
<div class="line"><span class="comment">/*    Updating the Soil Nitrogen pool 5 */</span></div>
<div class="line">  SN5 += SC5 / CN_surface ;</div>
<div class="line">  </div>
<div class="line"><span class="comment">/*    Updating the Soil Carbon Pool 6 */</span></div>
<div class="line">  SC6 += C3_6_Root.fC + C3_6_Rhiz.fC + C4_6_Root.fC + C4_6_Rhiz.fC ;</div>
<div class="line"></div>
<div class="line"><span class="comment">/*    Updating the Soil Nitrogen Pool 6 */</span></div>
<div class="line">  SN6 += SC6 / CN_active ;</div>
<div class="line"></div>
<div class="line"><span class="comment">/*    Surface Microbe C to Slow C */</span></div>
<div class="line"><span class="comment">/*    5 =&gt; 7 */</span></div>
<div class="line">  C5_7 = <a class="code" href="_bio_cro_8h.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC5,CN_slow,Abiot,0,0,respC5_7,4,Ks);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a> +=  C5_7.Resp;</div>
<div class="line">  MinN +=  C5_7.MinN;</div>
<div class="line"></div>
<div class="line"><span class="comment">/*    Updating Surface Microbe C (pool 5) and slow (pool 7) */</span></div>
<div class="line"></div>
<div class="line">  SC5 = C5_7.SC ;</div>
<div class="line">  SC7 += C5_7.fC ;</div>
<div class="line"></div>
<div class="line"><span class="comment">/*    Updating Surface Microbe N pool */</span></div>
<div class="line"></div>
<div class="line">  SN5 = SC5 / CN_surface;</div>
<div class="line">   </div>
<div class="line"><span class="comment">/*   Soil Microbe C to intermediate stage C */</span></div>
<div class="line">  C6 = <a class="code" href="_bio_cro_8h.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC6,CN_slow,Abiot,0,Tm,respC6,3,Ks);</div>
<div class="line"></div>
<div class="line"><span class="comment">/*   if(ISNAN(C6.fC) | ISNAN(C6.SC)){ */</span></div>
<div class="line"><span class="comment">/*     Rprintf(&quot;C6.fC %f and C6.SC %f and SC6 %f \n&quot;,C6.fC,C6.SC,SC6); */</span></div>
<div class="line"><span class="comment">/*   } */</span></div>
<div class="line"></div>
<div class="line">  <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a> +=  C6.Resp;</div>
<div class="line">  MinN +=  C6.MinN;</div>
<div class="line"></div>
<div class="line"><span class="comment">/*    Updating carbon and nitrogen soil pools 6 */</span></div>
<div class="line">  SC6 = C6.SC;</div>
<div class="line">  SN6 = SC6 / CN_active;</div>
<div class="line">  </div>
<div class="line">  C_ap = 0.003 + 0.032 * Tc;   </div>
<div class="line">  C_al = leachWater / 18.0 * (0.01 + 0.04 * Ts);</div>
<div class="line">  </div>
<div class="line"><span class="comment">/*   Rprintf(&quot;C_al %f and C_ap %f Tc %f \n&quot;,C_al, C_ap, Tc); */</span></div>
<div class="line"><span class="comment">/*   Rprintf(&quot;leachWater %f and Ts %f \n&quot;,leachWater, Ts); */</span></div>
<div class="line"></div>
<div class="line">  C6_8 = C6.fC * C_ap;</div>
<div class="line">  C6_9 = C6.fC * C_al;</div>
<div class="line">  C6_7 = C6.fC * (1 - C_ap - C_al); <span class="comment">/* There is no need to subtract 0.55 since </span></div>
<div class="line"><span class="comment">                                       this was already taken into account in </span></div>
<div class="line"><span class="comment">                                       the flow equation */</span></div>
<div class="line">  </div>
<div class="line"> <span class="comment">/*   Updating the Soil Carbon Pool 7, 8 and 9 */</span></div>
<div class="line"></div>
<div class="line">  SC7 += C6_7 ;</div>
<div class="line">  SC8 += C6_8 ;</div>
<div class="line">  SC9 += C6_9 ;</div>
<div class="line"></div>
<div class="line"><span class="comment">/*   Rprintf(&quot;C6_9 %f \n&quot;,C6_9); */</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/*  Updating the Soil Nitrogen Pool 7, 8 and 9 */</span></div>
<div class="line"></div>
<div class="line">  SN7 += SC7 / CN_slow ;</div>
<div class="line">  SN8 += SC8 / CN_passive ;</div>
<div class="line">  SN9 += SC9 / CN_slow ;</div>
<div class="line">  </div>
<div class="line"><span class="comment">/*    Slow Carbon to intermediate stage */</span></div>
<div class="line"></div>
<div class="line">  C7 = <a class="code" href="_bio_cro_8h.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC7,CN_slow,Abiot,0,0,respC7,7,Ks);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a> += C7.Resp;</div>
<div class="line">  MinN += C7.MinN;</div>
<div class="line">  </div>
<div class="line">  C_sp = 0.003 - 0.009 *Tc;</div>
<div class="line">  C7_8 = C7.fC * C_sp;</div>
<div class="line">  C7_6 = C7.fC * (1 - C_sp);  <span class="comment">/* There is no need to subtract 0.55 since </span></div>
<div class="line"><span class="comment">                                 this was already taken into account in </span></div>
<div class="line"><span class="comment">                                 the flow equation */</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/*    Updating the Soil Carbon Pools 6 and 8 */</span></div>
<div class="line"></div>
<div class="line">  SC6 += C7_6 ;</div>
<div class="line">  SC8 += C7_8 ;</div>
<div class="line"></div>
<div class="line"><span class="comment">/*    Updating the Soil Nitrogen Pools 6 and 8 */</span></div>
<div class="line"></div>
<div class="line">  SN6 = SC6 / CN_active;</div>
<div class="line">  SN8 = SN8 / CN_passive;</div>
<div class="line"></div>
<div class="line"><span class="comment">/*    Passive Carbon to Soil Microbe C */</span></div>
<div class="line"></div>
<div class="line">  C8_6 = <a class="code" href="_bio_cro_8h.html#a3f6a4f8b6e407fdca09efcebc32bf86c">flow</a>(&amp;SC8,CN_passive,Abiot,0,0,respC8,8,Ks);</div>
<div class="line"></div>
<div class="line">  <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a> += C8_6.Resp;</div>
<div class="line">  MinN += C8_6.MinN;</div>
<div class="line"></div>
<div class="line"><span class="comment">/*   Updating the Soil Microbe C 6 and 8 */</span></div>
<div class="line">  </div>
<div class="line">  SC8 = C8_6.SC ;</div>
<div class="line">  SC6 += C8_6.fC ;</div>
<div class="line"></div>
<div class="line">  SN6 = SC6 / CN_active;</div>
<div class="line">  SN8 = SC8 / CN_passive;</div>
<div class="line"></div>
<div class="line">  tmp.SNs[0] = SN1 / cf;</div>
<div class="line">  tmp.SNs[1] = SN2 / cf ;</div>
<div class="line">  tmp.SNs[2] = SN3 / cf ;</div>
<div class="line">  tmp.SNs[3] = SN4 / cf ;</div>
<div class="line">  tmp.SNs[4] = SN5 / cf ;</div>
<div class="line">  tmp.SNs[5] = SN6 / cf ;</div>
<div class="line">  tmp.SNs[6] = SN7 / cf ;</div>
<div class="line">  tmp.SNs[7] = SN8 / cf ;</div>
<div class="line">  tmp.SNs[8] = SN9 / cf ;</div>
<div class="line"></div>
<div class="line">  tmp.SCs[0] = SC1 / cf;</div>
<div class="line">  tmp.SCs[1] = SC2 / cf;</div>
<div class="line">  tmp.SCs[2] = SC3 / cf;</div>
<div class="line">  tmp.SCs[3] = SC4 / cf;</div>
<div class="line">  tmp.SCs[4] = SC5 / cf;</div>
<div class="line">  tmp.SCs[5] = SC6 / cf;</div>
<div class="line">  tmp.SCs[6] = SC7 / cf;</div>
<div class="line">  tmp.SCs[7] = SC8 / cf;</div>
<div class="line">  tmp.SCs[8] = SC9 / cf;</div>
<div class="line"></div>
<div class="line">  tmp.MinN = <a class="code" href="structflow__str.html#a2e85af08e1b5ef823f43b8fea56f85d7">MinN</a>;</div>
<div class="line">  tmp.Resp = <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a>;</div>
<div class="line"></div>
<div class="line"><span class="comment">/* Converting Leaf Litter to its original units */</span></div>
<div class="line"></div>
<div class="line">  *LeafL /= cf;</div>
<div class="line">  *StemL /= cf;</div>
<div class="line">  *RootL /= cf;</div>
<div class="line">  *RhizL /= cf;</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">return</span>(tmp);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a3f6a4f8b6e407fdca09efcebc32bf86c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structflow__str.html">flow_str</a> <a class="el" href="structflow.html">flow</a> </td>
          <td>(</td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>SC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>CNratio</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Lc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Tm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>resp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>kno</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Ks</em>[8]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L523">523</a> of file <a class="el" href="">Century.c</a>.</p>
<div class="fragment"><div class="line">                                                                                                                    {</div>
<div class="line"></div>
<div class="line">  <span class="keyword">struct </span><a class="code" href="structflow__str.html">flow_str</a> tmp;</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">double</span> Kf = 0.0, <a class="code" href="structflow__str.html#a043c2ff66146ae4fa8a898c8f7a44851">fC</a> = 0.0;</div>
<div class="line">  <span class="keywordtype">double</span> <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a>, <a class="code" href="structflow__str.html#a2e85af08e1b5ef823f43b8fea56f85d7">MinN</a>;</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span>(kno &lt; 3){</div>
<div class="line">    Kf = Ks[kno-1] * Lc * A ;</div>
<div class="line">    <a class="code" href="structflow__str.html#a043c2ff66146ae4fa8a898c8f7a44851">fC</a> = Kf * *<a class="code" href="structflow__str.html#a343d51cd0d68eb7f2086dcdfa86bc58d">SC</a>;</div>
<div class="line">  }<span class="keywordflow">else</span></div>
<div class="line">  <span class="keywordflow">if</span>(kno == 3){</div>
<div class="line">    Kf = Ks[kno-1] * A * Tm ;</div>
<div class="line">    <a class="code" href="structflow__str.html#a043c2ff66146ae4fa8a898c8f7a44851">fC</a> = Kf * *<a class="code" href="structflow__str.html#a343d51cd0d68eb7f2086dcdfa86bc58d">SC</a>;</div>
<div class="line">  }<span class="keywordflow">else</span></div>
<div class="line">  <span class="keywordflow">if</span>(kno &gt; 3){</div>
<div class="line">    Kf = Ks[kno-1] * A;</div>
<div class="line">    <a class="code" href="structflow__str.html#a043c2ff66146ae4fa8a898c8f7a44851">fC</a> = Kf * *<a class="code" href="structflow__str.html#a343d51cd0d68eb7f2086dcdfa86bc58d">SC</a>;</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">if</span>(Kf &gt; 1){</div>
<div class="line">    Rprintf(<span class="stringliteral">&quot;Kf greater than 1: %d %f %f %f %f \n&quot;</span>, kno, Ks[kno-1], Kf, A, Tm);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  Resp = <a class="code" href="structflow__str.html#a043c2ff66146ae4fa8a898c8f7a44851">fC</a> * <a class="code" href="_aux_bio_cro_8c.html#aeb35169469ef33705592a28743d105bf">resp</a>;</div>
<div class="line"></div>
<div class="line">  <span class="comment">/*  Mineralized N */</span></div>
<div class="line">  MinN = Resp / CNratio;</div>
<div class="line"></div>
<div class="line">  *<a class="code" href="structflow__str.html#a343d51cd0d68eb7f2086dcdfa86bc58d">SC</a> = *<a class="code" href="structflow__str.html#a343d51cd0d68eb7f2086dcdfa86bc58d">SC</a> - <a class="code" href="structflow__str.html#a043c2ff66146ae4fa8a898c8f7a44851">fC</a>;</div>
<div class="line">  </div>
<div class="line">  fC = fC - <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a>;</div>
<div class="line"><span class="comment">/*   fN = fC / CNratio; */</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/*  It is important to keep track of C emissions because */</span></div>
<div class="line"><span class="comment">/*  I might need to validate it against Eddy flux data */</span></div>
<div class="line">  tmp.SC = *<a class="code" href="structflow__str.html#a343d51cd0d68eb7f2086dcdfa86bc58d">SC</a>;</div>
<div class="line">  tmp.fC = <a class="code" href="structflow__str.html#a043c2ff66146ae4fa8a898c8f7a44851">fC</a>;</div>
<div class="line">  tmp.Resp = <a class="code" href="structflow__str.html#a92c1005f482e0f18892a6a94e72e4035">Resp</a>;</div>
<div class="line">  tmp.MinN = <a class="code" href="structflow__str.html#a2e85af08e1b5ef823f43b8fea56f85d7">MinN</a>;  </div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">return</span>(tmp);</div>
<div class="line"></div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ab1f878344b2d2444f096bd0da2cb9f24"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="struct_f_l__str.html">FL_str</a> FmLcFun </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Lig</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Nit</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L496">496</a> of file <a class="el" href="">Century.c</a>.</p>
<div class="fragment"><div class="line">                                             {</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">double</span> Fm, Ls, Lc;</div>
<div class="line">  <span class="keyword">struct </span><a class="code" href="struct_f_l__str.html">FL_str</a> tmp;</div>
<div class="line"></div>
<div class="line">  Fm = 0.85 - 0.018 *(Lig/Nit);</div>
<div class="line">  Ls = Lig / (1 - <a class="code" href="struct_f_l__str.html#af757219617ae5633c84861a6d551e50e">Fm</a>);</div>
<div class="line">  Lc = exp(-3 * Ls);</div>
<div class="line"></div>
<div class="line">  tmp.Lc = <a class="code" href="struct_f_l__str.html#a50ae8acc43740fd17ffe08b69140dea7">Lc</a>;</div>
<div class="line">  tmp.Fm = <a class="code" href="struct_f_l__str.html#af757219617ae5633c84861a6d551e50e">Fm</a>;</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">return</span>(tmp);</div>
<div class="line"></div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a46827eb56108821fe82228553f535293"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void lightME </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>DOY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>td</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L26">26</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line"></div>
<div class="line">        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[];</div>
<div class="line">        <span class="keywordtype">double</span> *ip1;</div>
<div class="line">        ip1 = &amp;tmp1[0];</div>
<div class="line">        <span class="keywordtype">double</span> omega, delta0, delta, deltaR;</div>
<div class="line">        <span class="keywordtype">double</span> tf, SSin, CCos, PPo;</div>
<div class="line">        <span class="keywordtype">double</span> CosZenithAngle, CosHour;</div>
<div class="line">        <span class="keywordtype">double</span> CosHourDeg;</div>
<div class="line">        <span class="keywordtype">double</span> Idir, Idiff, propIdir, propIdiff;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> DTR = <a class="code" href="denitrify_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>/180;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> tsn = 12.0;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> alpha = 0.85;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> SolarConstant = 2650;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> atmP = 1e5;</div>
<div class="line"></div>
<div class="line">        omega = lat * DTR;</div>
<div class="line">        delta0 = 360.0 * ((DOY + 10)/365.0);</div>
<div class="line">        delta = -23.5 * cos(delta0*DTR);</div>
<div class="line">        deltaR = delta * DTR;</div>
<div class="line"></div>
<div class="line">        tf = (15.0*(td - tsn))*DTR;</div>
<div class="line">        SSin = sin(deltaR) * sin(omega);</div>
<div class="line">        CCos = cos(deltaR) * cos(omega);</div>
<div class="line"></div>
<div class="line">        CosZenithAngle = SSin + CCos * cos(tf);</div>
<div class="line">        <span class="keywordflow">if</span>(CosZenithAngle &lt; pow(10,-10))</div>
<div class="line">                CosZenithAngle = pow(10,-10);</div>
<div class="line"></div>
<div class="line">        CosHour = -tan(omega) * tan(deltaR);</div>
<div class="line">        CosHourDeg = (1/DTR)*CosHour;</div>
<div class="line">        <span class="keywordflow">if</span>(CosHourDeg &lt; -57)</div>
<div class="line">                CosHour = -0.994;</div>
<div class="line"></div>
<div class="line">        PPo = 1e5 / atmP;</div>
<div class="line">        Idir = SolarConstant * (pow(alpha,(PPo/CosZenithAngle)));</div>
<div class="line">        Idiff = 0.3 * SolarConstant *(1 - pow(alpha,(PPo/CosZenithAngle))) * CosZenithAngle ;</div>
<div class="line"></div>
<div class="line">        propIdir = Idir / (Idir + Idiff);</div>
<div class="line">        propIdiff = Idiff / (Idir + Idiff);</div>
<div class="line"></div>
<div class="line">        *ip1 = propIdir;</div>
<div class="line">        *(ip1+1) = propIdiff;</div>
<div class="line">        *(ip1+2) = CosZenithAngle;</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5a18f68430b9e6ed1be3d294b179f8a6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="struct_can___str.html">Can_Str</a> newc3CanAC </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>DOY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>solarR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>WindSpeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Vmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Jmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Catm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>o2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>heightf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>leafN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kpLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lnfun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>StomWS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ws</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L442">442</a> of file <a class="el" href="">AuxwillowGro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line"></div>
<div class="line">   <span class="keyword">struct </span><a class="code" href="struct_e_t___str.html">ET_Str</a> deepaktmp5_ET,deepaktmp6_ET; </div>
<div class="line">   <span class="keyword">struct </span><a class="code" href="structc3__str.html">c3_str</a> deepaktmpc3;</div>
<div class="line">   <span class="keyword">struct </span><a class="code" href="structc3__str.html">c3_str</a> deepaktmpc32;</div>
<div class="line">   <span class="keyword">struct </span><a class="code" href="struct_can___str.html">Can_Str</a> ans;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> cf = 3600 * 1e-6 * 30 * 1e-6 * 10000;</div>
<div class="line"><span class="comment">/* Need a different conversion factor for transpiration */</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> cf2 = 3600 * 1e-3 * 18 * 1e-6 * 10000; </div>
<div class="line">        </div>
<div class="line">  <span class="keywordtype">int</span> i;</div>
<div class="line">  <span class="keywordtype">double</span> TempIdir,TempIdiff;</div>
<div class="line">  <span class="keywordtype">double</span> Leafsun, Leafshade;</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">double</span> CanopyA = 0.0;</div>
<div class="line">  <span class="keywordtype">double</span> GCanopyA = 0.0;</div>
<div class="line">  <span class="keywordtype">double</span> CanopyT =0.0;;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">double</span> CanHeight=0.0;;</div>
<div class="line">  <span class="keywordtype">double</span> chil =0.0;</div>
<div class="line"></div>
<div class="line">   <span class="keywordtype">double</span> vmax1;</div>
<div class="line"><span class="comment">//  double leafN_lay;</span></div>
<div class="line">  </div>
<div class="line"> <span class="comment">/* double StomWS;</span></div>
<div class="line"><span class="comment"> /* int ws;</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">        /* For Assimilation */</span></div>
<div class="line">        <span class="comment">/* 3600 converts seconds to hours */</span></div>
<div class="line">        <span class="comment">/* 1e-6 converts micro mols to mols */</span></div>
<div class="line">        <span class="comment">/* 30 is the grams in one mol of CO2 */</span></div>
<div class="line">        <span class="comment">/* 1e-6 converts g to Mg */</span></div>
<div class="line">        <span class="comment">/* 10000 scales from meter squared to hectare */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* For Transpiration */</span></div>
<div class="line">        <span class="comment">/* 3600 converts seconds to hours */</span></div>
<div class="line">        <span class="comment">/* 1e-3 converts mili mols to mols */</span></div>
<div class="line">        <span class="comment">/* 18 is the grams in one mol of H20 */</span></div>
<div class="line">        <span class="comment">/* 1e-6 converts g to Mg */</span></div>
<div class="line">        <span class="comment">/* 10000 scales from meter squared to hectare */</span></div>
<div class="line"></div>
<div class="line">  <span class="keyword">struct </span><a class="code" href="structcanopy.html">canopy</a> ccanopy;</div>
<div class="line">  <a class="code" href="_auxwillow_gro_8c.html#ac76a61a6bb1df6d8edfcf84ef826c32c">createCanopy</a> (&amp;ccanopy,nlayers, LAI);  </div>
<div class="line">  <a class="code" href="_auxwillow_gro_8c.html#a6227c845c706959b38921e90ec099311">discretizeCanopy</a>(&amp;ccanopy);</div>
<div class="line">  </div>
<div class="line">  <a class="code" href="_auxwillow_gro_8c.html#a5b569d4b9b8006b06c35d0aee5ec51ea">getcanopylightme</a>(&amp;ccanopy,lat, DOY,hr,solarR);</div>
<div class="line">  <a class="code" href="_auxwillow_gro_8c.html#af5829d0791e03458b6fa02f8c5b50989">getCanopysunML</a>(&amp;ccanopy,kd,chil,heightf);</div>
<div class="line">  <a class="code" href="_auxwillow_gro_8c.html#ac827965d6919349d51719e982298f72e">getcanopyRHprof</a>(&amp;ccanopy, RH);</div>
<div class="line">  <a class="code" href="_auxwillow_gro_8c.html#ae42513b789aea0a0523e01aa6e757f35">getcanopyWINDprofile</a>(&amp;ccanopy,WindSpeed);</div>
<div class="line">  <a class="code" href="_auxwillow_gro_8c.html#a962f1edaba4e3276bcf5e5b4be25055a">getcanopyLNprof</a>(&amp;ccanopy,leafN,kpLN);</div>
<div class="line"></div>
<div class="line">      <span class="keywordflow">for</span>(i=0;i&lt;(ccanopy.Nlayers);i++)</div>
<div class="line">    {</div>
<div class="line">            <span class="keywordflow">if</span>(lnfun == 0){</div>
<div class="line">                    vmax1 = Vmax;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span>{</div>
<div class="line">                    vmax1 = ccanopy.Leaf[i].LeafN * lnb1 + lnb0;</div>
<div class="line">            } </div>
<div class="line">     </div>
<div class="line">            Leafsun = ccanopy.Leaf[i].LAI *ccanopy.Leaf[i].pLeafsun;</div>
<div class="line">   </div>
<div class="line">      deepaktmp5_ET= <a class="code" href="_auxwillow_gro_8h.html#a14fc4c1327518e9237f587b37400ac97">c3EvapoTrans</a>(ccanopy.ENV[i].Idir,ccanopy.ENV[i].Itotal,Temp,ccanopy.ENV[i].RH,ccanopy.ENV[i].windspeed,ccanopy.Leaf[i].LAI,ccanopy.Leaf[i].heightf,</div>
<div class="line">                                                   Vmax,Jmax,Rd,b0,b1,Catm,o2,theta);</div>
<div class="line">            TempIdir = Temp + deepaktmp5_ET.Deltat;</div>
<div class="line">      ccanopy.OUT[i].sunlittemp=TempIdir;</div>
<div class="line">      ccanopy.OUT[i].sunlitTranspiration=deepaktmp5_ET.TransR;</div>
<div class="line">     </div>
<div class="line">      deepaktmpc3 = <a class="code" href="c3photo_8c.html#ad30b1a99fb440301345822cb38fb5cbe">c3photoC</a>(ccanopy.ENV[i].Idir,ccanopy.OUT[i].sunlittemp,ccanopy.ENV[i].RH,Vmax,Jmax,Rd,b0,b1,Catm,o2,theta,StomWS,ws);</div>
<div class="line">            ccanopy.OUT[i].sunlitAnet=deepaktmpc3.Assim;</div>
<div class="line">      ccanopy.OUT[i].sunlitAgross=deepaktmpc3.GrossAssim;</div>
<div class="line"><span class="comment">//      Rprintf(&quot;%f, %f,%f\n&quot;,deepaktmpc3.Assim,deepaktmpc3.GrossAssim,ccanopy.ENV[i].Idir);</span></div>
<div class="line"></div>
<div class="line">            Leafshade = ccanopy.Leaf[i].LAI *ccanopy.Leaf[i].pLeafshade;</div>
<div class="line">      deepaktmp6_ET=<a class="code" href="_auxwillow_gro_8h.html#a14fc4c1327518e9237f587b37400ac97">c3EvapoTrans</a>(ccanopy.ENV[i].Idiff,ccanopy.ENV[i].Itotal,Temp,ccanopy.ENV[i].RH,ccanopy.ENV[i].windspeed,ccanopy.Leaf[i].LAI,ccanopy.Leaf[i].heightf,</div>
<div class="line">                 Vmax,Jmax,Rd,b0,b1,Catm,o2,theta);</div>
<div class="line">      TempIdiff=Temp + deepaktmp6_ET.Deltat;</div>
<div class="line">      ccanopy.OUT[i].shadedtemp=TempIdiff;</div>
<div class="line">      ccanopy.OUT[i].shadedTranspiration=deepaktmp6_ET.TransR;</div>
<div class="line">      deepaktmpc32=<a class="code" href="c3photo_8c.html#ad30b1a99fb440301345822cb38fb5cbe">c3photoC</a>(ccanopy.ENV[i].Idiff,ccanopy.OUT[i].shadedtemp,ccanopy.ENV[i].RH,Vmax,Jmax,Rd,b0,b1,Catm,o2,theta,StomWS,ws);</div>
<div class="line">            ccanopy.OUT[i].shadedAnet=deepaktmpc32.Assim;</div>
<div class="line">      ccanopy.OUT[i].shadedAgross=deepaktmpc32.GrossAssim;</div>
<div class="line">      </div>
<div class="line">     ccanopy.OUT[i].TotalAnet =Leafsun* ccanopy.OUT[i].sunlitAnet + Leafshade*ccanopy.OUT[i].shadedAnet;</div>
<div class="line">     ccanopy.OUT[i].TotalAgross=Leafsun* ccanopy.OUT[i].sunlitAgross + Leafshade*ccanopy.OUT[i].shadedAgross;</div>
<div class="line">     ccanopy.OUT[i].TotalTrans =Leafsun* ccanopy.OUT[i].sunlitTranspiration + Leafshade*ccanopy.OUT[i].shadedTranspiration;</div>
<div class="line">    </div>
<div class="line">   </div>
<div class="line">                 CanopyA = CanopyA + ccanopy.OUT[i].TotalAnet;</div>
<div class="line">                 GCanopyA =GCanopyA+ ccanopy.OUT[i].TotalAgross;</div>
<div class="line">     CanopyT = GCanopyA+ ccanopy.OUT[i].TotalTrans;</div>
<div class="line"><span class="comment">//     Rprintf(&quot;Inside Layers: net= %f, Gross=%f \n&quot;,ccanopy.OUT[i].TotalAnet,ccanopy.OUT[i].TotalAgross);</span></div>
<div class="line">        }</div>
<div class="line">        <span class="comment">/*## These are micro mols of CO2 per m2 per sec for Assimilation</span></div>
<div class="line"><span class="comment">          ## and mili mols of H2O per m2 per sec for Transpiration</span></div>
<div class="line"><span class="comment">          ## Need to convert to </span></div>
<div class="line"><span class="comment">          ## 3600 converts seconds to hours</span></div>
<div class="line"><span class="comment">          ## 10^-6 converts micro mols to mols</span></div>
<div class="line"><span class="comment">          ## 30 converts mols of CO2 to grams</span></div>
<div class="line"><span class="comment">          ## (1/10^6) converts grams to Mg</span></div>
<div class="line"><span class="comment">          ## 10000 scales up to ha */</span></div>
<div class="line"><span class="comment">/* A similar conversion is made for water but</span></div>
<div class="line"><span class="comment">   replacing 30 by 18 and mili mols are converted to</span></div>
<div class="line"><span class="comment">   mols (instead of micro) */</span></div>
<div class="line"> </div>
<div class="line">        ans.Assim = cf * CanopyA ;</div>
<div class="line">  ans.Trans= cf2 * CanopyT; </div>
<div class="line">  ans.GrossAssim=cf*GCanopyA;</div>
<div class="line"><span class="comment">//   Rprintf(&quot;output;-Net Assimilation = %f, Gross Assimilation = %f \n&quot;, CanopyA,GCanopyA );</span></div>
<div class="line"><span class="comment">//  Rprintf(&quot;returning structure;-Net Assimilation = %f, Gross Assimilation = %f \n&quot;, ans.Assim, ans.GrossAssim);</span></div>
<div class="line">        <span class="keywordflow">return</span>(ans);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aeb35169469ef33705592a28743d105bf"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double resp </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>comp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>temp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L1021">1021</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">                                                 {</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> ans;</div>
<div class="line"></div>
<div class="line">        ans = comp *  (1 - (mrc * pow(2,(temp/10.0))));</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(ans &lt;0) ans = 0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span>(ans);</div>
<div class="line"></div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a247148ac54cf7d8c851326de6093b71e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RHprof </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L144">144</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <span class="keywordtype">double</span> kh, hsla, j;</div>
<div class="line"></div>
<div class="line">        kh = 1 - RH;</div>
<div class="line">        <span class="comment">/* kh = 0.2; */</span></div>
<div class="line">        <span class="comment">/*kh = log(1/RH);*/</span></div>
<div class="line">        <span class="keywordflow">for</span>(i=0;i&lt;nlayers;i++)</div>
<div class="line">        {</div>
<div class="line">                j = i + 1;</div>
<div class="line">                hsla = RH * exp(kh * (j/nlayers));</div>
<div class="line"><span class="comment">//              /*hsla = RH * exp(-kh * (j/nlayers));  /*new simpler version from Joe Iverson*/</span></div>
<div class="line">                <span class="keywordflow">if</span>(hsla &gt; 1) hsla = 0.99; </div>
<div class="line">                <a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>[<a class="code" href="_aux_bio_cro_8h.html#a36e4d9011835445995335074adedad9a">tp4</a>++] = hsla;</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">/* It should return values in the 0-1 range */</span></div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a9e38198cf133d59230f6d1f6beac12bc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double RSS_BG </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>oStem</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>oLeaf</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>oRhizome</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>oRoot</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>oGrain</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>oLAI</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sStem</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sLeaf</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sRhizome</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sRoot</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sGrain</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>sLAI</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>N1Dat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L1809">1809</a> of file <a class="el" href="">BioCro.c</a>.</p>
<div class="fragment"><div class="line">                        {</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <span class="keywordtype">double</span> diff1=0.0, RSS1=0.0, SST1=0.0;</div>
<div class="line">        <span class="keywordtype">double</span> diff2=0.0, RSS2=0.0, SST2=0.0;</div>
<div class="line">        <span class="keywordtype">double</span> diff3=0.0, RSS3=0.0, SST3=0.0;</div>
<div class="line">        <span class="keywordtype">double</span> diff4=0.0, RSS4=0.0, SST4=0.0; </div>
<div class="line">        <span class="keywordtype">double</span> diff5=0.0, RSS5=0.0, SST5=0.0;</div>
<div class="line">        <span class="keywordtype">double</span> diff6=0.0, RSS6=0.0, SST6=0.0;</div>
<div class="line">        <span class="keywordtype">double</span> RSS=0.0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span>(i = 0 ; i &lt; N1Dat; i++){</div>
<div class="line">                <span class="comment">/* Stem */</span></div>
<div class="line">                <span class="keywordflow">if</span>(oStem[i] &gt;= 0){</div>
<div class="line">                        SST1 += pow(oStem[i],2);</div>
<div class="line">                        diff1 = oStem[i] - sStem[i];</div>
<div class="line">                        RSS1 += pow(diff1,2);</div>
<div class="line">                }</div>
<div class="line">                <span class="comment">/* Leaf */</span></div>
<div class="line">                <span class="keywordflow">if</span>(oLeaf[i] &gt;= 0){</div>
<div class="line">                        SST2 += pow(oLeaf[i],2);</div>
<div class="line">                        diff2 = oLeaf[i] - sLeaf[i];</div>
<div class="line">                        RSS2 += pow(diff2,2);</div>
<div class="line">                }</div>
<div class="line">                <span class="comment">/* Rhizome */</span></div>
<div class="line">                <span class="keywordflow">if</span>(oRhizome[i] &gt;= 0){</div>
<div class="line">                        SST3 += pow(oRhizome[i],2);</div>
<div class="line">                        diff3 = oRhizome[i] - sRhizome[i];</div>
<div class="line">                        RSS3 += pow(diff3,2);</div>
<div class="line">                }</div>
<div class="line">                <span class="comment">/* Root */</span></div>
<div class="line">                <span class="keywordflow">if</span>(oRoot[i] &gt;= 0){</div>
<div class="line">                        SST4 += pow(oRoot[i],2);</div>
<div class="line">                        diff4 = oRoot[i] - sRoot[i];</div>
<div class="line">                        RSS4 += pow(diff4,2);</div>
<div class="line">                }</div>
<div class="line">                <span class="comment">/* LAI */</span></div>
<div class="line">                <span class="keywordflow">if</span>(oLAI[i] &gt;= 0){</div>
<div class="line">                        SST5 += pow(oLAI[i],2);</div>
<div class="line">                        diff5 = oLAI[i] - sLAI[i];</div>
<div class="line">                        RSS5 += pow(diff5,2);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span>(oGrain[i] &gt;= 0){</div>
<div class="line">                        SST6 += pow(oGrain[i],2);</div>
<div class="line">                        diff6 = oGrain[i] - sGrain[i];</div>
<div class="line">                        RSS6 += pow(diff6,2);</div>
<div class="line">                }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        RSS = RSS1 + RSS2 + RSS3 + RSS4 + RSS5 + RSS6;</div>
<div class="line">        <span class="keywordflow">return</span>(RSS);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4dc70ed4086616dabcbc7565d36d247b"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structdbp__str.html">dbp_str</a> sel_dbp_coef </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>coefs</em>[25], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>TherPrds</em>[6], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>TherTime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L1036">1036</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">                                                                                  {</div>
<div class="line"></div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structdbp__str.html">dbp_str</a> tmp;</div>
<div class="line"></div>
<div class="line">        tmp.<a class="code" href="structdbp__str.html#ac99cccaa39474eb44da7927824bf1590">kLeaf</a> = 0.0;</div>
<div class="line">        tmp.kStem = 0.0;</div>
<div class="line">        tmp.kRoot = 0.0;</div>
<div class="line">        tmp.kRhiz = 0.0;</div>
<div class="line">        tmp.kGrain = 0.0; <span class="comment">/* kGrain is always zero except for the last thermal period */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(TherTime &lt; TherPrds[0])</div>
<div class="line">        {</div>
<div class="line">                tmp.kStem = coefs[0];</div>
<div class="line">                tmp.kLeaf = coefs[1];</div>
<div class="line">                tmp.kRoot = coefs[2];</div>
<div class="line">                tmp.kRhiz = coefs[3];</div>
<div class="line"></div>
<div class="line">        } <span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">if</span>( TherTime &lt; TherPrds[1] )</div>
<div class="line">                {</div>
<div class="line">                        tmp.kStem = coefs[4];</div>
<div class="line">                        tmp.kLeaf = coefs[5];</div>
<div class="line">                        tmp.kRoot = coefs[6];</div>
<div class="line">                        tmp.kRhiz = coefs[7];</div>
<div class="line"></div>
<div class="line">                } <span class="keywordflow">else</span></div>
<div class="line">                        <span class="keywordflow">if</span>( TherTime &lt; TherPrds[2])</div>
<div class="line">                        {</div>
<div class="line">                                tmp.kStem = coefs[8];</div>
<div class="line">                                tmp.kLeaf = coefs[9];</div>
<div class="line">                                tmp.kRoot = coefs[10];</div>
<div class="line">                                tmp.kRhiz = coefs[11];</div>
<div class="line"></div>
<div class="line">                        } <span class="keywordflow">else</span></div>
<div class="line">                                <span class="keywordflow">if</span>(TherTime &lt; TherPrds[3])</div>
<div class="line">                                {</div>
<div class="line">                                        tmp.kStem = coefs[12];</div>
<div class="line">                                        tmp.kLeaf = coefs[13];</div>
<div class="line">                                        tmp.kRoot = coefs[14];</div>
<div class="line">                                        tmp.kRhiz = coefs[15];</div>
<div class="line"></div>
<div class="line">                                } <span class="keywordflow">else</span></div>
<div class="line">                                        <span class="keywordflow">if</span>(TherTime &lt; TherPrds[4])</div>
<div class="line">                                        {</div>
<div class="line">                                                tmp.kStem = coefs[16];</div>
<div class="line">                                                tmp.kLeaf = coefs[17];</div>
<div class="line">                                                tmp.kRoot = coefs[18];</div>
<div class="line">                                                tmp.kRhiz = coefs[19];</div>
<div class="line"></div>
<div class="line">                                        } <span class="keywordflow">else</span>{</div>
<div class="line">                                                </div>
<div class="line">                                                        tmp.kStem = coefs[20];</div>
<div class="line">                                                        tmp.kLeaf = coefs[21];</div>
<div class="line">                                                        tmp.kRoot = coefs[22];</div>
<div class="line">                                                        tmp.kRhiz = coefs[23];</div>
<div class="line">                                                        tmp.kGrain = coefs[24];</div>
<div class="line">                                                </div>
<div class="line">                                                }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span>(tmp);</div>
<div class="line"></div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a054d5ae3a62e6217a0d4e5093b79bb25"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double sel_phen </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>phen</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L2262">2262</a> of file <a class="el" href="">BioCro.c</a>.</p>
<div class="fragment"><div class="line">                         {</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> index = 0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(phen == 6){</div>
<div class="line">                index = runif(20,25);</div>
<div class="line">        }<span class="keywordflow">else</span> </div>
<div class="line">         <span class="keywordflow">if</span>(phen == 5){</div>
<div class="line">                 index = runif(16,20);</div>
<div class="line">         }<span class="keywordflow">else</span></div>
<div class="line">          <span class="keywordflow">if</span>(phen == 4){</div>
<div class="line">                  index = runif(12,16);</div>
<div class="line">          }<span class="keywordflow">else</span></div>
<div class="line">           <span class="keywordflow">if</span>(phen == 3){</div>
<div class="line">                   index = runif(8,12);</div>
<div class="line">           }<span class="keywordflow">else</span></div>
<div class="line">            <span class="keywordflow">if</span>(phen == 2){</div>
<div class="line">                    index = runif(4,8);</div>
<div class="line">            }<span class="keywordflow">else</span></div>
<div class="line">             <span class="keywordflow">if</span>(phen == 1){</div>
<div class="line">                     index = runif(0,4);</div>
<div class="line">             }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span>(index);</div>
<div class="line"></div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a1ac23d61d399453a3837e85128f04b6f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double SoilEvapo </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>AirTemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>DirectRad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>awc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fieldc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wiltp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>winds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RelH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rsec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L412">412</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">                                                                                                  {</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> SoilArea;</div>
<div class="line">        <span class="keywordtype">double</span> SoilTemp;</div>
<div class="line">        <span class="keywordtype">double</span> Up; <span class="comment">/*Maximum Dimensionless Uptake Rate */</span></div>
<div class="line">        <span class="keywordtype">double</span> TotalRadiation;</div>
<div class="line">        <span class="keywordtype">double</span> BoundaryLayerThickness, DiffCoef;</div>
<div class="line">        <span class="keywordtype">double</span> SoilBoundaryLayer, Ja, rlc;</div>
<div class="line">        <span class="keywordtype">double</span> PhiN, PsycParam, DeltaPVa;</div>
<div class="line">        <span class="keywordtype">double</span> Evaporation = 0.0;  </div>
<div class="line">        <span class="keywordtype">double</span> DdryA, LHV, SlopeFS, SWVC;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> rawc; <span class="comment">/* Relative available water content */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">int</span> method = 1;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* some constants */</span></div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> SoilClodSize = 0.04;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> SoilReflectance = 0.2;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> SoilTransmission = 0.01;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> SpecificHeat = 1010;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> StefanBoltzman = 5.67e-8; <span class="comment">/* Stefan Boltzman Constant */</span></div>
<div class="line"></div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> cf2 = 3600 * 1e-3 * 18 * 1e-6 * 10000; </div>
<div class="line"></div>
<div class="line">        <span class="comment">/* For Transpiration */</span></div>
<div class="line">        <span class="comment">/* 3600 converts seconds to hours */</span></div>
<div class="line">        <span class="comment">/* 1e-3 converts mili mols to mols */</span></div>
<div class="line">        <span class="comment">/* 18 is the grams in one mol of H20 */</span></div>
<div class="line">        <span class="comment">/* 1e-6 converts g to Mg */</span></div>
<div class="line">        <span class="comment">/* 10000 scales from meter squared to hectare */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Let us assume a simple way of calculating the proportion of the</span></div>
<div class="line"><span class="comment">           soil with direct radiation */</span></div>
<div class="line">        SoilArea = exp(-k * LAI);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* For now the temperature of the soil will be the same as the air.</span></div>
<div class="line"><span class="comment">           At a later time this can be made more accurate. I looked at the</span></div>
<div class="line"><span class="comment">           equations for this and the issue is that it is strongly dependent on</span></div>
<div class="line"><span class="comment">           depth. Since the soil model now has a single layer, this cannot be</span></div>
<div class="line"><span class="comment">           implemented correctly at the moment.  */</span></div>
<div class="line"></div>
<div class="line">        SoilTemp = AirTemp;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Let us use an idea of Campbell and Norman. Environmental</span></div>
<div class="line"><span class="comment">           Biophysics. */</span></div>
<div class="line">        <span class="comment">/* If relative available water content is */</span></div>
<div class="line">        rawc = (awc - wiltp)/(fieldc - wiltp);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Page 142 */</span></div>
<div class="line">        <span class="comment">/* Maximum Dimensionless Uptake Rate */</span></div>
<div class="line">        Up = 1 - pow((1 + 1.3 * rawc),-5);  </div>
<div class="line">        <span class="comment">/* This is a useful idea because dry soils evaporate little water when dry*/</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Total Radiation */</span></div>
<div class="line">        <span class="comment">/*&#39; Convert light assuming 1 µmol PAR photons = 0.235 J/s Watts*/</span></div>
<div class="line">        <span class="comment">/* At the moment soil evaporation is grossly overestimated. In WIMOVAC</span></div>
<div class="line"><span class="comment">           the light reaching the last layer of leaves is used. Here instead</span></div>
<div class="line"><span class="comment">           of calculating this again, I will for now assume a 10% as a rough</span></div>
<div class="line"><span class="comment">           estimate. Note that I could maybe get this since layIdir and</span></div>
<div class="line"><span class="comment">           layIDiff in sunML are external variables.  Rprintf(&quot;IRad</span></div>
<div class="line"><span class="comment">           %.5f&quot;,layIdir[0],&quot;\n&quot;); Update: 03-13-2009. I tried printing this</span></div>
<div class="line"><span class="comment">           value but it is still too high and will likely overestimate soil</span></div>
<div class="line"><span class="comment">           evaporation. However, this is still a work in progress.</span></div>
<div class="line"><span class="comment">        */</span></div>
<div class="line">        IRad *= rsec; <span class="comment">/* Radiation soil evaporation coefficient */</span> </div>
<div class="line"></div>
<div class="line">        TotalRadiation = IRad * 0.235;</div>
<div class="line"> </div>
<div class="line">        DdryA = <a class="code" href="_aux_bio_cro_8c.html#aef4a29370ba3b33794837905d82f3b86">TempToDdryA</a>(AirTemp) ;</div>
<div class="line">        LHV = <a class="code" href="_aux_bio_cro_8c.html#abea4623ebab0e4ea7d9be5af1fd80344">TempToLHV</a>(AirTemp) * 1e6 ; </div>
<div class="line"><span class="comment">/* Here LHV is given in MJ kg-1 and this needs to be converted</span></div>
<div class="line"><span class="comment">   to Joules kg-1  */</span></div>
<div class="line">        SlopeFS = <a class="code" href="_aux_bio_cro_8c.html#abd35797ea11e52f0c527d40a9c1c0b7d">TempToSFS</a>(AirTemp) * 1e-3;</div>
<div class="line">        SWVC = <a class="code" href="_aux_bio_cro_8c.html#a2b62fa0d37af87f9af219e7b0d56f34d">TempToSWVC</a>(AirTemp) * 1e-3;</div>
<div class="line"></div>
<div class="line">        PsycParam = (DdryA * SpecificHeat) / LHV;</div>
<div class="line">        DeltaPVa = SWVC * (1 - RelH / 100);</div>
<div class="line"></div>
<div class="line">        BoundaryLayerThickness = 4e-3 * sqrt(SoilClodSize / winds); </div>
<div class="line">        DiffCoef = 2.126e-5 * 1.48e-7 * SoilTemp;</div>
<div class="line">        SoilBoundaryLayer = DiffCoef / BoundaryLayerThickness;</div>
<div class="line"></div>
<div class="line">        Ja = 2 * TotalRadiation * ((1 - SoilReflectance - SoilTransmission) / (1 - SoilTransmission));</div>
<div class="line"></div>
<div class="line">        rlc = 4 * StefanBoltzman * pow((273 + SoilTemp),3) * 0.005;</div>
<div class="line"><span class="comment">/* the last term should be the difference between air temperature and</span></div>
<div class="line"><span class="comment">   soil. This is not actually calculated at the moment. Since this is</span></div>
<div class="line"><span class="comment">   mostly relevant to the first soil layer where the temperatures are</span></div>
<div class="line"><span class="comment">   similar. I will leave it like this for now. */</span></div>
<div class="line"></div>
<div class="line">        PhiN = Ja - rlc; <span class="comment">/* Calculate the net radiation balance*/</span></div>
<div class="line">        <span class="keywordflow">if</span>(PhiN &lt; 0) PhiN = 1e-7;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Priestly-Taylor */</span></div>
<div class="line">        <span class="keywordflow">if</span>(method == 0){</div>
<div class="line">                Evaporation = 1.26 * (SlopeFS * PhiN) / (LHV * (SlopeFS + PsycParam));</div>
<div class="line">        }<span class="keywordflow">else</span>{</div>
<div class="line">                <span class="comment">/* Penman-Monteith */</span></div>
<div class="line">                Evaporation = (SlopeFS * PhiN + LHV * PsycParam * SoilBoundaryLayer * DeltaPVa) / (LHV * (SlopeFS + PsycParam));</div>
<div class="line">        }</div>
<div class="line"><span class="comment">/*  Report back the soil evaporation rate in Units mmoles/m2/s */</span></div>
<div class="line"><span class="comment">/*     Evaporation = Evaporation * 1000:   &#39; Convert Kg H20/m2/s to g H20/m2/s */</span></div>
<div class="line"><span class="comment">/*     Evaporation = Evaporation / 18:     &#39; Convert g H20/m2/s to moles H20/m2/s */</span></div>
<div class="line"><span class="comment">/*     Evaporation = Evaporation * 1000:   &#39; Convert moles H20/m2/s to mmoles H20/m2/s */</span></div>
<div class="line">    </div>
<div class="line"><span class="comment">/*     If Evaporation &lt;= 0 Then Evaporation = 0.00001: </span></div>
<div class="line"><span class="comment">       &#39; Prevent any odd looking values which might get through at very low light levels */</span></div>
<div class="line"></div>
<div class="line">        Evaporation *= 1e6/18;</div>
<div class="line">        <span class="comment">/* Adding the area dependence and the effect of drying */</span></div>
<div class="line">        <span class="comment">/* Converting from m2 to ha (times 1e4) */</span></div>
<div class="line">        <span class="comment">/* Converting to hour */</span></div>
<div class="line">        Evaporation *= SoilArea * Up * cf2; </div>
<div class="line">        <span class="keywordflow">if</span>(Evaporation &lt; 0) Evaporation = 1e-6;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span>(Evaporation);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5537e2a57efaaf41b401666bb9e22062"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structsoil_m_l__str.html">soilML_str</a> soilML </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>precipit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>transp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>cws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soildepth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>depths</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fieldc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wiltp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phi1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phi2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structsoil_text__str.html">soilText_str</a>&#160;</td>
          <td class="paramname"><em>soTexS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>wsFun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>layers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rootDB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>AirTemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>IRad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>winds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RelH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hydrDist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rfl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rsec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rsdf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L804">804</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">                                                                                                                                                                                                                                                                                                                                                                  {</div>
<div class="line"></div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structrd__str.html">rd_str</a> <a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structseq_r_d__str.html">seqRD_str</a> <a class="code" href="_aux_bio_cro_8h.html#a15219c620f8cdf6d8cf731e485e2c668">tmp3</a>;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structsoil_m_l__str.html">soilML_str</a> tmp;</div>
<div class="line">        <span class="comment">/* Constant */</span></div>
<div class="line">        <span class="comment">/* const double G = 6.67428e-11;  m3 / (kg * s-2)  ##  http://en.wikipedia.org/wiki/Gravitational_constant */</span></div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> g = 9.8; <span class="comment">/* m / s-2  ##  http://en.wikipedia.org/wiki/Standard_gravity */</span></div>
<div class="line">        <span class="comment">/* Variables */</span></div>
<div class="line">        <span class="keywordtype">double</span> waterIn, oldWaterIn = 0.0;</div>
<div class="line"><span class="comment">/* Here is a convention aw is available water in volume and awc</span></div>
<div class="line"><span class="comment">   is available water content as a fraction of the soil section being investigated.</span></div>
<div class="line"><span class="comment">   paw is plant available water aw - wiltp */</span></div>
<div class="line">        <span class="keywordtype">double</span> aw, paw, awc, awc2, Newpawha;</div>
<div class="line">        <span class="keywordtype">double</span> <a class="code" href="structsoil_m_l__str.html#a6b156f63a9c5f2185dcb004e85518998">drainage</a> = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> wsPhoto = 0.0, wsSpleaf = 0.0, phi10;</div>
<div class="line">        <span class="keywordtype">double</span> wsPhotoCol = 0.0, wsSpleafCol = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> slp = 0.0, intcpt = 0.0, theta = 0.0; </div>
<div class="line">        <span class="keywordtype">double</span> <a class="code" href="structsoil_m_l__str.html#a26953bee326ec08f079e24838fc8feb6">Nleach</a> = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> layerDepth;</div>
<div class="line">        <span class="keywordtype">double</span> diffw;</div>
<div class="line">        <span class="keywordtype">double</span> rootATdepth, rootDepth;</div>
<div class="line">        <span class="keywordtype">double</span> EvapoTra = 0.0, oldEvapoTra = 0.0, Sevap = 0.0, Ctransp = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> psim1 = 0.0, psim2 = 0.0, K_psim = 0.0, J_w = 0.0, dPsim = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> theta_s; <span class="comment">/* This is the saturated soil water content. Larger than FieldC.*/</span></div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <span class="keywordtype">int</span> j = layers - 1; </div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Specify the soil type */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(fieldc &lt; 0){</div>
<div class="line">                fieldc = soTexS.<a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(wiltp &lt; 0){</div>
<div class="line">                wiltp = soTexS.<a class="code" href="structsoil_text__str.html#a6ee087ca614bcf981839ca4e28953fb2">wiltp</a>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        theta_s = soTexS.<a class="code" href="structsoil_text__str.html#ac769b10536dd94d3652ad1cbf8d58482">satur</a>;</div>
<div class="line">        <span class="comment">/* rooting depth */</span></div>
<div class="line">        <span class="comment">/* Crude empirical relationship between root biomass and rooting depth*/</span></div>
<div class="line">        rootDepth = rootDB * rsdf;</div>
<div class="line">        <span class="keywordflow">if</span>(rootDepth &gt; soildepth) rootDepth = soildepth;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="_aux_bio_cro_8h.html#a15219c620f8cdf6d8cf731e485e2c668">tmp3</a> = <a class="code" href="_aux_bio_cro_8c.html#a668682ce55f6888ab3ec44a7d7a48d07">seqRootDepth</a>(rootDepth,layers);</div>
<div class="line">        <a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a> = <a class="code" href="_aux_bio_cro_8c.html#a76d97071934ef506589d0ca8114d3647">rootDist</a>(layers,rootDepth,&amp;depths[0],rfl);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* unit conversion for precip */</span></div>
<div class="line">        waterIn = precipit * 1e-3; <span class="comment">/* convert precip in mm to m*/</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span>(j=0,i=layers-1;j&lt;layers;j++,i--){</div>
<div class="line">        <span class="comment">/* for(i=0;i&lt;layers;i++){ */</span></div>
<div class="line">                <span class="comment">/* It decreases because I increase the water content due to precipitation in the last layer first*/</span></div>
<div class="line"></div>
<div class="line">                <span class="comment">/* This supports unequal depths. */</span></div>
<div class="line">                <span class="keywordflow">if</span>(i == 0){</div>
<div class="line">                        layerDepth = depths[1];</div>
<div class="line">                }<span class="keywordflow">else</span>{</div>
<div class="line">                        layerDepth = depths[i] - depths[i-1];</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(hydrDist &gt; 0){</div>
<div class="line">                        <span class="comment">/* For this section see Campbell and Norman &quot;Environmental BioPhysics&quot; Chapter 9*/</span></div>
<div class="line">                        <span class="comment">/* First compute the matric potential */</span></div>
<div class="line">                        psim1 = soTexS.<a class="code" href="structsoil_text__str.html#accd3edb0af25e0499d5ffbfacc2af59c">air_entry</a> * pow((<a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i]/theta_s),-soTexS.<a class="code" href="structsoil_text__str.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>) ; <span class="comment">/* This is matric potential of current layer */</span></div>
<div class="line">                        <span class="keywordflow">if</span>(i &gt; 0){</div>
<div class="line">                                psim2 = soTexS.<a class="code" href="structsoil_text__str.html#accd3edb0af25e0499d5ffbfacc2af59c">air_entry</a> * pow((<a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i-1]/theta_s),-soTexS.<a class="code" href="structsoil_text__str.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>) ; <span class="comment">/* This is matric potential of next layer */</span></div>
<div class="line">                                dPsim = psim1 - psim2;</div>
<div class="line">                                <span class="comment">/* The substraction is from the layer i - (i-1). If this last term is positive then it will move upwards. If it is negative it will move downwards. Presumably this term is almost always positive. */</span></div>
<div class="line">                        }<span class="keywordflow">else</span>{</div>
<div class="line">                                dPsim = 0;</div>
<div class="line">                        }</div>
<div class="line">                        K_psim = soTexS.<a class="code" href="structsoil_text__str.html#aa9437b51e97937d66bd2c90f9a411652">Ks</a> * pow((soTexS.<a class="code" href="structsoil_text__str.html#accd3edb0af25e0499d5ffbfacc2af59c">air_entry</a>/psim1),2+3/soTexS.<a class="code" href="structsoil_text__str.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>); <span class="comment">/* This is hydraulic conductivity */</span></div>
<div class="line">                        J_w = K_psim * (dPsim/layerDepth) - g * K_psim ; <span class="comment">/*  Campbell, pg 129 do not ignore the graviational effect*/</span></div>
<div class="line">                        <span class="comment">/* Notice that K_psim is positive because my</span></div>
<div class="line"><span class="comment">                            reference system is reversed */</span></div>
<div class="line">                        <span class="comment">/* This last result should be in kg/(m2 * s)*/</span></div>
<div class="line">                         J_w *= 3600 * 0.9882 * 1e-3 ; <span class="comment">/* This is flow in m3 / (m^2 * hr). */</span></div>
<div class="line">                        <span class="comment">/* Rprintf(&quot;J_w %.10f \n&quot;,J_w);  */</span></div>
<div class="line">                        <span class="keywordflow">if</span>(i == (layers-1) &amp;&amp; J_w &lt; 0){</div>
<div class="line">                                        <span class="comment">/* cws[i] = cws[i] + J_w /</span></div>
<div class="line"><span class="comment">                                         * layerDepth; Although this</span></div>
<div class="line"><span class="comment">                                         * should be done it drains</span></div>
<div class="line"><span class="comment">                                         * the last layer too much.*/</span></div>
<div class="line">                                        drainage += J_w;</div>
<div class="line">                        }<span class="keywordflow">else</span>{</div>
<div class="line">                                <span class="keywordflow">if</span>(i &gt; 0){</div>
<div class="line">                                        <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] = <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] -  J_w / layerDepth;</div>
<div class="line">                                        <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i - 1] =  <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i-1] +  J_w / layerDepth;</div>
<div class="line">                                }<span class="keywordflow">else</span>{</div>
<div class="line">                                        <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] = <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] -  J_w / layerDepth;</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                 <span class="keywordflow">if</span>(<a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] &gt; theta_s) <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] = theta_s; </div>
<div class="line">                <span class="comment">/* if(cws[i+1] &gt; fieldc) cws[i+1] = fieldc; */</span></div>
<div class="line">                 <span class="keywordflow">if</span>(<a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] &lt; wiltp) <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] = wiltp; </div>
<div class="line">                <span class="comment">/* if(cws[i+1] &lt; wiltp) cws[i+1] = wiltp;  */</span></div>
<div class="line"></div>
<div class="line">                aw = <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] * layerDepth;</div>
<div class="line"><span class="comment">/* Available water (for this layer) is the current water status times the layer depth */</span></div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(waterIn &gt; 0){</div>
<div class="line">                        <span class="comment">/* There is some rain. Need to add it.*/</span></div>
<div class="line">                        aw += waterIn / layers + oldWaterIn; <span class="comment">/* They are both in meters so it works */</span></div>
<div class="line">                        <span class="comment">/* Adding the same amount to water to each layer */</span></div>
<div class="line">                        <span class="comment">/* In case there is overflow */</span></div>
<div class="line">                        diffw = fieldc * layerDepth - aw;</div>
<div class="line"></div>
<div class="line">                        <span class="keywordflow">if</span>(diffw &lt; 0){</div>
<div class="line">                                <span class="comment">/* This means that precipitation exceeded the capacity of the first layer */</span></div>
<div class="line">                                <span class="comment">/* Save this amount of water for the next layer */</span></div>
<div class="line">                                oldWaterIn = -diffw;</div>
<div class="line">                                aw = fieldc * layerDepth;</div>
<div class="line">                        }<span class="keywordflow">else</span>{</div>
<div class="line">                                oldWaterIn = 0.0;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Root Biomass */</span></div>
<div class="line">                rootATdepth = rootDB * <a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>.rootDist[i];</div>
<div class="line">                tmp.rootDist[i] = rootATdepth;</div>
<div class="line"><span class="comment">/* Plant available water is only between current water status and permanent wilting point */</span></div>
<div class="line">                <span class="comment">/* Plant available water */</span></div>
<div class="line">                paw = aw - wiltp * layerDepth;</div>
<div class="line">                <span class="keywordflow">if</span>(paw &lt; 0) paw = 0; </div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(i == 0){</div>
<div class="line">                        <span class="comment">/* Only the first layer is affected by soil evaporation */</span></div>
<div class="line">                        awc2 = aw / layerDepth;</div>
<div class="line">                        <span class="comment">/* SoilEvapo function needs soil water content  */</span></div>
<div class="line">                        Sevap = <a class="code" href="_aux_bio_cro_8c.html#ac96acf762dd39d5ff20d71788b0ca566">SoilEvapo</a>(LAI,k,AirTemp,IRad,awc2,fieldc,wiltp,winds,RelH,rsec);</div>
<div class="line">                        <span class="comment">/* I assume that crop transpiration is distributed simlarly to</span></div>
<div class="line"><span class="comment">                           root density.  In other words the crop takes up water proportionally</span></div>
<div class="line"><span class="comment">                           to the amount of root in each respective layer.*/</span></div>
<div class="line">                        Ctransp = transp*<a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>.rootDist[0];</div>
<div class="line">                        EvapoTra = Ctransp + Sevap;</div>
<div class="line">                        Newpawha = (paw * 1e4) - EvapoTra / 0.9982; <span class="comment">/* See the watstr function for this last number 0.9882 */</span></div>
<div class="line">                        <span class="comment">/* The first term in the rhs (paw * 1e4) is the m3 of water available in this layer.</span></div>
<div class="line"><span class="comment">                           EvapoTra is the Mg H2O ha-1 of transpired and evaporated water. 1/0.9882 converts from Mg to m3 */</span></div>
<div class="line">                }<span class="keywordflow">else</span>{</div>
<div class="line">                        Ctransp = transp*<a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>.rootDist[i];</div>
<div class="line">                        EvapoTra = Ctransp;</div>
<div class="line">                        Newpawha = (paw * 1e4) - (EvapoTra + oldEvapoTra);</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(Newpawha &lt; 0){</div>
<div class="line"><span class="comment">/* If the Demand is not satisfied by this layer. This will be stored and added to subsequent layers*/</span></div>
<div class="line">                        oldEvapoTra = -Newpawha;</div>
<div class="line">                         aw = wiltp * layerDepth; </div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                paw = Newpawha / 1e4 ;</div>
<div class="line">                awc = paw / layerDepth + wiltp;   </div>
<div class="line"></div>
<div class="line"><span class="comment">/* This might look like a weird place to populate the structure, but is more convenient*/</span></div>
<div class="line">                tmp.cws[i] = awc;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(wsFun == 0){</div>
<div class="line">                        slp = 1/(fieldc - wiltp);</div>
<div class="line">                        intcpt = 1 - fieldc * slp;</div>
<div class="line">                        wsPhoto = slp * awc + intcpt ;</div>
<div class="line">                }<span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">if</span>(wsFun == 1){</div>
<div class="line">                        phi10 = (fieldc + wiltp)/2;</div>
<div class="line">                        wsPhoto = 1/(1 + exp((phi10 - awc)/ phi1));</div>
<div class="line">                }<span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">if</span>(wsFun == 2){</div>
<div class="line">                        slp = (1 - wiltp)/(fieldc - wiltp);</div>
<div class="line">                        intcpt = 1 - fieldc * slp;</div>
<div class="line">                        theta = slp * awc + intcpt ;</div>
<div class="line">                        wsPhoto = (1 - exp(-2.5 * (theta - wiltp)/(1 - wiltp))) / (1 - exp(-2.5));</div>
<div class="line">                }<span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">if</span>(wsFun == 3){</div>
<div class="line">                        wsPhoto = 1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(wsPhoto &lt;= 0 )</div>
<div class="line">                        wsPhoto = 1e-20; <span class="comment">/* This can be mathematically lower than zero in some cases but I should prevent that. */</span></div>
<div class="line"></div>
<div class="line">                wsPhotoCol += wsPhoto;</div>
<div class="line"></div>
<div class="line">                wsSpleaf = pow(awc,phi2) * 1/pow(fieldc,phi2); </div>
<div class="line">                <span class="keywordflow">if</span>(wsFun == 3){ </div>
<div class="line">                        wsSpleaf = 1;</div>
<div class="line">                }</div>
<div class="line">                wsSpleafCol += wsSpleaf;</div>
<div class="line"></div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(waterIn &gt; 0){ </div>
<div class="line">                drainage = waterIn;</div>
<div class="line">                <span class="comment">/* Need to convert to units used in the Parton et al 1988 paper. */</span></div>
<div class="line">                <span class="comment">/* The data comes in mm/hr and it needs to be in cm/month */</span></div>
<div class="line">                Nleach = drainage * 0.1 * (1/24*30) / (18 * (0.2 + 0.7 * soTexS.<a class="code" href="structsoil_text__str.html#a4fcef85764276271df64bd49ff7667fb">sand</a>));</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line"><span class="comment">/* Apparently wsPhoto and wsSpleaf can be greater than 1 */</span></div>
<div class="line">        <span class="keywordflow">if</span>(wsPhoto &gt; 1) wsPhoto = 1;</div>
<div class="line">        <span class="keywordflow">if</span>(wsSpleaf &gt; 1) wsSpleaf = 1;</div>
<div class="line"></div>
<div class="line"><span class="comment">/* returning the structure */</span></div>
<div class="line">        tmp.rcoefPhoto = (wsPhotoCol/layers);</div>
<div class="line">        tmp.drainage = <a class="code" href="structsoil_m_l__str.html#a6b156f63a9c5f2185dcb004e85518998">drainage</a>;</div>
<div class="line">        tmp.Nleach = <a class="code" href="structsoil_m_l__str.html#a26953bee326ec08f079e24838fc8feb6">Nleach</a>;</div>
<div class="line">        tmp.rcoefSpleaf = (wsSpleafCol/layers);</div>
<div class="line">        tmp.SoilEvapo = Sevap;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span>(tmp);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="acb415c4c261f9fc0140240ad46007c87"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sunML </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Idir</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Idiff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cosTheta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>chil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>heightf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L74">74</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="_aux_bio_cro_8h.html#a287f9452c1f62b4c5c9ec0616503fb8e">sp1</a>, <a class="code" href="_aux_bio_cro_8h.html#a972c42de1800efab3685fc8a47e05da5">sp2</a>, <a class="code" href="_aux_bio_cro_8h.html#a959c4cc4acdec59096dac039bfdb627b">sp3</a>, <a class="code" href="_aux_bio_cro_8h.html#a25e1abfffbd0ba6bcb9e7d2b6c847c04">sp4</a>, <a class="code" href="_aux_bio_cro_8h.html#a048d95ccd2cc9d2f00c78c97343c9a6a">sp5</a>, <a class="code" href="_aux_bio_cro_8h.html#ac86af9361847656ad3514e64ad9e9842">sp6</a>;</div>
<div class="line">        <span class="keyword">extern</span> <span class="keywordtype">double</span> <a class="code" href="_aux_bio_cro_8h.html#ab0638a2083d3e8d4c1ac43a116da1ad8">layIdir</a>[], <a class="code" href="_aux_bio_cro_8h.html#a0b8103786ef18d899e25c932a2eb5b88">layIdiff</a>[], <a class="code" href="_aux_bio_cro_8h.html#a1e5f45a584d3c5541472f92c5875e4ea">layItotal</a>[], <a class="code" href="_aux_bio_cro_8h.html#a029005f88756e3761a72c104fae0d57b">layFsun</a>[], <a class="code" href="_aux_bio_cro_8h.html#a5a00a948cd8575f53c71ee1f4b799da5">layFshade</a>[], <a class="code" href="_aux_bio_cro_8h.html#a5ebe5f68c3871953059c08a083acdb9c">layHeight</a>[];</div>
<div class="line">        <span class="keywordtype">double</span> i;</div>
<div class="line">        <span class="keywordtype">double</span> k0, k1, k;</div>
<div class="line">        <span class="keywordtype">double</span> LAIi, CumLAI;</div>
<div class="line">        <span class="keywordtype">double</span> Isolar, Idiffuse, Ibeam, Iscat, Itotal,alphascatter;</div>
<div class="line">        <span class="keywordtype">double</span> Ls, Ld;</div>
<div class="line">        <span class="keywordtype">double</span> Fsun, Fshade;</div>
<div class="line">        alphascatter=0.8;</div>
<div class="line">        k0 = sqrt(pow(chil ,2) + pow(tan(acos(cosTheta)),2));</div>
<div class="line">        k1 = chil + 1.744*pow((chil+1.183),-0.733);</div>
<div class="line">        k = k0/k1;</div>
<div class="line">        <span class="keywordflow">if</span>(k&lt;0)</div>
<div class="line">                k = -k;</div>
<div class="line"></div>
<div class="line">        LAIi = LAI / nlayers;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span>(i=0;i&lt;nlayers;i++)</div>
<div class="line">        {</div>
<div class="line">                CumLAI = LAIi * (i+0.5);</div>
<div class="line">                </div>
<div class="line">                Ibeam=Idir*cosTheta;</div>
<div class="line">                Iscat = Ibeam * exp(-k *sqrt(alphascatter)* CumLAI)-Ibeam * exp(-k * CumLAI);</div>
<div class="line">                </div>
<div class="line">                </div>
<div class="line">                Isolar = Ibeam*k;</div>
<div class="line">                Idiffuse = Idiff * exp(-kd * CumLAI) + Iscat;</div>
<div class="line">                </div>
<div class="line">                </div>
<div class="line">                Ls = (1-exp(-k*LAIi))*exp(-k*CumLAI)/k;</div>
<div class="line">                Ld=LAIi-Ls;</div>
<div class="line"></div>
<div class="line">                Fsun=Ls/(Ls+Ld);</div>
<div class="line">                Fshade=Ld/(Ls+Ld);</div>
<div class="line">                <span class="comment">/*fraction intercepted*/</span></div>
<div class="line">                Itotal =(Fsun*Isolar + Idiffuse) * (1-exp(-k*LAIi))/k;</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* collecting the results */</span></div>
<div class="line">                layIdir[sp1++] = Isolar + Idiffuse;</div>
<div class="line">                layIdiff[sp2++] = Idiffuse;</div>
<div class="line">                layItotal[sp3++] = Itotal;</div>
<div class="line">                layFsun[sp4++] = Fsun;</div>
<div class="line">                layFshade[sp5++] = Fshade;</div>
<div class="line">                layHeight[sp6++] = CumLAI/heightf;</div>
<div class="line">        }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="aef4a29370ba3b33794837905d82f3b86"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double TempToDdryA </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L179">179</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">double</span> DdryA;</div>
<div class="line">        DdryA = 1.295163636 + -0.004258182 * Temp;</div>
<div class="line">        <span class="keywordflow">return</span>(DdryA);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abea4623ebab0e4ea7d9be5af1fd80344"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double TempToLHV </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L186">186</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">double</span> LHV;</div>
<div class="line">        LHV = 2.501 + -0.002372727 * Temp;</div>
<div class="line">        <span class="keywordflow">return</span>(LHV);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="abd35797ea11e52f0c527d40a9c1c0b7d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double TempToSFS </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L193">193</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">double</span> SlopeFS;</div>
<div class="line">        SlopeFS = 0.338376068 +  0.011435897 * Temp +  0.001111111 * pow(Temp,2);</div>
<div class="line">        <span class="keywordflow">return</span>(SlopeFS);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a2b62fa0d37af87f9af219e7b0d56f34d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double TempToSWVC </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temp</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L200">200</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">double</span> SWVC;</div>
<div class="line">        SWVC =  4.90820192 +   0.06387253 * Temp +    0.02745742 * pow(Temp,2);</div>
<div class="line">        <span class="keywordflow">return</span>(SWVC);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8dfc137af141b612fc3cde9b49b0fc5f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structws__str.html">ws_str</a> watstr </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>precipit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>evapo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>cws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soildepth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fieldc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wiltp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phi1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phi2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>soiltype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>wsFun</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L670">670</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line"></div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structws__str.html">ws_str</a> tmp;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structsoil_text__str.html">soilText_str</a> soTexS;</div>
<div class="line">        <span class="comment">/* Variables */</span></div>
<div class="line">        <span class="keywordtype">double</span> precipM;</div>
<div class="line">        <span class="comment">/* available water and per hectare */</span></div>
<div class="line">        <span class="keywordtype">double</span> aw, naw; </div>
<div class="line">        <span class="keywordtype">double</span> pawha, Newpawha, npaw; <span class="comment">/* new 04-27-2009 */</span></div>
<div class="line">        <span class="keywordtype">double</span> runoff = 0.0, runoff2 = 0.0;</div>
<div class="line">        <span class="comment">/* variable needed for calculation of water stress*/</span></div>
<div class="line">        <span class="keywordtype">double</span> wsPhoto = 0.0, wsSpleaf, phi10;</div>
<div class="line">        <span class="keywordtype">double</span> slp = 0.0, intcpt = 0.0, theta = 0.0; </div>
<div class="line">        <span class="keywordtype">double</span> Nleach = 0.0;</div>
<div class="line">        <span class="comment">/* Nleach is the NO3 leached and Ts is the sand content of the soil*/</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Specify the soil type */</span></div>
<div class="line">        soTexS = <a class="code" href="_aux_bio_cro_8c.html#a72f93049960e067cda6e7291ff1ff21a">soilTchoose</a>(soiltype);</div>
<div class="line"><span class="comment">/*   Ts = soTexS.sand; */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(<a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a> &lt; 0){</div>
<div class="line">                <a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a> = soTexS.fieldc;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(<a class="code" href="structsoil_text__str.html#a6ee087ca614bcf981839ca4e28953fb2">wiltp</a> &lt; 0){</div>
<div class="line">                <a class="code" href="structsoil_text__str.html#a6ee087ca614bcf981839ca4e28953fb2">wiltp</a> = soTexS.wiltp;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* unit conversion for precip */</span></div>
<div class="line">        precipM = precipit * 1e-3; <span class="comment">/* convert precip in mm to m*/</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/*    cws is current water status */</span></div>
<div class="line">        <span class="comment">/*    available water */</span></div>
<div class="line"></div>
<div class="line">        aw = precipM + cws;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* if(aw &gt; soTexS.satur){  */</span></div>
<div class="line">        <span class="comment">/*      runoff = aw - soTexS.satur; /\* Here runoff is interpreted as water content exceeding saturation level *\/ */</span></div>
<div class="line">        <span class="comment">/*      /\* Need to convert to units used in the Parton et al 1988 paper. *\/ */</span></div>
<div class="line">        <span class="comment">/*      /\* The data comes in mm/hr and it needs to be in cm/month *\/ */</span></div>
<div class="line">        <span class="comment">/*      runoff2 = runoff * 0.10 * (1/24*30); */</span></div>
<div class="line">        <span class="comment">/*      Nleach = runoff /18 * (0.2 + 0.7 * soTexS.sand); */</span></div>
<div class="line">        <span class="comment">/*      aw = soTexS.satur; */</span></div>
<div class="line">        <span class="comment">/* } */</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/* These equations are not correct as runoff would only occur when it exceeds</span></div>
<div class="line"><span class="comment">   saturation, but from the point of view of a crop only field capacity matters */</span></div>
<div class="line"><span class="comment">/* I&#39;m not sure about what to do about this */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(aw &gt; <a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a>){ </div>
<div class="line">                runoff = aw - <a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a>; <span class="comment">/* Here runoff is interpreted as water content exceeding saturation level */</span></div>
<div class="line">                <span class="comment">/* Need to convert to units used in the Parton et al 1988 paper. */</span></div>
<div class="line">                <span class="comment">/* The data comes in mm/hr and it needs to be in cm/month */</span></div>
<div class="line">                runoff2 = runoff * 0.10 * (1/24*30);</div>
<div class="line">                Nleach = runoff /18 * (0.2 + 0.7 * soTexS.sand);</div>
<div class="line">                aw = <a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Tipping bucket need to collect it if want to estimate runoff */</span> </div>
<div class="line">        <span class="comment">/* plant available water per hectare (pawha) */</span></div>
<div class="line">        pawha = (aw - <a class="code" href="structsoil_text__str.html#a6ee087ca614bcf981839ca4e28953fb2">wiltp</a>) * 1e4 * soildepth;</div>
<div class="line">        <span class="comment">/* The density of water is 998.2 kg/m3 at 20 degrees Celsius */</span></div>
<div class="line">        <span class="comment">/* or 0.9882 Mg/m3 */</span></div>
<div class="line">        <span class="comment">/* pawha is plant available water (m3) per hectare */</span></div>
<div class="line">        <span class="comment">/* evapo is demanded water (Mg) per hectare */</span></div>
<div class="line"></div>
<div class="line">        Newpawha = pawha - evapo / 0.9882; <span class="comment">/* New version 04-27-2009 */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/*  Here both are in m3 of water per ha-1 so this */</span></div>
<div class="line">        <span class="comment">/*  subtraction should be correct */</span></div>
<div class="line">        <span class="comment">/* go back to original units of water in the profile */</span></div>
<div class="line"></div>
<div class="line">        npaw = Newpawha * 1e-4 * (1/soildepth); <span class="comment">/* New 04-27-2009 */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(npaw &lt; 0) npaw = 0.0;</div>
<div class="line"></div>
<div class="line">        naw = npaw + <a class="code" href="structsoil_text__str.html#a6ee087ca614bcf981839ca4e28953fb2">wiltp</a>;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Calculating the soil water potential based on equations from Norman and Campbell */</span></div>
<div class="line">        <span class="comment">/* tmp.psim = soTexS.air_entry * pow((naw/soTexS.fieldc*1.1),-soTexS.b) ; */</span></div>
<div class="line">        <span class="comment">/* New version of the soil water potential is based on</span></div>
<div class="line"><span class="comment">         * &quot;Dynamic Simulation of Water Deficit Effects upon Maize</span></div>
<div class="line"><span class="comment">         * Yield&quot; R. F. Grant Agricultural Systems. 33(1990) 13-39. */</span></div>
<div class="line">        tmp.psim = -exp(log(0.033) + ((log(<a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a>) - log(naw))/(log(<a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a>) - log(wiltp)) * (log(1.5) - log(0.033)))) * 1e3; <span class="comment">/* This last term converts from MPa to kPa */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* three different type of equations for modeling the effect of water stress on vmax and leaf area expansion. </span></div>
<div class="line"><span class="comment">           The equation for leaf area expansion is more severe than the one for vmax. */</span></div>
<div class="line">        <span class="keywordflow">if</span>(wsFun == 0){ <span class="comment">/* linear */</span></div>
<div class="line">                slp = 1/(<a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a> - <a class="code" href="structsoil_text__str.html#a6ee087ca614bcf981839ca4e28953fb2">wiltp</a>);</div>
<div class="line">                intcpt = 1 - <a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a> * slp;</div>
<div class="line">                wsPhoto = slp * naw + intcpt ;</div>
<div class="line">        }<span class="keywordflow">else</span></div>
<div class="line">        <span class="keywordflow">if</span>(wsFun == 1){</div>
<div class="line">                phi10 = (<a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a> + <a class="code" href="structsoil_text__str.html#a6ee087ca614bcf981839ca4e28953fb2">wiltp</a>)/2;</div>
<div class="line">                wsPhoto = 1/(1 + exp((phi10 - naw)/ phi1));</div>
<div class="line">        }<span class="keywordflow">else</span></div>
<div class="line">        <span class="keywordflow">if</span>(wsFun == 2){</div>
<div class="line">                slp = (1 - <a class="code" href="structsoil_text__str.html#a6ee087ca614bcf981839ca4e28953fb2">wiltp</a>)/(<a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a> - wiltp);</div>
<div class="line">                intcpt = 1 - <a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a> * slp;</div>
<div class="line">                theta = slp * naw + intcpt ;</div>
<div class="line">                wsPhoto = (1 - exp(-2.5 * (theta - wiltp)/(1 - wiltp))) / (1 - exp(-2.5));</div>
<div class="line">        }<span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">if</span>(wsFun == 3){</div>
<div class="line">                        wsPhoto = 1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(wsPhoto &lt;= 0 )</div>
<div class="line">                wsPhoto = 1e-20; <span class="comment">/* This can be mathematically lower than zero in some cases but I should prevent that. */</span></div>
<div class="line"></div>
<div class="line">        wsSpleaf = pow(naw,phi2) * 1/pow(<a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a>,phi2); </div>
<div class="line">        <span class="keywordflow">if</span>(wsFun == 3){ </div>
<div class="line">                wsSpleaf = 1;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line"><span class="comment">/* Apparently wsPhoto and wsSpleaf can be greater than 1 */</span></div>
<div class="line">        <span class="keywordflow">if</span>(wsPhoto &gt; 1) wsPhoto = 1;</div>
<div class="line">        <span class="keywordflow">if</span>(wsSpleaf &gt; 1) wsSpleaf = 1;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* returning the structure*/</span></div>
<div class="line">        tmp.rcoefPhoto = wsPhoto;</div>
<div class="line">        tmp.rcoefSpleaf = wsSpleaf;</div>
<div class="line">        tmp.awc = naw;</div>
<div class="line">        tmp.runoff = runoff;</div>
<div class="line">        tmp.Nleach = Nleach;</div>
<div class="line">        <span class="keywordflow">return</span>(tmp);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a43b0d68a959084dc4f4dc099c8901107"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void WINDprof </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>WindSpeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L128">128</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <span class="keywordtype">double</span> k=0.7;</div>
<div class="line">        <span class="keywordtype">double</span> LI, CumLAI;</div>
<div class="line">        <span class="keywordtype">double</span> Wind;</div>
<div class="line"></div>
<div class="line">        LI  = LAI / nlayers;</div>
<div class="line">        <span class="keywordflow">for</span>(i=0;i&lt;nlayers;i++)</div>
<div class="line">        {</div>
<div class="line">                CumLAI = LI * (i + 1);</div>
<div class="line">                Wind = WindSpeed * exp(-k * (CumLAI-LI));</div>
<div class="line">                <a class="code" href="_aux_bio_cro_8h.html#a15219c620f8cdf6d8cf731e485e2c668">tmp3</a>[<a class="code" href="_aux_bio_cro_8h.html#af8b40a97721000892ae5e0ac624af4c6">tp3</a>++] = Wind;</div>
<div class="line">        }</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<h2>Variable Documentation</h2>
<a class="anchor" id="a5b6e16664a459420103984ac5409b858"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double CanopyAssim[8760]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L8">8</a> of file <a class="el" href="">BioCro.h</a>.</p>

</div>
</div>
<a class="anchor" id="a46f339721a905fe9e6f60af35ec11974"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Grainy[8760]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L13">13</a> of file <a class="el" href="">BioCro.h</a>.</p>

</div>
</div>
<a class="anchor" id="ac656f07a64aeba7d6ac5a3a536e993c8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double LAIc[8760]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L14">14</a> of file <a class="el" href="">BioCro.h</a>.</p>

</div>
</div>
<a class="anchor" id="abd2c9bad12951c887e8469151c778947"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Leafy[8760]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L9">9</a> of file <a class="el" href="">BioCro.h</a>.</p>

</div>
</div>
<a class="anchor" id="aa3741856cde2b5152c833b543abe77fc"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Rhizomey[8760]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L12">12</a> of file <a class="el" href="">BioCro.h</a>.</p>

</div>
</div>
<a class="anchor" id="ad6a54d6e671d04cd9b254a8cd1c3315c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Rooty[8760]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L11">11</a> of file <a class="el" href="">BioCro.h</a>.</p>

</div>
</div>
<a class="anchor" id="a929d2badff7fb301509012ee6e6a12e9"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Stemy[8760]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L10">10</a> of file <a class="el" href="">BioCro.h</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="_bio_cro_8h.html">BioCro.h</a></li>
    <li class="footer">Generated on Wed Jan 22 2014 09:27:25 for BioCro by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.1.2 </li>
  </ul>
</div>
</body>
</html>
