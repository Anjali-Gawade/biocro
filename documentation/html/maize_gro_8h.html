<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>BioCro: src/maizeGro.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BioCro
   &#160;<span id="projectnumber">0.92</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('maize_gro_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">maizeGro.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="maize_gro_8h__dep__incl.png" border="0" usemap="#src_2maize_gro_8hdep" alt=""/></div>
<map name="src_2maize_gro_8hdep" id="src_2maize_gro_8hdep">
<area shape="rect" id="node3" href="maize_gro_8c.html" title="src/maizeGro.c" alt="" coords="5,83,115,112"/></map>
</div>
</div>
<p><a href="">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad67c5b654f4bceb23717a84244291ea0"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="struct_can___str.html">Can_Str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maize_gro_8h.html#ad67c5b654f4bceb23717a84244291ea0">CanAC</a> (double LAI, int DOY, int hr, double solarR, double Temp, double RH, double WindSpeed, double lat, int nlayers, double Vmax, double Alpha, double Kparm, double theta, double beta, double Rd, double Catm, double b0, double b1, double StomataWS, int ws, double kd, double chil, double heightf, double leafN, double kpLN, double lnb0, double lnb1, int lnfun, double upperT, double lowerT, struct <a class="el" href="structnitro_parms.html">nitroParms</a> nitroP)</td></tr>
<tr class="memitem:a8df740a747a3d6378541a4f69bbff29f"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structlai__str.html">lai_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maize_gro_8h.html#a8df740a747a3d6378541a4f69bbff29f">laiLizasoFun</a> (double thermalt, double phenostage, double phyllochron1, double phyllochron2, double Ax, double LT, double k0, double a1, double a2, double L0, double LLx, double Lx, double LNl)</td></tr>
<tr class="memitem:afd2fb9a28d2907211d146b3fba37e048"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structlai__str.html">lai_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maize_gro_8h.html#afd2fb9a28d2907211d146b3fba37e048">laiBirchdiscontinuousFun</a> (double phenostage, double Lt, double Amax, double c1, double c2, double c3, double c4)</td></tr>
<tr class="memitem:a51216bb4e018f7bc8aa10952ffdc102c"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structlai__str.html">lai_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="maize_gro_8h.html#a51216bb4e018f7bc8aa10952ffdc102c">laiBirchcontinuousFun</a> (double phenostage, double a, double b, double Amax, double x0, double f, double g, double TT, double LT)</td></tr>
</table>
<h2>Function Documentation</h2>
<a class="anchor" id="ad67c5b654f4bceb23717a84244291ea0"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="struct_can___str.html">Can_Str</a> CanAC </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>DOY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>solarR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>WindSpeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Vmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Alpha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Kparm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Catm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>StomataWS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>chil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>heightf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>leafN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kpLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lnfun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>upperT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lowerT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structnitro_parms.html">nitroParms</a>&#160;</td>
          <td class="paramname"><em>nitroP</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L539">539</a> of file <a class="el" href="">AuxBioCro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line"></div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="struct_e_t___str.html">ET_Str</a> tmp5_ET, tmp6_ET;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="struct_can___str.html">Can_Str</a> ans;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structc4__str.html">c4_str</a> tmpc4;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structc4__str.html">c4_str</a> tmpc42;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <span class="keywordtype">double</span> Idir, Idiff, cosTh;</div>
<div class="line">        <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#ac656f07a64aeba7d6ac5a3a536e993c8">LAIc</a>;</div>
<div class="line">        <span class="keywordtype">double</span> IDir, IDiff, Itot, rh, WS;</div>
<div class="line">        <span class="keywordtype">double</span> pLeafsun, pLeafshade;</div>
<div class="line">        <span class="keywordtype">double</span> Leafsun, Leafshade;</div>
<div class="line">        <span class="keywordtype">double</span> CanHeight;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> vmax1, leafN_lay;</div>
<div class="line">        <span class="keywordtype">double</span> TempIdir,TempIdiff,AssIdir,AssIdiff,GAssIdir,GAssIdiff;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> CanopyA, CanopyT,GCanopyA;</div>
<div class="line"></div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> cf = 3600 * 1e-6 * 30 * 1e-6 * 10000;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> cf2 = 3600 * 1e-3 * 18 * 1e-6 * 10000; </div>
<div class="line"></div>
<div class="line">        <span class="comment">/* For Assimilation */</span></div>
<div class="line">        <span class="comment">/* 3600 converts seconds to hours */</span></div>
<div class="line">        <span class="comment">/* 1e-6 converts micro mols to mols */</span></div>
<div class="line">        <span class="comment">/* 30 is the grams in one mol of CO2 */</span></div>
<div class="line">        <span class="comment">/* 1e-6 converts g to Mg */</span></div>
<div class="line">        <span class="comment">/* 10000 scales from meter squared to hectare */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* For Transpiration */</span></div>
<div class="line">        <span class="comment">/* 3600 converts seconds to hours */</span></div>
<div class="line">        <span class="comment">/* 1e-3 converts mili mols to mols */</span></div>
<div class="line">        <span class="comment">/* 18 is the grams in one mol of H20 */</span></div>
<div class="line">        <span class="comment">/* 1e-6 converts g to Mg */</span></div>
<div class="line">        <span class="comment">/* 10000 scales from meter squared to hectare */</span></div>
<div class="line"></div>
<div class="line">        <a class="code" href="_aux_bio_cro_8c.html#a46827eb56108821fe82228553f535293">lightME</a>(lat,DOY,hr);</div>
<div class="line"></div>
<div class="line">        Idir = <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[0] * solarR;</div>
<div class="line">        Idiff = <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[1] * solarR;</div>
<div class="line">        cosTh = <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[2];</div>
<div class="line">    </div>
<div class="line">        <a class="code" href="_aux_bio_cro_8c.html#acb415c4c261f9fc0140240ad46007c87">sunML</a>(Idir,Idiff,LAI,nlayers,cosTh, kd, chil, heightf);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* results from multilayer model */</span></div>
<div class="line">        LAIc = LAI / nlayers;</div>
<div class="line">        <span class="comment">/* Next I need the RH and wind profile */</span></div>
<div class="line">        <a class="code" href="_aux_bio_cro_8c.html#a247148ac54cf7d8c851326de6093b71e">RHprof</a>(RH,nlayers);</div>
<div class="line">        <a class="code" href="_aux_bio_cro_8c.html#a43b0d68a959084dc4f4dc099c8901107">WINDprof</a>(WindSpeed,LAI,nlayers);</div>
<div class="line"></div>
<div class="line">        <a class="code" href="_aux_bio_cro_8c.html#aa65c89edaec63830e4dd568a89d12fa2">LNprof</a>(leafN, LAI, nlayers, kpLN);</div>
<div class="line">        <span class="comment">/* It populates tmp5 */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Next use the EvapoTrans function */</span></div>
<div class="line">        CanopyA=0.0;</div>
<div class="line">        GCanopyA=0.0;</div>
<div class="line">        CanopyT=0.0;</div>
<div class="line">        <span class="keywordflow">for</span>(i=0;i&lt;nlayers;i++)</div>
<div class="line">        {</div>
<div class="line">                leafN_lay = <a class="code" href="_aux_bio_cro_8h.html#aaa2add75bf14b805a4da749043e7be33">tmp5</a>[--<a class="code" href="_aux_bio_cro_8h.html#a39f70a6dfb72439e2f4e0f03f27c0813">tp5</a>];</div>
<div class="line">                <span class="keywordflow">if</span>(lnfun == 0){</div>
<div class="line">                        vmax1 = Vmax;</div>
<div class="line">                }<span class="keywordflow">else</span>{</div>
<div class="line">                        vmax1 = leafN_lay * lnb1 + lnb0;</div>
<div class="line">               <span class="comment">/* For now alpha is not affected by leaf nitrogen */</span></div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                IDir = <a class="code" href="_aux_bio_cro_8h.html#ab0638a2083d3e8d4c1ac43a116da1ad8">layIdir</a>[--<a class="code" href="_aux_bio_cro_8h.html#a287f9452c1f62b4c5c9ec0616503fb8e">sp1</a>];</div>
<div class="line">                Itot = <a class="code" href="_aux_bio_cro_8h.html#a1e5f45a584d3c5541472f92c5875e4ea">layItotal</a>[--<a class="code" href="_aux_bio_cro_8h.html#a959c4cc4acdec59096dac039bfdb627b">sp3</a>];</div>
<div class="line"></div>
<div class="line">                rh = <a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>[--<a class="code" href="_aux_bio_cro_8h.html#a36e4d9011835445995335074adedad9a">tp4</a>];</div>
<div class="line">                WS = <a class="code" href="_aux_bio_cro_8h.html#a15219c620f8cdf6d8cf731e485e2c668">tmp3</a>[--<a class="code" href="_aux_bio_cro_8h.html#af8b40a97721000892ae5e0ac624af4c6">tp3</a>];</div>
<div class="line">                pLeafsun = <a class="code" href="_aux_bio_cro_8h.html#a029005f88756e3761a72c104fae0d57b">layFsun</a>[--<a class="code" href="_aux_bio_cro_8h.html#a25e1abfffbd0ba6bcb9e7d2b6c847c04">sp4</a>];</div>
<div class="line">                CanHeight = <a class="code" href="_aux_bio_cro_8h.html#a5ebe5f68c3871953059c08a083acdb9c">layHeight</a>[--<a class="code" href="_aux_bio_cro_8h.html#ac86af9361847656ad3514e64ad9e9842">sp6</a>];</div>
<div class="line">                Leafsun = LAIc * pLeafsun;</div>
<div class="line">                tmp5_ET = <a class="code" href="_aux_bio_cro_8c.html#a05f213f4cb25cf49735180ff3b883107">EvapoTrans</a>(IDir,Itot,Temp,rh,WS,LAIc,CanHeight,StomataWS,ws,vmax1,Alpha,Kparm,theta,beta,Rd,b0,b1,upperT,lowerT,Catm);</div>
<div class="line">                TempIdir = Temp + tmp5_ET.Deltat;</div>
<div class="line">                tmpc4 = <a class="code" href="c4photo_8c.html#ae71c7850944d255a9b995a06fdb305aa">c4photoC</a>(IDir,TempIdir,rh,vmax1,Alpha,Kparm,theta,beta,Rd,b0,b1,StomataWS, Catm, ws,upperT,lowerT);</div>
<div class="line">                AssIdir = tmpc4.Assim;</div>
<div class="line">    GAssIdir =tmpc4.GrossAssim;</div>
<div class="line"></div>
<div class="line">                IDiff = <a class="code" href="_aux_bio_cro_8h.html#a0b8103786ef18d899e25c932a2eb5b88">layIdiff</a>[--<a class="code" href="_aux_bio_cro_8h.html#a972c42de1800efab3685fc8a47e05da5">sp2</a>];</div>
<div class="line">                pLeafshade = <a class="code" href="_aux_bio_cro_8h.html#a5a00a948cd8575f53c71ee1f4b799da5">layFshade</a>[--<a class="code" href="_aux_bio_cro_8h.html#a048d95ccd2cc9d2f00c78c97343c9a6a">sp5</a>];</div>
<div class="line">                Leafshade = LAIc * pLeafshade;</div>
<div class="line">                tmp6_ET = <a class="code" href="_aux_bio_cro_8c.html#a05f213f4cb25cf49735180ff3b883107">EvapoTrans</a>(IDiff,Itot,Temp,rh,WS,LAIc,CanHeight,StomataWS,ws,vmax1,Alpha,Kparm,theta,beta,Rd,b0,b1,upperT,lowerT,Catm);</div>
<div class="line">                TempIdiff = Temp + tmp6_ET.Deltat;</div>
<div class="line">                tmpc42 = <a class="code" href="c4photo_8c.html#ae71c7850944d255a9b995a06fdb305aa">c4photoC</a>(IDiff,TempIdiff,rh,vmax1,Alpha,Kparm,theta,beta,Rd,b0,b1,StomataWS, Catm, ws,upperT,lowerT);</div>
<div class="line">                AssIdiff = tmpc42.Assim;</div>
<div class="line">    GAssIdiff = tmpc42.GrossAssim;</div>
<div class="line">                CanopyA += Leafsun * AssIdir + Leafshade * AssIdiff;</div>
<div class="line">    GCanopyA += Leafsun * GAssIdir + Leafshade * GAssIdiff;</div>
<div class="line"><span class="comment">// I am evaluating CanopyT using Penman Method because it gives realistic results</span></div>
<div class="line"><span class="comment">// IN future canopyT needs to be fixed</span></div>
<div class="line"><span class="comment">//                CanopyT += Leafsun * tmp5_ET.TransR + Leafshade * tmp6_ET.TransR;</span></div>
<div class="line">                CanopyT += Leafsun * tmp5_ET.EPenman + Leafshade * tmp6_ET.EPenman;</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">/*## These are micro mols of CO2 per m2 per sec for Assimilation</span></div>
<div class="line"><span class="comment">          ## and mili mols of H2O per m2 per sec for Transpiration</span></div>
<div class="line"><span class="comment">          ## Need to convert to </span></div>
<div class="line"><span class="comment">          ## 3600 converts seconds to hours</span></div>
<div class="line"><span class="comment">          ## 10^-6 converts micro mols to mols</span></div>
<div class="line"><span class="comment">          ## 30 converts mols of CO2 to grams</span></div>
<div class="line"><span class="comment">          ## (1/10^6) converts grams to Mg</span></div>
<div class="line"><span class="comment">          ## 10000 scales up to ha */</span></div>
<div class="line"><span class="comment">/* A similar conversion is made for water but</span></div>
<div class="line"><span class="comment">   replacing 30 by 18 and mili mols are converted to</span></div>
<div class="line"><span class="comment">   mols (instead of micro) */</span></div>
<div class="line">        ans.Assim = cf * CanopyA ;</div>
<div class="line">        ans.Trans = cf2 * CanopyT; </div>
<div class="line">        ans.GrossAssim=cf*GCanopyA;</div>
<div class="line">        <span class="keywordflow">return</span>(ans);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a51216bb4e018f7bc8aa10952ffdc102c"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structlai__str.html">lai_str</a> laiBirchcontinuousFun </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phenostage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Amax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>g</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>TT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LT</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L140">140</a> of file <a class="el" href="">AuxMaizeGro.c</a>.</p>
<div class="fragment"><div class="line">                                               {</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structlai__str.html">lai_str</a> tmp;</div>
<div class="line">        <span class="keywordtype">double</span> leafnumber = 0.0, totalLAI = 0.0, SLA = 0.0, TPLAmax = 0.0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">int</span> i, i2, i3, ln, ln2;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span>(i2 = 0; i2 &lt; <a class="code" href="_aux_maize_gro_8h.html#abdf261a2f5c0982109f87ae1d42cc8bb">MAXLEAFNUMBER</a>; i2++){</div>
<div class="line">                tmp.<a class="code" href="structlai__str.html#a827ead5321eef32bae4a1b95ac12cd7b">leafarea</a>[i2] = 0.0;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (phenostage &lt;= 0) {</div>
<div class="line">          leafnumber = 0;</div>
<div class="line">        }<span class="keywordflow">else</span>{</div>
<div class="line">          <span class="keywordflow">if</span> (phenostage &lt; 1){</div>
<div class="line">            leafnumber = phenostage* 100;</div>
<div class="line">          }<span class="keywordflow">else</span>{</div>
<div class="line">            leafnumber = LT;</div>
<div class="line">          }</div>
<div class="line">        }         </div>
<div class="line">        <span class="keywordflow">if</span> (Amax == -1){</div>
<div class="line">                <span class="comment">/* Eq 13 in Birch*/</span></div>
<div class="line">                Amax = 1000 * exp(-1.17 + 0.047 * LT);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (a == -1){</div>
<div class="line">                <span class="comment">/* Eq 18 in Birch */</span></div>
<div class="line">                a = -0.009 - exp(-0.2 * LT);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (b == -1){</div>
<div class="line">                <span class="comment">/* Eq 19 in Birch */</span></div>
<div class="line">                b = 0.0006 - exp(-0.43 * LT);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (x0 == -1){</div>
<div class="line">                <span class="comment">/* Eq 14 in Birch */</span></div>
<div class="line">                x0 = 0.67 * LT;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (g == -1){</div>
<div class="line">                <span class="comment">/* Eq 20 in Birch */</span></div>
<div class="line">                g = 107.9 * LT - 327;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span>(i3 = 0; i3 &lt; LT; i3++){</div>
<div class="line">                ln2 = i3 + 1;</div>
<div class="line">                TPLAmax += Amax * exp(a * (ln2 - x0) * (ln2 - x0) + b *</div>
<div class="line">                             (ln2 - x0) * (ln2 - x0) * (ln2 - x0));</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Birch Eq 11*/</span></div>
<div class="line">        SLA = TPLAmax / (1 + exp(-f * (TT - g)));</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i &lt; leafnumber; i++){</div>
<div class="line">          ln = i + 1;</div>
<div class="line">          tmp.leafarea[i] = Amax * exp(a * (ln - x0) * (ln - x0) + b *</div>
<div class="line">                             (ln - x0) * (ln - x0) * (ln - x0));</div>
<div class="line"></div>
<div class="line">           totalLAI += tmp.leafarea[i];</div>
<div class="line">         }</div>
<div class="line">         tmp.totalLeafArea = totalLAI - SLA;</div>
<div class="line">         <span class="keywordflow">return</span> (tmp);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="afd2fb9a28d2907211d146b3fba37e048"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structlai__str.html">lai_str</a> laiBirchdiscontinuousFun </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phenostage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Lt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Amax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>c1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>c2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>c3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>c4</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L97">97</a> of file <a class="el" href="">AuxMaizeGro.c</a>.</p>
<div class="fragment"><div class="line">                                                             {</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structlai__str.html">lai_str</a> tmp;</div>
<div class="line">        <span class="keywordtype">double</span> leafnumber, totalLAI = 0.0;</div>
<div class="line">        <span class="keywordflow">if</span> (phenostage &lt;= 0) {</div>
<div class="line">          leafnumber = 0;</div>
<div class="line">        }<span class="keywordflow">else</span>{</div>
<div class="line">          <span class="keywordflow">if</span> (phenostage &lt; 1){</div>
<div class="line">            leafnumber = phenostage* 100;</div>
<div class="line">          }<span class="keywordflow">else</span>{</div>
<div class="line">            leafnumber = LT;</div>
<div class="line">          }</div>
<div class="line">        }         </div>
<div class="line">        <span class="keywordflow">if</span> (Amax == -1){</div>
<div class="line">          <span class="comment">/* Eq 13 in Birch*/</span></div>
<div class="line">          Amax = 1000 * exp(-1.17 + 0.047 * LT);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordtype">int</span> i, i2, ln;</div>
<div class="line">        <span class="keywordflow">for</span>(i2=0;i2&lt;<a class="code" href="_aux_maize_gro_8h.html#abdf261a2f5c0982109f87ae1d42cc8bb">MAXLEAFNUMBER</a>;i2++){</div>
<div class="line">          tmp.leafarea[i2] = 0.0;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">for</span> (i = 0; i&lt;leafnumber; i++){</div>
<div class="line">          ln = i + 1;</div>
<div class="line">          <span class="keywordflow">if</span> (ln &lt;= 3){</div>
<div class="line">            <span class="comment">/* Eq 14 in Birch */</span></div>
<div class="line">            tmp.leafarea[i] = c1 * ln;</div>
<div class="line">          }<span class="keywordflow">else</span>{</div>
<div class="line">            <span class="keywordflow">if</span> (ln &lt;= 11){</div>
<div class="line">              <span class="comment">/* Eq 15 in Birch */</span></div>
<div class="line">              tmp.leafarea[i] = c2* ln * ln;</div>
<div class="line">            }<span class="keywordflow">else</span>{</div>
<div class="line">              <span class="comment">/* Eq 16 in Birch */</span></div>
<div class="line">              tmp.leafarea[i] = c3 * Amax + c4 * ln * ln;</div>
<div class="line">            }</div>
<div class="line">          }</div>
<div class="line">          totalLAI += tmp.leafarea[i];</div>
<div class="line">        }</div>
<div class="line">        tmp.totalLeafArea = totalLAI;</div>
<div class="line">        <span class="keywordflow">return</span> (tmp);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8df740a747a3d6378541a4f69bbff29f"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structlai__str.html">lai_str</a> laiLizasoFun </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>thermalt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phenostage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phyllochron1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phyllochron2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Ax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>k0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>a2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>L0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LLx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Lx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LNl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L10">10</a> of file <a class="el" href="">AuxMaizeGro.c</a>.</p>
<div class="fragment"><div class="line">                                                                                    {</div>
<div class="line"></div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structlai__str.html">lai_str</a> tmp;</div>
<div class="line">        <span class="keywordtype">double</span> A, kei, tei;</div>
<div class="line">        <span class="keywordtype">double</span> LNx = 0.67 * LT;</div>
<div class="line">        <span class="keywordtype">double</span> te1 = 25;</div>
<div class="line">        <span class="keywordtype">double</span> te2 = 50;</div>
<div class="line">        <span class="keywordtype">double</span> tti;</div>
<div class="line">        <span class="keywordtype">double</span> tsi;</div>
<div class="line">        <span class="keywordtype">double</span> leafnumber ;</div>
<div class="line">        <span class="keywordtype">double</span> totalLAI = 0.0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span> (phenostage &lt;= 0) {</div>
<div class="line">          leafnumber = 0;</div>
<div class="line">        }<span class="keywordflow">else</span>{</div>
<div class="line">          <span class="keywordflow">if</span> (phenostage &lt; 1){</div>
<div class="line">            leafnumber = phenostage* 100;</div>
<div class="line">          }<span class="keywordflow">else</span>{</div>
<div class="line">            leafnumber = LT;</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line"><span class="comment">/* Longevity */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Eq 11 in Lisazo 2003 */</span></div>
<div class="line">        <span class="keywordflow">if</span> (LNl == -1){ </div>
<div class="line">            LNl = 3.59 + 0.498 * LT;</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">/* Eq 12 in Lisazo 2003 */</span></div>
<div class="line">        <span class="comment">/* double Wl = 0.333333 * LT; not used ? */</span></div>
<div class="line">        <span class="keywordtype">double</span> LLi;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> Wk = LT / 8.18;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">int</span> i, i2, ln = 0;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span>(i2=0;i2&lt;<a class="code" href="_aux_maize_gro_8h.html#abdf261a2f5c0982109f87ae1d42cc8bb">MAXLEAFNUMBER</a>;i2++){</div>
<div class="line">                tmp.<a class="code" href="structlai__str.html#a827ead5321eef32bae4a1b95ac12cd7b">leafarea</a>[i2] = 0.0;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span>(i=0;i&lt;leafnumber;i++){</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Eq 7 in Lizaso 2003 */</span></div>
<div class="line">                ln = i + 1;</div>
<div class="line">                tti = (ln - 2) * phyllochron1 + te2;</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Eq 8 in Lizaso 2003 */</span></div>
<div class="line">                kei = k0 + 0.174 * exp( - ((ln - 1)*(ln - 1))/(2 * Wk * Wk));</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Eq 10 in Lizaso 2003 */</span></div>
<div class="line">                LLi = L0 + Lx * exp( - (ln - LNl)*(ln - LNl)/ (2*Wk*Wk));</div>
<div class="line">                </div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Eq 6 in Lizaso 2003 */</span></div>
<div class="line">                <span class="keywordflow">if</span>(ln == 1) tei = te1;</div>
<div class="line">                <span class="keywordflow">if</span>(ln == 2){</div>
<div class="line">                        tei = te2;</div>
<div class="line">                }<span class="keywordflow">else</span>{</div>
<div class="line">                        tei = tti + (2.197 /kei);</div>
<div class="line">                }</div>
<div class="line">                </div>
<div class="line">                <span class="comment">/* calculating time of 50% senescence from time of 50%</span></div>
<div class="line"><span class="comment">                 * expansion and leaf longevity */</span></div>
<div class="line">                tsi = LLi + tei;</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Applying Eq 4 in Lizaso 2003 */</span></div>
<div class="line">                A = <a class="code" href="_aux_maize_gro_8c.html#a34e7325a80b427a108b3190a3f1888f5">Aei</a>(ln, Ax, LNx, a1, a2);</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Applying Eq 2 in Lizaso 2003 */</span></div>
<div class="line">                tmp.leafarea[i] = <a class="code" href="_aux_maize_gro_8c.html#afcf4b24a9ebeca18c6745f807e3ea08f">Alogistic</a>(thermalt, A, kei, tei);</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* calculating senesced area for this leaf */</span></div>
<div class="line">                tmp.leafarea[i] -= <a class="code" href="_aux_maize_gro_8c.html#afcf4b24a9ebeca18c6745f807e3ea08f">Alogistic</a>(thermalt, A, kei, tsi);</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Rprintf(&quot;leaf area %.1f \n&quot;, tmp.leafarea[i]);  */</span></div>
<div class="line">                totalLAI += tmp.leafarea[i];</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        tmp.totalLeafArea = totalLAI;</div>
<div class="line">        <span class="keywordflow">return</span>(tmp);</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="maize_gro_8h.html">maizeGro.h</a></li>
    <li class="footer">Generated on Wed Jan 22 2014 09:27:26 for BioCro by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.1.2 </li>
  </ul>
</div>
</body>
</html>
