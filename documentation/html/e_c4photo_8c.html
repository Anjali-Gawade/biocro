<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>BioCro: src/eC4photo.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BioCro
   &#160;<span id="projectnumber">0.92</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('e_c4photo_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">eC4photo.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;R.h&gt;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;Rmath.h&gt;</code><br/>
<code>#include &lt;Rinternals.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="">AuxBioCro.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">CanA.h</a>&quot;</code><br/>
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for eC4photo.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="e_c4photo_8c__incl.png" border="0" usemap="#src_2e_c4photo_8c" alt=""/></div>
<map name="src_2e_c4photo_8c" id="src_2e_c4photo_8c">
<area shape="rect" id="node11" href="_aux_bio_cro_8h.html" title="AuxBioCro.h" alt="" coords="368,83,464,112"/><area shape="rect" id="node13" href="_can_a_8h.html" title="CanA.h" alt="" coords="488,83,555,112"/></map>
</div>
</div>
<p><a href="">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac3eddd9862ded6e65643aea0cb9406c8"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="e_c4photo_8c.html#ac3eddd9862ded6e65643aea0cb9406c8">eC4photoC</a> (double QP, double TEMP, double RH, double CA, double OA, double VCMAX, double VPMAX, double VPR, double JMAX)</td></tr>
<tr class="memitem:ae02634988012c10db6b7b93d60c679d2"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="e_c4photo_8c.html#ae02634988012c10db6b7b93d60c679d2">eCanA</a> (SEXP lai, SEXP Doy, SEXP Hr, SEXP SolarR, SEXP ATemp, SEXP RelH, SEXP WindS, SEXP CA, SEXP OA, SEXP VCMAX, SEXP VPMAX, SEXP VPR, SEXP JMAX, SEXP STOMATAWS)</td></tr>
<tr class="memitem:a34c2375d9e857ee884d1867da957ba35"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="e_c4photo_8c.html#a34c2375d9e857ee884d1867da957ba35">eC4photo</a> (SEXP QP, SEXP TEMP, SEXP RH, SEXP CA, SEXP OA, SEXP VCMAX, SEXP VPMAX, SEXP VPR, SEXP JMAX)</td></tr>
<tr class="memitem:a4f766a8f283c0736da0ab400ace4abba"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="e_c4photo_8c.html#a4f766a8f283c0736da0ab400ace4abba">RsqeC4photo</a> (double oAssim[<a class="el" href="e_c4photo_8c.html#a44f34a427107babc7cd2db474942ee24">enObs</a>], double oQp[<a class="el" href="e_c4photo_8c.html#a44f34a427107babc7cd2db474942ee24">enObs</a>], double oTemp[<a class="el" href="e_c4photo_8c.html#a44f34a427107babc7cd2db474942ee24">enObs</a>], double oRH[<a class="el" href="e_c4photo_8c.html#a44f34a427107babc7cd2db474942ee24">enObs</a>], double Ca, double Oa, double Vcmax, double Vpmax, double Vpr, double Jmax)</td></tr>
<tr class="memitem:a8006074d888610622a3eb6cfcb111955"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="e_c4photo_8c.html#a8006074d888610622a3eb6cfcb111955">McMCEc4photo</a> (SEXP oASSIM, SEXP oQP, SEXP oTEMP, SEXP oRelH, SEXP NITER, SEXP iCA, SEXP iOA, SEXP iVCMAX, SEXP iVPMAX, SEXP iJMAX, SEXP THRESH, SEXP SCALE)</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a44f34a427107babc7cd2db474942ee24"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="e_c4photo_8c.html#a44f34a427107babc7cd2db474942ee24">enObs</a></td></tr>
</table>
<h2>Function Documentation</h2>
<a class="anchor" id="a34c2375d9e857ee884d1867da957ba35"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP eC4photo </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>QP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>TEMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>OA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>VCMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>VPMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>VPR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>JMAX</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L291">291</a> of file <a class="el" href="">eC4photo.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="keywordtype">int</span> nqp, i;</div>
<div class="line">  nqp = length(QP);</div>
<div class="line">    <span class="comment">/* CONSTANTS */</span></div>
<div class="line">  <span class="keywordtype">double</span> P = 101.3;</div>
<div class="line">  <span class="keywordtype">double</span> G1 = 3;</div>
<div class="line">  <span class="keywordtype">double</span> G0 = 0.08;</div>
<div class="line"></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span>  gs = 3 * 1e-3 ;</div>
<div class="line">    <span class="comment">/* mol m-2 s-1 physical conductance to CO2 leakage*/</span></div>
<div class="line">    <span class="comment">/* const double gammaStar = 0.000193  */</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> gammaStar =  0.000193 ;</div>
<div class="line">    <span class="comment">/* half the reciprocal of Rubisco specificity */</span></div>
<div class="line">    <span class="comment">/*    const double go = 0.047 * gs     at 25 C */</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> alpha = 0.01 ; <span class="comment">/* alpha in the notes*/</span></div>
<div class="line">    <span class="keywordtype">double</span> Kp = 80 ; <span class="comment">/*  mu bar */</span></div>
<div class="line">    <span class="keywordtype">double</span> theta = 0.7;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> R = 0.008314472; <span class="comment">/* Gas constant J K-1 mol-1 */</span></div>
<div class="line">    <span class="comment">/* in the units stated should be 8.314 but </span></div>
<div class="line"><span class="comment">       XGZ determined it is * 1e-3 */</span> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> Kelvin0 = 273.15;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> Kelvin25 = 298.15;</div>
<div class="line">    <span class="comment">/* This is 0 and 25 Celsius degrees in the Kelvin scale */</span></div>
<div class="line"></div>
<div class="line">    <span class="comment">/* ADDING THE TEMPERATURE RESPONSE FUNCTION */</span></div>
<div class="line">    <span class="keywordtype">double</span> Epr = 46.8 ; <span class="comment">/* Activation energy of PPDK kj/mol*/</span></div>
<div class="line">    <span class="keywordtype">double</span> Ep  = 47.1 ; <span class="comment">/* Activation energy of PEPc kj/mol */</span></div>
<div class="line">    <span class="keywordtype">double</span> Erb = 72 ; <span class="comment">/* Activation energy of Rubisco kj/mol */</span></div>
<div class="line">    <span class="comment">/*    const double Q10bf = 1.7 */</span></div>
<div class="line">    <span class="keywordtype">double</span> ERd = 46.39;</div>
<div class="line">    <span class="keywordtype">double</span> EKc = 79.43;</div>
<div class="line">    <span class="keywordtype">double</span> EKo = 36.38;</div>
<div class="line">    <span class="keywordtype">double</span> Q10cb = 1.7;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* double Ko = 450 ;  mbar at 25 C */</span></div>
<div class="line">    <span class="keywordtype">double</span> Ko2 = 450 ; <span class="comment">/* mbar at 25 C */</span></div>
<div class="line">    <span class="comment">/* double Kc = 650   mu bar at 25 C */</span></div>
<div class="line">    <span class="keywordtype">double</span> Kc2 = 650 ; <span class="comment">/*  mu bar at 25 C */</span></div>
<div class="line">    </div>
<div class="line">    <span class="comment">/* VAriables */</span> </div>
<div class="line">    <span class="keywordtype">double</span> Kc, Ko;</div>
<div class="line">    <span class="keywordtype">double</span> StomCond;</div>
<div class="line">    <span class="keywordtype">double</span> Idir, AirTemp, rh, Ca, Oa;</div>
<div class="line">    <span class="keywordtype">double</span> Vcmax1, Vpmax1, Jmax1;</div>
<div class="line">    <span class="keywordtype">double</span> Vcmax, Vpmax, Vpr, Jmax;</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">double</span> Q10pr, Q10p, Q10rb, Q10Rd, Q10Kc, Q10Ko;</div>
<div class="line">    <span class="keywordtype">double</span> Cm, Om;</div>
<div class="line">    <span class="keywordtype">double</span> Rd, Rm, Rs;</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">double</span> I2, J, Aj;</div>
<div class="line">    <span class="keywordtype">double</span> Vp, Ko1 , Om1;</div>
<div class="line">    <span class="keywordtype">double</span> a1, b1, c1 , c3, Ac0;</div>
<div class="line">    <span class="keywordtype">double</span> AcLCO2, Ac, A;</div>
<div class="line">    <span class="keywordtype">double</span> Os, Cs;</div>
<div class="line">    <span class="keywordtype">double</span> Cs0, Cs1;</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">double</span> aa, bb, cc;</div>
<div class="line"></div>
<div class="line">    SEXP names, lists;</div>
<div class="line">    SEXP Assim;</div>
<div class="line">    SEXP Gs;</div>
<div class="line">    SEXP Ci;</div>
<div class="line">    SEXP Oxy;</div>
<div class="line"></div>
<div class="line">    PROTECT(lists = allocVector(VECSXP,4));</div>
<div class="line">    PROTECT(names = allocVector(STRSXP,4));</div>
<div class="line"></div>
<div class="line">    PROTECT(Assim = allocVector(REALSXP,nqp));</div>
<div class="line">    PROTECT(Gs = allocVector(REALSXP,nqp));</div>
<div class="line">    PROTECT(Ci = allocVector(REALSXP,nqp));</div>
<div class="line">    PROTECT(Oxy = allocVector(REALSXP,nqp));</div>
<div class="line"></div>
<div class="line">    Ca = REAL(CA)[0];</div>
<div class="line">    Oa = REAL(OA)[0];</div>
<div class="line">    Vcmax1 = REAL(VCMAX)[0];</div>
<div class="line">    Vpmax1 = REAL(VPMAX)[0];</div>
<div class="line">    Vpr = REAL(VPR)[0];</div>
<div class="line">    Jmax1 = REAL(JMAX)[0];</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span>(i = 0;i &lt; nqp;i++){</div>
<div class="line"></div>
<div class="line">    Idir = REAL(QP)[i];</div>
<div class="line">    AirTemp = REAL(TEMP)[i];</div>
<div class="line">    rh = REAL(RH)[i];</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">    Q10pr = exp(Epr *(1/(R * Kelvin25)-1/(R * (AirTemp + Kelvin0))));</div>
<div class="line">    Q10p = exp(Ep *(1/(R * Kelvin25)-1/(R * (AirTemp + Kelvin0))));</div>
<div class="line">    Q10rb = exp(Erb *(1/(R * Kelvin25)-1/(R * (AirTemp + Kelvin0))));</div>
<div class="line">    Q10Rd = exp(ERd *(1/(R * Kelvin25)-1/(R * (AirTemp + Kelvin0))));</div>
<div class="line">    Q10Kc = exp(EKc *(1/(R * Kelvin25)-1/(R * (AirTemp + Kelvin0))));</div>
<div class="line">    Q10Ko = exp(EKo *(1/(R * Kelvin25)-1/(R * (AirTemp + Kelvin0))));</div>
<div class="line"></div>
<div class="line">    Vcmax = Vcmax1 * Q10rb;</div>
<div class="line">    Kc = Kc2 * Q10Kc;</div>
<div class="line">    Ko = Ko2 * Q10Ko;</div>
<div class="line">    Vpmax = Vpmax1 * Q10p;        </div>
<div class="line">    Jmax = Jmax1 * pow(Q10cb,(AirTemp-25)/10);</div>
<div class="line"></div>
<div class="line">    Cm = 0.4 * Ca ; </div>
<div class="line">    Om = Oa ;</div>
<div class="line">        </div>
<div class="line">    <span class="comment">/*    Rd = 0.01 * Vcmax; */</span></div>
<div class="line">    Rd = 0.08;</div>
<div class="line">    Rm = 0.5 * Rd ;</div>
<div class="line">    Rs = 0.5 * Rd;</div>
<div class="line">        </div>
<div class="line">    <span class="comment">/* Light limited */</span></div>
<div class="line">    I2 = (Idir * 0.85)/2;</div>
<div class="line">    J = (Jmax + I2  - sqrt(pow(Jmax+I2,2) - 4 * theta * I2 * Jmax ))/2*theta;        </div>
<div class="line">    <span class="comment">/* Long formula for light limited */</span></div>
<div class="line"></div>
<div class="line">    aa = 1 - (7 * gammaStar * alpha )/3 * 0.047;</div>
<div class="line">    bb = -(((0.4 * J)/2 - Rm + gs * Cm) + ((1-0.4)*J/3-Rd) + </div>
<div class="line">           gs*(7*gammaStar*Om/3) + </div>
<div class="line">           (alpha*gammaStar/0.047)*((1-0.04)*J/3 + 7*Rd/3));</div>
<div class="line">    cc = ((0.4 * J)/2 - Rm + gs * Cm)*((1-0.4)*J/3-Rd) -</div>
<div class="line">      gs * gammaStar * Om *((1-0.4)*J/3 + 7*Rd/3);</div>
<div class="line"></div>
<div class="line">    Aj = (-bb - sqrt(pow(bb,2)-4*aa*cc))/2*aa;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Other part */</span></div>
<div class="line">    Vp = (Cm * Vpmax) / (Cm + Kp) ;</div>
<div class="line">    <span class="keywordflow">if</span>(Vpr &lt; Vp){</div>
<div class="line">      Vp = Vpr;</div>
<div class="line">    }</div>
<div class="line">                </div>
<div class="line">    <span class="comment">/* Alternative formula */</span></div>
<div class="line">    Ko1 = Ko * 1e3;</div>
<div class="line">    Om1 = Om * 1e3;</div>
<div class="line"></div>
<div class="line">    a1 = 1 - alpha / 0.047 * Kc/Ko1 ;</div>
<div class="line">    b1 = -((Vp - Rm + gs * Cm)+</div>
<div class="line">           (Vcmax - Rd)+</div>
<div class="line">           gs*(Kc*(1+Om1/Ko1))+</div>
<div class="line">           ((alpha/0.047)*(gammaStar*Vcmax+Rd*Kc/Ko1)));</div>
<div class="line">    c1 = (Vcmax - Rd)*(Vp-Rm+gs*Cm)-</div>
<div class="line">          (Vcmax * gs * gammaStar * Om1 + Rd*gs*Kc*(1+Om1/Ko1));</div>
<div class="line">         </div>
<div class="line">    c3 = pow(b1,2) - 4*a1*c1;</div>
<div class="line">      <span class="keywordflow">if</span>(c3 &lt; 0){</div>
<div class="line">        c3 = 0;</div>
<div class="line">      }</div>
<div class="line">    Ac0 = (-b1 - sqrt(c3)) / 2*a1 ;</div>
<div class="line"></div>
<div class="line">    AcLCO2 = (Cm * Vpmax/(Cm+Kp)) - Rm + gs * Cm;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span>(Ac0 &lt; AcLCO2){</div>
<div class="line">      Ac = Ac0;</div>
<div class="line">    }<span class="keywordflow">else</span>{</div>
<div class="line">      Ac = AcLCO2;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(Aj &lt; Ac){</div>
<div class="line">      A = Aj;</div>
<div class="line">    }<span class="keywordflow">else</span>{</div>
<div class="line">      A = Ac;</div>
<div class="line">    }</div>
<div class="line">        </div>
<div class="line">    Os = alpha * A / 0.047 * gs + Om;</div>
<div class="line"></div>
<div class="line">     <span class="keywordflow">if</span>(Aj &lt;= Ac){ </div>
<div class="line">       Cs = Cm + (Vp - Aj - Rm)/gs;</div>
<div class="line">      }<span class="keywordflow">else</span>{ </div>
<div class="line">          Cs0 = gammaStar * Os + Kc*(1+Os/Ko)*((Ac+Rd)/Vcmax); </div>
<div class="line">          Cs1 = 1 - (Ac+Rd)/Vcmax; </div>
<div class="line">          Cs = Cs0/Cs1;</div>
<div class="line">           }</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Calculating Gs */</span></div>
<div class="line">     <span class="keywordflow">if</span>(A &lt; 0){</div>
<div class="line">       StomCond = G0;</div>
<div class="line">     }<span class="keywordflow">else</span>{</div>
<div class="line">       StomCond = G1 * (A * rh * P) / (Cm*1e-1) + G0;</div>
<div class="line">     }</div>
<div class="line">    <span class="comment">/* Organizing the results */</span></div>
<div class="line">    REAL(Assim)[i] = A;</div>
<div class="line">    REAL(Gs)[i] = StomCond;</div>
<div class="line">    REAL(Ci)[i] = Cs;</div>
<div class="line">    REAL(Oxy)[i] = Os;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    SET_VECTOR_ELT(lists,0,Assim);</div>
<div class="line">    SET_VECTOR_ELT(lists,1,Gs);</div>
<div class="line">    SET_VECTOR_ELT(lists,2,Ci);</div>
<div class="line">    SET_VECTOR_ELT(lists,3,Oxy);</div>
<div class="line"></div>
<div class="line">    SET_STRING_ELT(names,0,mkChar(<span class="stringliteral">&quot;Assim&quot;</span>));</div>
<div class="line">    SET_STRING_ELT(names,1,mkChar(<span class="stringliteral">&quot;Gs&quot;</span>));</div>
<div class="line">    SET_STRING_ELT(names,2,mkChar(<span class="stringliteral">&quot;Ci&quot;</span>));</div>
<div class="line">    SET_STRING_ELT(names,3,mkChar(<span class="stringliteral">&quot;Oxy&quot;</span>));</div>
<div class="line">    setAttrib(lists,R_NamesSymbol,names);</div>
<div class="line">    UNPROTECT(6);</div>
<div class="line">    <span class="keywordflow">return</span>(lists);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac3eddd9862ded6e65643aea0cb9406c8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double eC4photoC </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>QP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>TEMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>CA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>OA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>VCMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>VPMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>VPR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>JMAX</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L140">140</a> of file <a class="el" href="">eC4photo.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="comment">/* CONSTANTS */</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span>  gs = 3 * 1e-3 ;</div>
<div class="line">    <span class="comment">/* mol m-2 s-1 physical conductance to CO2 leakage*/</span></div>
<div class="line">    <span class="comment">/* const double gammaStar = 0.000193  */</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> gammaStar =  0.0002239473      ;</div>
<div class="line">    <span class="comment">/* half the reciprocal of Rubisco specificity */</span></div>
<div class="line">    <span class="comment">/*    const double go = 0.047 * gs     at 25 C */</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> a = 0.01 ; <span class="comment">/* alpha in the notes*/</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> Kp = 80 ; <span class="comment">/*  mu bar */</span></div>
<div class="line">    <span class="comment">/* const double Kc1 = 650 * 1e-3  mbar at 25 C */</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> Kc1 = 1020 * 1e-3; <span class="comment">/*  mbar at 25 C */</span></div>
<div class="line"></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> theta = 0.7;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* ADDING THE TEMPERATURE RESPONSE FUNCTION */</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> Epr = 46.8 ; <span class="comment">/* Activation energy of PPDK kj/mol*/</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> Ep  = 47.1 ; <span class="comment">/* Activation energy of PEPc kj/mol */</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> Erb = 72 ; <span class="comment">/* Activation energy of Rubisco kj/mol */</span></div>
<div class="line">    <span class="comment">/*    const double Q10bf = 1.7 */</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> ERd = 46.39;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> EKc = 79.43;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> EKo = 36.38;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> Q10cb = 1.7;</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* double Ko = 450 ;  mbar at 25 C */</span></div>
<div class="line">    <span class="keywordtype">double</span> Ko = 532.9 ; <span class="comment">/* mbar at 25 C */</span></div>
<div class="line">    <span class="comment">/* double Kc = 650   mu bar at 25 C */</span></div>
<div class="line">    <span class="keywordtype">double</span> Kc = 1020 ; <span class="comment">/*  mu bar at 25 C */</span></div>
<div class="line">    </div>
<div class="line">    <span class="comment">/* VAriables */</span> </div>
<div class="line">    <span class="keywordtype">double</span> Idir, AirTemp, rh, Ca, Oa;</div>
<div class="line">    <span class="keywordtype">double</span> Vcmax, Vpmax, Vpr, Jmax;</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">double</span> Q10pr, Q10p, Q10rb, Q10Rd, Q10Kc, Q10Ko;</div>
<div class="line">    <span class="keywordtype">double</span> Cm, Om;</div>
<div class="line">    <span class="keywordtype">double</span> Rd, Rm, Rs;</div>
<div class="line"></div>
<div class="line">    <span class="keywordtype">double</span> I2, J, Aj0, Aj1, Aj;</div>
<div class="line">    <span class="keywordtype">double</span> Vp, Ko1 , Om1;</div>
<div class="line">    <span class="keywordtype">double</span> a1, b1, c1 , c3, Ac0;</div>
<div class="line">    <span class="keywordtype">double</span> AcLCO2, Ac, A;</div>
<div class="line">    <span class="keywordtype">double</span> Os, Cs;</div>
<div class="line">    <span class="keywordtype">double</span> Cs0, Cs1;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">    Idir = QP;</div>
<div class="line">    AirTemp = TEMP;</div>
<div class="line">    rh = RH;</div>
<div class="line">    Ca = CA;</div>
<div class="line">    Oa = OA;</div>
<div class="line">    Vcmax = VCMAX;</div>
<div class="line">    Vpmax = VPMAX;</div>
<div class="line">    Vpr = VPR;</div>
<div class="line">    Jmax = JMAX;</div>
<div class="line"></div>
<div class="line">    Q10pr = exp(Epr *(1/(0.008314*298.15)-1/(0.008314*(AirTemp+273.15))));</div>
<div class="line">    Q10p = exp(Ep *(1/(0.008314*298.15)-1/(0.008314*(AirTemp+273.15))));</div>
<div class="line">    Q10rb = exp(Erb *(1/(0.008314*298.15)-1/(0.008314*(AirTemp+273.15))));</div>
<div class="line">    Q10Rd = exp(ERd *(1/(0.008314*298.15)-1/(0.008314*(AirTemp+273.15))));</div>
<div class="line">    Q10Kc = exp(EKc *(1/(0.008314*298.15)-1/(0.008314*(AirTemp+273.15))));</div>
<div class="line">    Q10Ko = exp(EKo *(1/(0.008314*298.15)-1/(0.008314*(AirTemp+273.15))));</div>
<div class="line"></div>
<div class="line">    Vcmax = Vcmax * Q10rb;</div>
<div class="line">    Kc = Kc * Q10Kc;</div>
<div class="line">    Ko = Ko * Q10Ko;</div>
<div class="line">    Vpmax = Vpmax * Q10p;        </div>
<div class="line">    Jmax = Jmax * pow(Q10cb,(AirTemp-25)/10);</div>
<div class="line"></div>
<div class="line">    Cm = 0.4 * Ca ; </div>
<div class="line">    Om = Oa ;</div>
<div class="line">        </div>
<div class="line">    <span class="comment">/*    Rd = 0.01 * Vcmax; */</span></div>
<div class="line">    Rd = 0.08;</div>
<div class="line">    Rm = 0.5 * Rd ;</div>
<div class="line">    Rs = 0.5 * Rd;</div>
<div class="line">        </div>
<div class="line">    <span class="comment">/* Light limited */</span></div>
<div class="line">    I2 = (Idir * 0.85)/2;</div>
<div class="line">    J = (Jmax + I2  - sqrt(pow(Jmax+I2,2) - 4 * theta * I2 * Jmax ))/2*theta;        </div>
<div class="line">    Aj0 = 0.4 * J - Rm + gs * Cm;        </div>
<div class="line">    Aj1 = (1-0.4)*J/3-Rd;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(Aj0 &lt; Aj1){</div>
<div class="line">      Aj = Aj0;</div>
<div class="line">    }<span class="keywordflow">else</span>{</div>
<div class="line">      Aj = Aj1;</div>
<div class="line">    }</div>
<div class="line">        </div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Other part */</span></div>
<div class="line">    Vp = (Cm * Vpmax) / (Cm + Kp) ;</div>
<div class="line">    <span class="keywordflow">if</span>(Vpr &lt; Vp){</div>
<div class="line">      Vp = Vpr;</div>
<div class="line">    }</div>
<div class="line">                </div>
<div class="line">    <span class="comment">/* Alternative formula */</span></div>
<div class="line">    Ko1 = Ko * 1e3;</div>
<div class="line">    Om1 = Om * 1e3;</div>
<div class="line"></div>
<div class="line">    a1 = 1 - a / 0.047 * Kc/Ko1 ;</div>
<div class="line">    b1 = -((Vp - Rm + gs * Cm)+</div>
<div class="line">           (Vcmax - Rd)+</div>
<div class="line">           gs*(Kc*(1+Om1/Ko1))+</div>
<div class="line">           ((a/0.047)*(gammaStar*Vcmax+Rd*Kc/Ko1)));</div>
<div class="line">    c1 = (Vcmax - Rd)*(Vp-Rm+gs*Cm)-</div>
<div class="line">          (Vcmax * gs * gammaStar * Om1 + Rd*gs*Kc*(1+Om1/Ko1));</div>
<div class="line">         </div>
<div class="line">    c3 = pow(b1,2) - 4*a1*c1;</div>
<div class="line">      <span class="keywordflow">if</span>(c3 &lt; 0){</div>
<div class="line">        c3 = 0;</div>
<div class="line">      }</div>
<div class="line">    Ac0 = (-b1 - sqrt(c3)) / 2*a1 ;</div>
<div class="line"></div>
<div class="line">    AcLCO2 = (Cm * Vpmax/(Cm+Kp)) - Rm + gs * Cm;</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">if</span>(Ac0 &lt; AcLCO2){</div>
<div class="line">      Ac = Ac0;</div>
<div class="line">    }<span class="keywordflow">else</span>{</div>
<div class="line">      Ac = AcLCO2;</div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">if</span>(Aj &lt; Ac){</div>
<div class="line">      A = Aj;</div>
<div class="line">    }<span class="keywordflow">else</span>{</div>
<div class="line">      A = Ac;</div>
<div class="line">    }</div>
<div class="line">        </div>
<div class="line">    Os = a * A / 0.047 * gs + Om;</div>
<div class="line">    <span class="keywordflow">if</span>(Aj &lt;= Ac){</div>
<div class="line">      Cs0 = (gammaStar * Os)*(7/3*(Aj + Rd) + (1-0.4)*J/3);</div>
<div class="line">      Cs1 = (1-0.4)*J/3-(Aj) ; </div>
<div class="line">      Cs = Cs0/Cs1;</div>
<div class="line">    }<span class="keywordflow">else</span>{</div>
<div class="line">      Cs0 = gammaStar * Os + Kc1*(1+Os/Ko)*((Ac+Rd)/Vcmax);</div>
<div class="line">          <span class="keywordflow">if</span>((Ac+Rd) &gt;= Vcmax){</div>
<div class="line">            Ac = Vcmax - Rd - 0.5 ;</div>
<div class="line">          }</div>
<div class="line">          Cs1 = 1 - (Ac+Rd)/Vcmax;</div>
<div class="line">          Cs = Cs0/Cs1;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span>(A);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae02634988012c10db6b7b93d60c679d2"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP eCanA </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>lai</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Doy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>Hr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SolarR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>ATemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>RelH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>WindS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>OA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>VCMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>VPMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>VPR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>JMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>STOMATAWS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L27">27</a> of file <a class="el" href="">eC4photo.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="comment">/* const int NLAYERS = 3;  this should eventually be replaced with</span></div>
<div class="line"><span class="comment">                            an argument coming in from R */</span></div>
<div class="line">  <span class="keyword">struct </span><a class="code" href="struct_e_t___str.html">ET_Str</a> <a class="code" href="_aux_bio_cro_8h.html#aaa2add75bf14b805a4da749043e7be33">tmp5</a>, tmp6;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">int</span> i;</div>
<div class="line">  <span class="keywordtype">double</span> Idir, Idiff, cosTh;</div>
<div class="line">  <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#ac656f07a64aeba7d6ac5a3a536e993c8">LAIc</a>;</div>
<div class="line">  <span class="keywordtype">double</span> IDir, IDiff, Itot, rh, WS;</div>
<div class="line">  <span class="keywordtype">double</span> pLeafsun, pLeafshade;</div>
<div class="line">  <span class="keywordtype">double</span> Leafsun, Leafshade;</div>
<div class="line"></div>
<div class="line"><span class="comment">/*   double tmp5,tmp6; */</span></div>
<div class="line">  <span class="keywordtype">double</span> TempIdir,TempIdiff,AssIdir,AssIdiff;</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">double</span> CanopyA;</div>
<div class="line">  <span class="keywordtype">double</span> CanHeight;</div>
<div class="line"></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> cf = 3600 * 1e-6 ;</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">int</span> DOY , hr;</div>
<div class="line">  <span class="keywordtype">double</span> LAI, solarR, Temp, RH, WindSpeed;</div>
<div class="line">  <span class="keywordtype">double</span> Ca, Oa, Vcmax, Vpmax, Vpr, Jmax;</div>
<div class="line">  <span class="keywordtype">double</span> upperT=27.5, lowerT=3.0;</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">double</span> lat = 40;</div>
<div class="line">  <span class="keywordtype">int</span> nlayers = 3;</div>
<div class="line">  <span class="keywordtype">double</span> kd = 0.1;</div>
<div class="line">  <span class="keywordtype">double</span> chil = 1;</div>
<div class="line">  <span class="keywordtype">double</span> stomataws;</div>
<div class="line"></div>
<div class="line">  SEXP growth;</div>
<div class="line"></div>
<div class="line">  PROTECT(growth = allocVector(REALSXP,1));</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  LAI = REAL(lai)[0];</div>
<div class="line">  DOY = INTEGER(Doy)[0];</div>
<div class="line">  hr = INTEGER(Hr)[0];</div>
<div class="line">  solarR = REAL(SolarR)[0];</div>
<div class="line">  Temp = REAL(ATemp)[0];</div>
<div class="line">  RH = REAL(RelH)[0];</div>
<div class="line">  WindSpeed = REAL(WindS)[0];</div>
<div class="line">  Ca = REAL(CA)[0];</div>
<div class="line">  Oa = REAL(OA)[0];</div>
<div class="line">  Vcmax = REAL(VCMAX)[0];</div>
<div class="line">  Vpmax = REAL(VPMAX)[0];</div>
<div class="line">  Vpr = REAL(VPR)[0];</div>
<div class="line">  Jmax = REAL(JMAX)[0];</div>
<div class="line">  stomataws = REAL(STOMATAWS)[0];</div>
<div class="line"></div>
<div class="line">  <a class="code" href="_aux_bio_cro_8c.html#a46827eb56108821fe82228553f535293">lightME</a>(lat,DOY,hr);</div>
<div class="line"></div>
<div class="line">  Idir = <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[0] * solarR;</div>
<div class="line">  Idiff = <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[1] * solarR;</div>
<div class="line">  cosTh = <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[2];</div>
<div class="line">    </div>
<div class="line">  <a class="code" href="_aux_bio_cro_8c.html#acb415c4c261f9fc0140240ad46007c87">sunML</a>(Idir,Idiff,LAI,nlayers,cosTh,kd,chil, 3);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* results from multilayer model */</span></div>
<div class="line">  LAIc = LAI / nlayers;</div>
<div class="line">  <span class="comment">/* Next I need the RH and wind profile */</span></div>
<div class="line">  <a class="code" href="_aux_bio_cro_8c.html#a247148ac54cf7d8c851326de6093b71e">RHprof</a>(RH,nlayers);</div>
<div class="line">  <a class="code" href="_aux_bio_cro_8c.html#a43b0d68a959084dc4f4dc099c8901107">WINDprof</a>(WindSpeed,LAI,nlayers);</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Next use the EvapoTrans function */</span></div>
<div class="line">  CanopyA=0.0;</div>
<div class="line">  <span class="keywordflow">for</span>(i=0;i&lt;nlayers;i++)</div>
<div class="line">    {</div>
<div class="line">      IDir = <a class="code" href="_aux_bio_cro_8h.html#ab0638a2083d3e8d4c1ac43a116da1ad8">layIdir</a>[--<a class="code" href="_aux_bio_cro_8h.html#a287f9452c1f62b4c5c9ec0616503fb8e">sp1</a>];</div>
<div class="line">      Itot = <a class="code" href="_aux_bio_cro_8h.html#a1e5f45a584d3c5541472f92c5875e4ea">layItotal</a>[--<a class="code" href="_aux_bio_cro_8h.html#a959c4cc4acdec59096dac039bfdb627b">sp3</a>];</div>
<div class="line"></div>
<div class="line">      rh = <a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>[--<a class="code" href="_aux_bio_cro_8h.html#a36e4d9011835445995335074adedad9a">tp4</a>];</div>
<div class="line">      WS = <a class="code" href="_aux_bio_cro_8h.html#a15219c620f8cdf6d8cf731e485e2c668">tmp3</a>[--<a class="code" href="_aux_bio_cro_8h.html#af8b40a97721000892ae5e0ac624af4c6">tp3</a>];</div>
<div class="line">      pLeafsun = <a class="code" href="_aux_bio_cro_8h.html#a029005f88756e3761a72c104fae0d57b">layFsun</a>[--<a class="code" href="_aux_bio_cro_8h.html#a25e1abfffbd0ba6bcb9e7d2b6c847c04">sp4</a>];</div>
<div class="line">      CanHeight = <a class="code" href="_aux_bio_cro_8h.html#a5ebe5f68c3871953059c08a083acdb9c">layHeight</a>[--<a class="code" href="_aux_bio_cro_8h.html#ac86af9361847656ad3514e64ad9e9842">sp6</a>];</div>
<div class="line">      Leafsun = LAIc * pLeafsun;</div>
<div class="line">      <a class="code" href="_aux_bio_cro_8h.html#aaa2add75bf14b805a4da749043e7be33">tmp5</a> = <a class="code" href="_aux_bio_cro_8c.html#a05f213f4cb25cf49735180ff3b883107">EvapoTrans</a>(IDir,Itot,Temp,rh,WS,Leafsun,CanHeight,stomataws,1,39,0.04,0.7,0.83,0.93,0.8,0.01,3,upperT,lowerT);</div>
<div class="line">      <span class="comment">/* not the right thing to do here to add these values at the end of the ET function</span></div>
<div class="line"><span class="comment">but just a simple fix for now. The problem is that the eC4photoC function should have its own</span></div>
<div class="line"><span class="comment">EvapoTrans function. */</span></div>
<div class="line">      TempIdir = Temp + <a class="code" href="_aux_bio_cro_8h.html#aaa2add75bf14b805a4da749043e7be33">tmp5</a>.Deltat;</div>
<div class="line">      AssIdir = <a class="code" href="e_c4photo_8c.html#ac3eddd9862ded6e65643aea0cb9406c8">eC4photoC</a>(IDir,TempIdir,rh,Ca,Oa,Vcmax,</div>
<div class="line">                         Vpmax,Vpr,Jmax);</div>
<div class="line"></div>
<div class="line">      IDiff = <a class="code" href="_aux_bio_cro_8h.html#a0b8103786ef18d899e25c932a2eb5b88">layIdiff</a>[--<a class="code" href="_aux_bio_cro_8h.html#a972c42de1800efab3685fc8a47e05da5">sp2</a>];</div>
<div class="line">      pLeafshade = <a class="code" href="_aux_bio_cro_8h.html#a5a00a948cd8575f53c71ee1f4b799da5">layFshade</a>[--<a class="code" href="_aux_bio_cro_8h.html#a048d95ccd2cc9d2f00c78c97343c9a6a">sp5</a>];</div>
<div class="line">      Leafshade = LAIc * pLeafshade;</div>
<div class="line">      tmp6 = <a class="code" href="_aux_bio_cro_8c.html#a05f213f4cb25cf49735180ff3b883107">EvapoTrans</a>(IDiff,Itot,Temp,rh,WS,Leafshade,CanHeight,stomataws,1,39,0.04,0.7,0.83,0.93,0.8,0.01,3,upperT,lowerT);</div>
<div class="line">      <span class="comment">/* not the right thing to do here to add these values at the end of the ET function</span></div>
<div class="line"><span class="comment">but just a simple fix for now*/</span></div>
<div class="line">      TempIdiff = Temp + tmp6.Deltat;</div>
<div class="line">      AssIdiff = <a class="code" href="e_c4photo_8c.html#ac3eddd9862ded6e65643aea0cb9406c8">eC4photoC</a>(IDiff,TempIdiff,rh,Ca,Oa,Vcmax,</div>
<div class="line">                          Vpmax,Vpr,Jmax);</div>
<div class="line"></div>
<div class="line">     CanopyA += Leafsun * AssIdir + Leafshade * AssIdiff;</div>
<div class="line">   }</div>
<div class="line">  <span class="comment">/* These are micro mols of CO2 per m2 per sec</span></div>
<div class="line"><span class="comment">    Need to convert to </span></div>
<div class="line"><span class="comment">    3600 converts seconds to hours</span></div>
<div class="line"><span class="comment">    10^-6 converts micro mols to mols</span></div>
<div class="line"><span class="comment">    */</span></div>
<div class="line">  REAL(growth)[0] = cf * CanopyA ;</div>
<div class="line">  UNPROTECT(1);  </div>
<div class="line">  <span class="keywordflow">return</span>(growth);</div>
<div class="line"></div>
<div class="line">   }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a8006074d888610622a3eb6cfcb111955"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP McMCEc4photo </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>oASSIM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>oQP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>oTEMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>oRelH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>NITER</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>iCA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>iOA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>iVCMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>iVPMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>iJMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>THRESH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SCALE</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L500">500</a> of file <a class="el" href="">eC4photo.c</a>.</p>
<div class="fragment"><div class="line">                                                       {</div>
<div class="line">  <span class="comment">/* First manipulate R objects */</span></div>
<div class="line">  <span class="keywordtype">int</span> niter;</div>
<div class="line">  <a class="code" href="e_c4photo_8c.html#a44f34a427107babc7cd2db474942ee24">enObs</a> = length(oASSIM);</div>
<div class="line">  niter = INTEGER(NITER)[0];</div>
<div class="line"></div>
<div class="line">  <span class="comment">/* Second define the needed variables */</span></div>
<div class="line">  <span class="keywordtype">double</span> oldRsq = 0.5;</div>
<div class="line">  <span class="keywordtype">int</span> n1 = 0;</div>
<div class="line">  <span class="keywordtype">int</span> n2 = 0;</div>
<div class="line">  <span class="keywordtype">int</span> n3 = 0;</div>
<div class="line">  <span class="keywordtype">int</span> iters = 0;</div>
<div class="line">  <span class="keywordtype">int</span> i, k;</div>
<div class="line">  <span class="keywordtype">double</span> crit = 1 ;</div>
<div class="line">  <span class="keywordtype">double</span> thresh = REAL(THRESH)[0];</div>
<div class="line">  <span class="keywordtype">double</span> scale = REAL(SCALE)[0];</div>
<div class="line">  <span class="keywordtype">double</span> sd1, sd2, sd3;</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">double</span> index;</div>
<div class="line">  <span class="keywordtype">double</span> rlnum , rlden;</div>
<div class="line">  <span class="keywordtype">double</span> ratio;</div>
<div class="line">  <span class="keywordtype">double</span> U;</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">double</span> Rsq;</div>
<div class="line">  <span class="keywordtype">double</span> poldRsq;</div>
<div class="line">  <span class="keywordtype">double</span> Ca, Oa;</div>
<div class="line">  <span class="keywordtype">double</span>  poldVcmax, poldVpmax, poldVpr, poldJmax;</div>
<div class="line">  <span class="keywordtype">double</span> rnewVcmax, rnewVpmax, rnewVpr, rnewJmax;</div>
<div class="line">  <span class="keywordtype">double</span>  oldVcmax, oldVpmax, oldVpr, oldJmax;</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">double</span> assim[<a class="code" href="e_c4photo_8c.html#a44f34a427107babc7cd2db474942ee24">enObs</a>], qp[<a class="code" href="e_c4photo_8c.html#a44f34a427107babc7cd2db474942ee24">enObs</a>];</div>
<div class="line">  <span class="keywordtype">double</span>  temp[<a class="code" href="e_c4photo_8c.html#a44f34a427107babc7cd2db474942ee24">enObs</a>], rh[<a class="code" href="e_c4photo_8c.html#a44f34a427107babc7cd2db474942ee24">enObs</a>];</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span>(k = 0; k &lt; <a class="code" href="e_c4photo_8c.html#a44f34a427107babc7cd2db474942ee24">enObs</a>; k++){</div>
<div class="line">     assim[k] = REAL(oASSIM)[k];</div>
<div class="line">     qp[k] = REAL(oQP)[k];</div>
<div class="line">     temp[k] = REAL(oTEMP)[k];</div>
<div class="line">     rh[k] = REAL(oRelH)[k];</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  SEXP lists;</div>
<div class="line">  SEXP names;</div>
<div class="line"></div>
<div class="line">  SEXP mat1;</div>
<div class="line">  SEXP mat2;</div>
<div class="line"></div>
<div class="line">  SEXP accept1;</div>
<div class="line">  SEXP accept2;</div>
<div class="line">  SEXP accept3;</div>
<div class="line"></div>
<div class="line">  SEXP RsqBI;</div>
<div class="line">  SEXP CoefBI;</div>
<div class="line"></div>
<div class="line">  PROTECT(lists = allocVector(VECSXP,7));</div>
<div class="line">  PROTECT(names = allocVector(STRSXP,7));</div>
<div class="line"></div>
<div class="line">  PROTECT(mat1 = allocMatrix(REALSXP,4,niter));</div>
<div class="line">  PROTECT(mat2 = allocMatrix(REALSXP,4,niter));</div>
<div class="line"></div>
<div class="line">  PROTECT(accept1 = allocVector(REALSXP,1));</div>
<div class="line">  PROTECT(accept2 = allocVector(REALSXP,1));</div>
<div class="line">  PROTECT(accept3 = allocVector(REALSXP,1));</div>
<div class="line"></div>
<div class="line">  PROTECT(RsqBI = allocVector(REALSXP,1));</div>
<div class="line">  PROTECT(CoefBI = allocVector(REALSXP,3));</div>
<div class="line"></div>
<div class="line">  GetRNGstate();</div>
<div class="line"></div>
<div class="line">  Ca = REAL(iCA)[0];</div>
<div class="line">  Oa = REAL(iOA)[0];</div>
<div class="line">  oldVcmax = REAL(iVCMAX)[0];</div>
<div class="line">  oldVpmax = REAL(iVPMAX)[0];</div>
<div class="line">  oldVpr   = 80;</div>
<div class="line">  <span class="comment">/* Vpr is not optimized */</span></div>
<div class="line">  oldJmax = REAL(iJMAX)[0];</div>
<div class="line">  sd1 = 0.05 * oldVcmax * scale;</div>
<div class="line">  sd2 = 0.05 * oldVpmax * scale;</div>
<div class="line">  sd3 = 0.05 * oldJmax * scale;</div>
<div class="line"> </div>
<div class="line">   <span class="keywordflow">while</span>((iters &lt; niter) &amp;&amp; (crit &gt; thresh)){ </div>
<div class="line">     iters++;</div>
<div class="line">     <span class="comment">/* Replacing the rnormCV */</span></div>
<div class="line">     index = floor(runif(1,4)); </div>
<div class="line"></div>
<div class="line">       rnewVcmax = oldVcmax;</div>
<div class="line">       rnewVpmax = oldVpmax;</div>
<div class="line">       rnewVpr = oldVpr;</div>
<div class="line">       rnewJmax = oldJmax;</div>
<div class="line"></div>
<div class="line">     <span class="keywordflow">if</span>(index == 1){ </div>
<div class="line">       rnewVcmax = oldVcmax + rnorm(0,sd1);</div>
<div class="line">     }</div>
<div class="line">     <span class="keywordflow">if</span>(index == 2){ </div>
<div class="line">       rnewVpmax = oldVpmax  + rnorm(0,sd2);</div>
<div class="line">     }</div>
<div class="line">     <span class="comment">/*     if(index == 3){ </span></div>
<div class="line"><span class="comment">       rnewVpr = oldVpr + rnorm(0,0.8);</span></div>
<div class="line"><span class="comment">       } */</span> </div>
<div class="line">     <span class="keywordflow">if</span>(index == 3){ </div>
<div class="line">       rnewJmax = oldJmax + rnorm(0,sd3);</div>
<div class="line">     }  </div>
<div class="line"></div>
<div class="line">     <span class="comment">/* Finish of the rnormCV function */</span></div>
<div class="line">      Rsq = <a class="code" href="e_c4photo_8c.html#a4f766a8f283c0736da0ab400ace4abba">RsqeC4photo</a>(assim,qp,temp,rh,Ca,Oa,</div>
<div class="line">                       rnewVcmax,rnewVpmax,rnewVpr,</div>
<div class="line">                       rnewJmax);</div>
<div class="line"></div>
<div class="line">      <span class="keywordflow">if</span>(Rsq &gt; oldRsq){</div>
<div class="line">        oldRsq = Rsq;</div>
<div class="line">        oldVcmax = rnewVcmax;</div>
<div class="line">        oldVpmax = rnewVpmax;</div>
<div class="line">        oldVpr = rnewVpr;</div>
<div class="line">        oldJmax = rnewJmax;</div>
<div class="line">        REAL(mat1)[n1*4] = oldVcmax;</div>
<div class="line">        REAL(mat1)[1 + n1*4] = oldVpmax;</div>
<div class="line">        <span class="comment">/*      REAL(mat1)[2 + n1*5] = oldVpr;*/</span></div>
<div class="line">        REAL(mat1)[2 + n1*4] = oldJmax;</div>
<div class="line">        REAL(mat1)[3 + n1*4] = oldRsq;</div>
<div class="line">        crit = (1 - Rsq)/Rsq;</div>
<div class="line">        n1++;</div>
<div class="line">      }</div>
<div class="line">     }</div>
<div class="line"></div>
<div class="line">    poldRsq = oldRsq;</div>
<div class="line">    poldVcmax = oldVcmax;</div>
<div class="line">    poldVpmax = oldVpmax;</div>
<div class="line">    poldVpr = oldVpr;</div>
<div class="line">    poldJmax = oldJmax;</div>
<div class="line"></div>
<div class="line">    <span class="keywordflow">for</span>(i = 0; i &lt; niter; i++){</div>
<div class="line"></div>
<div class="line">      <span class="comment">/* Replacing the rnormC4 function */</span></div>
<div class="line">     index = floor(runif(1,4)); </div>
<div class="line"></div>
<div class="line">       rnewVcmax = oldVcmax;</div>
<div class="line">       rnewVpmax = oldVpmax;</div>
<div class="line">       rnewVpr = oldVpr;</div>
<div class="line">       rnewJmax = oldJmax;</div>
<div class="line"></div>
<div class="line">     <span class="keywordflow">if</span>(index == 1){ </div>
<div class="line">       rnewVcmax = oldVcmax + rnorm(0,sd1);</div>
<div class="line">     }</div>
<div class="line">     <span class="keywordflow">if</span>(index == 2){ </div>
<div class="line">       rnewVpmax = oldVpmax  + rnorm(0,sd2);</div>
<div class="line">     }</div>
<div class="line">     <span class="comment">/*     if(index == 3){ </span></div>
<div class="line"><span class="comment">       rnewVpr = oldVpr + rnorm(0,0.8);</span></div>
<div class="line"><span class="comment">     }  */</span></div>
<div class="line">     <span class="keywordflow">if</span>(index == 3){ </div>
<div class="line">       rnewJmax = oldJmax + rnorm(0,sd3);</div>
<div class="line">     }  </div>
<div class="line">      <span class="comment">/* This is the end of the random generation */</span></div>
<div class="line"></div>
<div class="line">      Rsq = <a class="code" href="e_c4photo_8c.html#a4f766a8f283c0736da0ab400ace4abba">RsqeC4photo</a>(assim,qp,temp,rh,Ca,Oa,</div>
<div class="line">                       rnewVcmax,rnewVpmax,rnewVpr,</div>
<div class="line">                       rnewJmax);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(Rsq &gt; poldRsq){</div>
<div class="line">          <span class="comment">/* This time I&#39;m suming to avoid overflow */</span></div>
<div class="line">          <span class="comment">/* So I&#39;ve taken the log */</span></div>
<div class="line">          rlnum = dnorm(rnewVcmax,oldVcmax,sd1,0) +</div>
<div class="line">                  dnorm(rnewVpmax,oldVpmax,sd2,0) +</div>
<div class="line">            <span class="comment">/*          dnorm(rnewVpr,oldVpr,1.2,0) +*/</span></div>
<div class="line">                  dnorm(rnewJmax,oldJmax,sd3,0);</div>
<div class="line"></div>
<div class="line">          rlden = dnorm(oldVcmax,oldVcmax,sd1,0) +</div>
<div class="line">                  dnorm(oldVpmax,oldVpmax,sd2,0) +</div>
<div class="line">            <span class="comment">/*            dnorm(oldVpr,oldVpr,1.2,0) +*/</span></div>
<div class="line">                  dnorm(oldJmax,oldJmax,sd3,0);</div>
<div class="line">          </div>
<div class="line">          <span class="comment">/* This is in the log scale */</span></div>
<div class="line">          ratio = (rlnum - rlden);</div>
<div class="line"></div>
<div class="line">          U = runif(0,1);</div>
<div class="line">          <span class="keywordflow">if</span>(ratio &gt; log(U)){</div>
<div class="line">            oldVcmax = rnewVcmax;</div>
<div class="line">            oldVpmax = rnewVpmax;</div>
<div class="line">            oldVpr = rnewVpr;</div>
<div class="line">            oldJmax = rnewJmax;</div>
<div class="line">            n3++;</div>
<div class="line">          }</div>
<div class="line">          REAL(mat2)[n2*4] = rnewVcmax;</div>
<div class="line">          REAL(mat2)[n2*4 + 1] = rnewVpmax;</div>
<div class="line">          <span class="comment">/*      REAL(mat2)[n2*4 + 2] = rnewVpr; */</span></div>
<div class="line">          REAL(mat2)[n2*4 + 2] = rnewJmax;</div>
<div class="line">          REAL(mat2)[n2*4 + 3] = Rsq;</div>
<div class="line">          n2++;</div>
<div class="line">        }</div>
<div class="line">     </div>
<div class="line">    }</div>
<div class="line"></div>
<div class="line">    REAL(accept1)[0] = n1;</div>
<div class="line">    REAL(accept2)[0] = n2;</div>
<div class="line">    REAL(accept3)[0] = n3;</div>
<div class="line">    REAL(RsqBI)[0] = poldRsq;</div>
<div class="line">    REAL(CoefBI)[0] = poldVcmax;</div>
<div class="line">    REAL(CoefBI)[1] = poldVpmax;</div>
<div class="line">    <span class="comment">/*    REAL(CoefBI)[2] = poldVpr;*/</span></div>
<div class="line">    REAL(CoefBI)[2] = poldJmax;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">    SET_VECTOR_ELT(lists,0,RsqBI);</div>
<div class="line">    SET_VECTOR_ELT(lists,1,CoefBI);</div>
<div class="line">    SET_VECTOR_ELT(lists,2,accept1);</div>
<div class="line">    SET_VECTOR_ELT(lists,3,mat1);</div>
<div class="line">    SET_VECTOR_ELT(lists,4,mat2);</div>
<div class="line">    SET_VECTOR_ELT(lists,5,accept2);</div>
<div class="line">    SET_VECTOR_ELT(lists,6,accept3);</div>
<div class="line"></div>
<div class="line">    SET_STRING_ELT(names,0,mkChar(<span class="stringliteral">&quot;RsqBI&quot;</span>));</div>
<div class="line">    SET_STRING_ELT(names,1,mkChar(<span class="stringliteral">&quot;CoefBI&quot;</span>));</div>
<div class="line">    SET_STRING_ELT(names,2,mkChar(<span class="stringliteral">&quot;accept1&quot;</span>));</div>
<div class="line">    SET_STRING_ELT(names,3,mkChar(<span class="stringliteral">&quot;resuBI&quot;</span>));</div>
<div class="line">    SET_STRING_ELT(names,4,mkChar(<span class="stringliteral">&quot;resuMC&quot;</span>));</div>
<div class="line">    SET_STRING_ELT(names,5,mkChar(<span class="stringliteral">&quot;accept2&quot;</span>));</div>
<div class="line">    SET_STRING_ELT(names,6,mkChar(<span class="stringliteral">&quot;accept3&quot;</span>));</div>
<div class="line">    setAttrib(lists,R_NamesSymbol,names);</div>
<div class="line">    UNPROTECT(9);</div>
<div class="line">    PutRNGstate();</div>
<div class="line">    <span class="keywordflow">return</span>(lists);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a4f766a8f283c0736da0ab400ace4abba"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double RsqeC4photo </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>oAssim</em>[enObs], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>oQp</em>[enObs], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>oTemp</em>[enObs], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>oRH</em>[enObs], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Ca</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Oa</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Vcmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Vpmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Vpr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Jmax</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L728">728</a> of file <a class="el" href="">eC4photo.c</a>.</p>
<div class="fragment"><div class="line">                                                         {</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">double</span> vec1[<a class="code" href="e_c4photo_8c.html#a44f34a427107babc7cd2db474942ee24">enObs</a>];</div>
<div class="line">  <span class="keywordtype">int</span> i, j;</div>
<div class="line">  <span class="keywordtype">double</span> SST = 0.0, SSE = 0.0, diff;</div>
<div class="line">  <span class="keywordtype">double</span> Rsquare = 0.0;</div>
<div class="line"></div>
<div class="line">  <span class="keywordflow">for</span>(i = 0;i &lt; <a class="code" href="e_c4photo_8c.html#a44f34a427107babc7cd2db474942ee24">enObs</a>; i++){</div>
<div class="line"></div>
<div class="line">    vec1[i] = <a class="code" href="e_c4photo_8c.html#ac3eddd9862ded6e65643aea0cb9406c8">eC4photoC</a>(oQp[i],oTemp[i],</div>
<div class="line">                       oRH[i],COa,O2a,Vcmax,Vpmax,</div>
<div class="line">                       Vpr,Jmax);</div>
<div class="line">  }</div>
<div class="line">   </div>
<div class="line">  <span class="keywordflow">for</span>(j = 0 ; j &lt; <a class="code" href="e_c4photo_8c.html#a44f34a427107babc7cd2db474942ee24">enObs</a>; j++){</div>
<div class="line">    SST += pow(oAssim[j],2);</div>
<div class="line">    diff = oAssim[j] - vec1[j];</div>
<div class="line">    SSE += pow(diff,2);</div>
<div class="line">  }</div>
<div class="line"></div>
<div class="line">  Rsquare = (SST - SSE)/SST ; </div>
<div class="line">  <span class="keywordflow">return</span>(Rsquare);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<h2>Variable Documentation</h2>
<a class="anchor" id="a44f34a427107babc7cd2db474942ee24"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int enObs</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L13">13</a> of file <a class="el" href="">eC4photo.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="e_c4photo_8c.html">eC4photo.c</a></li>
    <li class="footer">Generated on Wed Jan 22 2014 09:27:26 for BioCro by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.1.2 </li>
  </ul>
</div>
</body>
</html>
