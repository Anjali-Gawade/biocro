<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>BioCro: src/AuxcaneGro.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BioCro
   &#160;<span id="projectnumber">0.92</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_auxcane_gro_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">AuxcaneGro.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;R.h&gt;</code><br/>
<code>#include &lt;Rmath.h&gt;</code><br/>
<code>#include &lt;Rinternals.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="">AuxBioCro.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">AuxcaneGro.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">c4photo.h</a>&quot;</code><br/>
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for AuxcaneGro.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="_auxcane_gro_8c__incl.png" border="0" usemap="#src_2_auxcane_gro_8c" alt=""/></div>
<map name="src_2_auxcane_gro_8c" id="src_2_auxcane_gro_8c">
<area shape="rect" id="node9" href="_aux_bio_cro_8h.html" title="AuxBioCro.h" alt="" coords="283,83,379,112"/><area shape="rect" id="node11" href="_auxcane_gro_8h.html" title="AuxcaneGro.h" alt="" coords="403,83,507,112"/><area shape="rect" id="node13" href="c4photo_8h.html" title="c4photo.h" alt="" coords="531,83,608,112"/></map>
</div>
</div>
<p><a href="">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a342605e37f67a349f272daa3f2be0739"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structsoil_m_l__str.html">soilML_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_auxcane_gro_8c.html#a342605e37f67a349f272daa3f2be0739">soilML_rootfront</a> (double precipit, double transp, double *cws, double soildepth, double *depths, double fieldc, double wiltp, double phi1, double phi2, struct <a class="el" href="structsoil_text__str.html">soilText_str</a> soTexS, int wsFun, int layers, double rootDB, double LAI, double k, double AirTemp, double IRad, double winds, double RelH, int hydrDist, double rfl, double rsec, double rsdf, int optiontocalculaterootdepth, double rootfrontvelocity, double dap)</td></tr>
<tr class="memitem:ad0cee1190847413e2ecb82e96f6b71c6"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="structdbp__sugarcane__str.html">dbp_sugarcane_str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_auxcane_gro_8c.html#ad0cee1190847413e2ecb82e96f6b71c6">SUGARCANE_DBP_CUADRA</a> (double TT, double TT0, double TTseed, double Tmaturity, double Rd, double Alm, double Arm, double Clstem, double Ilstem, double Cestem, double Iestem, double Clsuc, double Ilsuc, double Cesuc, double Iesuc, double Temperature)</td></tr>
<tr class="memitem:ad761e63b259cb267cff0d44f686ef513"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_auxcane_gro_8c.html#ad761e63b259cb267cff0d44f686ef513">GrowthRespiration</a> (double CanopyA, double fraction)</td></tr>
<tr class="memitem:a5fd25059bc26f2c7be4d785b6978bccd"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_auxcane_gro_8c.html#a5fd25059bc26f2c7be4d785b6978bccd">MRespiration</a> (double W, double Q, double m, double T, double deltime)</td></tr>
<tr class="memitem:a29197dc7c796929a4c9c6d1e758a630c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_auxcane_gro_8c.html#a29197dc7c796929a4c9c6d1e758a630c">seasonal</a> (double maxLN, double minLN, double day, double daymaxLN, double dayinyear, double lat)</td></tr>
</table>
<h2>Function Documentation</h2>
<a class="anchor" id="ad761e63b259cb267cff0d44f686ef513"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double GrowthRespiration </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>CanopyA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fraction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L334">334</a> of file <a class="el" href="">AuxcaneGro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        CanopyA=CanopyA*(1.0-fraction);</div>
<div class="line">        <span class="keywordflow">return</span>(CanopyA);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5fd25059bc26f2c7be4d785b6978bccd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double MRespiration </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>W</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>T</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>deltime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L342">342</a> of file <a class="el" href="">AuxcaneGro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">double</span> result,ttemp;</div>
<div class="line">        <span class="comment">/* change m from per day basis to per hr basis for deltime=1 hr */</span></div>
<div class="line">        m=m*deltime/24;  </div>
<div class="line">        ttemp=(T-25.0)/10.0;</div>
<div class="line">        result=W*m*pow(Q,ttemp);</div>
<div class="line">        <span class="keywordflow">return</span>(result);</div>
<div class="line">                }</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a29197dc7c796929a4c9c6d1e758a630c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double seasonal </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>maxLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>minLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>day</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>daymaxLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dayinyear</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L353">353</a> of file <a class="el" href="">AuxcaneGro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        </div>
<div class="line">        <span class="keywordtype">double</span> temp,leafN;  <span class="comment">// temporary variable to calculate cyclic variation</span></div>
<div class="line">              </div>
<div class="line">         temp = sin (2*3.1415*((day-(daymaxLN))/(dayinyear)+0.25));</div>
<div class="line">         leafN=(maxLN+minLN)*0.5+(maxLN-minLN)*temp*0.5;  </div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span> (leafN);</div>
<div class="line">                 </div>
<div class="line"> } </div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a342605e37f67a349f272daa3f2be0739"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structsoil_m_l__str.html">soilML_str</a> soilML_rootfront </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>precipit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>transp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>cws</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>soildepth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double *&#160;</td>
          <td class="paramname"><em>depths</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>fieldc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>wiltp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phi1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>phi2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structsoil_text__str.html">soilText_str</a>&#160;</td>
          <td class="paramname"><em>soTexS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>wsFun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>layers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rootDB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>AirTemp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>IRad</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>winds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RelH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hydrDist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rfl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rsec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rsdf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>optiontocalculaterootdepth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>rootfrontvelocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L24">24</a> of file <a class="el" href="">AuxcaneGro.c</a>.</p>
<div class="fragment"><div class="line">                                                                                                                                                                                                                                                                                                                                                                                                                                                 {</div>
<div class="line"></div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structrd__str.html">rd_str</a> <a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structseq_r_d__str.html">seqRD_str</a> <a class="code" href="_aux_bio_cro_8h.html#a15219c620f8cdf6d8cf731e485e2c668">tmp3</a>;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structsoil_m_l__str.html">soilML_str</a> tmp;</div>
<div class="line">        <span class="comment">/* Constant */</span></div>
<div class="line">        <span class="comment">/* const double G = 6.67428e-11;  m3 / (kg * s-2)  ##  http://en.wikipedia.org/wiki/Gravitational_constant */</span></div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> g = 9.8; <span class="comment">/* m / s-2  ##  http://en.wikipedia.org/wiki/Standard_gravity */</span></div>
<div class="line">        <span class="comment">/* Variables */</span></div>
<div class="line">        <span class="keywordtype">double</span> waterIn, oldWaterIn = 0.0;</div>
<div class="line"><span class="comment">/* Here is a convention aw is available water in volume and awc</span></div>
<div class="line"><span class="comment">   is available water content as a fraction of the soil section being investigated.</span></div>
<div class="line"><span class="comment">   paw is plant available water aw - wiltp */</span></div>
<div class="line">        <span class="keywordtype">double</span> aw, paw, awc, awc2, Newpawha;</div>
<div class="line">        <span class="keywordtype">double</span> <a class="code" href="structsoil_m_l__str.html#a6b156f63a9c5f2185dcb004e85518998">drainage</a> = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> wsPhoto = 0.0, wsSpleaf = 0.0, phi10;</div>
<div class="line">        <span class="keywordtype">double</span> wsPhotoCol = 0.0, wsSpleafCol = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> slp = 0.0, intcpt = 0.0, theta = 0.0; </div>
<div class="line">        <span class="keywordtype">double</span> <a class="code" href="structsoil_m_l__str.html#a26953bee326ec08f079e24838fc8feb6">Nleach</a> = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> layerDepth;</div>
<div class="line">        <span class="keywordtype">double</span> diffw;</div>
<div class="line">        <span class="keywordtype">double</span> rootATdepth, rootDepth;</div>
<div class="line">        <span class="keywordtype">double</span> EvapoTra = 0.0, oldEvapoTra = 0.0, Sevap = 0.0, Ctransp = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> psim1 = 0.0, psim2 = 0.0, K_psim = 0.0, J_w = 0.0, dPsim = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> theta_s; <span class="comment">/* This is the saturated soil water content. Larger than FieldC.*/</span></div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <span class="keywordtype">int</span> j = layers - 1; </div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Specify the soil type */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(fieldc &lt; 0){</div>
<div class="line">                fieldc = soTexS.<a class="code" href="structsoil_text__str.html#aa1f62c6a0dfe9f9d7abfd52a756209bf">fieldc</a>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span>(wiltp &lt; 0){</div>
<div class="line">                wiltp = soTexS.<a class="code" href="structsoil_text__str.html#a6ee087ca614bcf981839ca4e28953fb2">wiltp</a>;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        theta_s = soTexS.<a class="code" href="structsoil_text__str.html#ac769b10536dd94d3652ad1cbf8d58482">satur</a>;</div>
<div class="line">        <span class="comment">/* rooting depth */</span></div>
<div class="line">        <span class="comment">/* Crude empirical relationship between root biomass and rooting depth*/</span></div>
<div class="line">                   <span class="keywordflow">if</span> (optiontocalculaterootdepth==1) {</div>
<div class="line">                                            rootDepth = rootDB * rsdf;</div>
<div class="line">                                           }</div>
<div class="line"></div>
<div class="line">                                      <span class="keywordflow">else</span> {</div>
<div class="line">                                              rootDepth = rootfrontvelocity*dap*0.01;<span class="comment">// to convert root depth from cm to meter</span></div>
<div class="line">                                           }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(rootDepth &gt; soildepth) rootDepth = soildepth;</div>
<div class="line"></div>
<div class="line">        <a class="code" href="_aux_bio_cro_8h.html#a15219c620f8cdf6d8cf731e485e2c668">tmp3</a> = <a class="code" href="_aux_bio_cro_8c.html#a668682ce55f6888ab3ec44a7d7a48d07">seqRootDepth</a>(rootDepth,layers);</div>
<div class="line">        <a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a> = <a class="code" href="_aux_bio_cro_8c.html#a76d97071934ef506589d0ca8114d3647">rootDist</a>(layers,rootDepth,&amp;depths[0],rfl);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* unit conversion for precip */</span></div>
<div class="line">        waterIn = precipit * 1e-3; <span class="comment">/* convert precip in mm to m*/</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span>(j=0,i=layers-1;j&lt;layers;j++,i--){</div>
<div class="line">        <span class="comment">/* for(i=0;i&lt;layers;i++){ */</span></div>
<div class="line">                <span class="comment">/* It decreases because I increase the water content due to precipitation in the last layer first*/</span></div>
<div class="line"></div>
<div class="line">                <span class="comment">/* This supports unequal depths. */</span></div>
<div class="line">                <span class="keywordflow">if</span>(i == 0){</div>
<div class="line">                        layerDepth = depths[1];</div>
<div class="line">                }<span class="keywordflow">else</span>{</div>
<div class="line">                        layerDepth = depths[i] - depths[i-1];</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(hydrDist &gt; 0){</div>
<div class="line">                        <span class="comment">/* For this section see Campbell and Norman &quot;Environmental BioPhysics&quot; Chapter 9*/</span></div>
<div class="line">                        <span class="comment">/* First compute the matric potential */</span></div>
<div class="line">                        psim1 = soTexS.<a class="code" href="structsoil_text__str.html#accd3edb0af25e0499d5ffbfacc2af59c">air_entry</a> * pow((<a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i]/theta_s),-soTexS.<a class="code" href="structsoil_text__str.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>) ; <span class="comment">/* This is matric potential of current layer */</span></div>
<div class="line">                        <span class="keywordflow">if</span>(i &gt; 0){</div>
<div class="line">                                psim2 = soTexS.<a class="code" href="structsoil_text__str.html#accd3edb0af25e0499d5ffbfacc2af59c">air_entry</a> * pow((<a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i-1]/theta_s),-soTexS.<a class="code" href="structsoil_text__str.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>) ; <span class="comment">/* This is matric potential of next layer */</span></div>
<div class="line">                                dPsim = psim1 - psim2;</div>
<div class="line">                                <span class="comment">/* The substraction is from the layer i - (i-1). If this last term is positive then it will move upwards. If it is negative it will move downwards. Presumably this term is almost always positive. */</span></div>
<div class="line">                        }<span class="keywordflow">else</span>{</div>
<div class="line">                                dPsim = 0;</div>
<div class="line">                        }</div>
<div class="line">                        K_psim = soTexS.<a class="code" href="structsoil_text__str.html#aa9437b51e97937d66bd2c90f9a411652">Ks</a> * pow((soTexS.<a class="code" href="structsoil_text__str.html#accd3edb0af25e0499d5ffbfacc2af59c">air_entry</a>/psim1),2+3/soTexS.<a class="code" href="structsoil_text__str.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>); <span class="comment">/* This is hydraulic conductivity */</span></div>
<div class="line">                        J_w = K_psim * (dPsim/layerDepth) - g * K_psim ; <span class="comment">/*  Campbell, pg 129 do not ignore the graviational effect*/</span></div>
<div class="line">                        <span class="comment">/* Notice that K_psim is positive because my</span></div>
<div class="line"><span class="comment">                            reference system is reversed */</span></div>
<div class="line">                        <span class="comment">/* This last result should be in kg/(m2 * s)*/</span></div>
<div class="line">                         J_w *= 3600 * 0.9882 * 1e-3 ; <span class="comment">/* This is flow in m3 / (m^2 * hr). */</span></div>
<div class="line">                        <span class="comment">/* Rprintf(&quot;J_w %.10f \n&quot;,J_w);  */</span></div>
<div class="line">                        <span class="keywordflow">if</span>(i == (layers-1) &amp;&amp; J_w &lt; 0){</div>
<div class="line">                                        <span class="comment">/* cws[i] = cws[i] + J_w /</span></div>
<div class="line"><span class="comment">                                         * layerDepth; Although this</span></div>
<div class="line"><span class="comment">                                         * should be done it drains</span></div>
<div class="line"><span class="comment">                                         * the last layer too much.*/</span></div>
<div class="line">                                        drainage += J_w;</div>
<div class="line">                        }<span class="keywordflow">else</span>{</div>
<div class="line">                                <span class="keywordflow">if</span>(i &gt; 0){</div>
<div class="line">                                        <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] = <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] -  J_w / layerDepth;</div>
<div class="line">                                        <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i - 1] =  <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i-1] +  J_w / layerDepth;</div>
<div class="line">                                }<span class="keywordflow">else</span>{</div>
<div class="line">                                        <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] = <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] -  J_w / layerDepth;</div>
<div class="line">                                }</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                 <span class="keywordflow">if</span>(<a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] &gt; fieldc) <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] = fieldc; </div>
<div class="line">                <span class="comment">/* if(cws[i+1] &gt; fieldc) cws[i+1] = fieldc; */</span></div>
<div class="line">                 <span class="keywordflow">if</span>(<a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] &lt; wiltp) <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] = wiltp; </div>
<div class="line">                <span class="comment">/* if(cws[i+1] &lt; wiltp) cws[i+1] = wiltp;  */</span></div>
<div class="line"></div>
<div class="line">                aw = <a class="code" href="structsoil_m_l__str.html#a9da7a4e25e646b0be31ac3bbec73f60d">cws</a>[i] * layerDepth;</div>
<div class="line"><span class="comment">/* Available water (for this layer) is the current water status times the layer depth */</span></div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(waterIn &gt; 0){</div>
<div class="line">                        <span class="comment">/* There is some rain. Need to add it.*/</span></div>
<div class="line">                        aw += waterIn / layers + oldWaterIn; <span class="comment">/* They are both in meters so it works */</span></div>
<div class="line">                        <span class="comment">/* Adding the same amount to water to each layer */</span></div>
<div class="line">                        <span class="comment">/* In case there is overflow */</span></div>
<div class="line">                        diffw = fieldc * layerDepth - aw;</div>
<div class="line"></div>
<div class="line">                        <span class="keywordflow">if</span>(diffw &lt; 0){</div>
<div class="line">                                <span class="comment">/* This means that precipitation exceeded the capacity of the first layer */</span></div>
<div class="line">                                <span class="comment">/* Save this amount of water for the next layer */</span></div>
<div class="line">                                oldWaterIn = -diffw;</div>
<div class="line">                                aw = fieldc * layerDepth;</div>
<div class="line">                        }<span class="keywordflow">else</span>{</div>
<div class="line">                                oldWaterIn = 0.0;</div>
<div class="line">                        }</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Root Biomass */</span></div>
<div class="line">                rootATdepth = rootDB * <a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>.rootDist[i];</div>
<div class="line">                tmp.rootDist[i] = rootATdepth;</div>
<div class="line"><span class="comment">/* Plant available water is only between current water status and permanent wilting point */</span></div>
<div class="line">                <span class="comment">/* Plant available water */</span></div>
<div class="line">                paw = aw - wiltp * layerDepth;</div>
<div class="line">                <span class="keywordflow">if</span>(paw &lt; 0) paw = 0; </div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(i == 0){</div>
<div class="line">                        <span class="comment">/* Only the first layer is affected by soil evaporation */</span></div>
<div class="line">                        awc2 = aw / layerDepth;</div>
<div class="line">                        <span class="comment">/* SoilEvapo function needs soil water content  */</span></div>
<div class="line">                        Sevap = <a class="code" href="_aux_bio_cro_8c.html#ac96acf762dd39d5ff20d71788b0ca566">SoilEvapo</a>(LAI,k,AirTemp,IRad,awc2,fieldc,wiltp,winds,RelH,rsec);</div>
<div class="line">                        <span class="comment">/* I assume that crop transpiration is distributed simlarly to</span></div>
<div class="line"><span class="comment">                           root density.  In other words the crop takes up water proportionally</span></div>
<div class="line"><span class="comment">                           to the amount of root in each respective layer.*/</span></div>
<div class="line">                        Ctransp = transp*<a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>.rootDist[0];</div>
<div class="line">                        EvapoTra = Ctransp + Sevap;</div>
<div class="line">                        Newpawha = (paw * 1e4) - EvapoTra / 0.9982; <span class="comment">/* See the watstr function for this last number 0.9882 */</span></div>
<div class="line">                        <span class="comment">/* The first term in the rhs (paw * 1e4) is the m3 of water available in this layer.</span></div>
<div class="line"><span class="comment">                           EvapoTra is the Mg H2O ha-1 of transpired and evaporated water. 1/0.9882 converts from Mg to m3 */</span></div>
<div class="line">                }<span class="keywordflow">else</span>{</div>
<div class="line">                        Ctransp = transp*<a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>.rootDist[i];</div>
<div class="line">                        EvapoTra = Ctransp;</div>
<div class="line">                        Newpawha = (paw * 1e4) - (EvapoTra + oldEvapoTra);</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(Newpawha &lt; 0){</div>
<div class="line"><span class="comment">/* If the Demand is not satisfied by this layer. This will be stored and added to subsequent layers*/</span></div>
<div class="line">                        oldEvapoTra = -Newpawha;</div>
<div class="line">                         aw = wiltp * layerDepth; </div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                paw = Newpawha / 1e4 ;</div>
<div class="line">                awc = paw / layerDepth + wiltp;   </div>
<div class="line"></div>
<div class="line"><span class="comment">/* This might look like a weird place to populate the structure, but is more convenient*/</span></div>
<div class="line">                tmp.cws[i] = awc;</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(wsFun == 0){</div>
<div class="line">                        slp = 1/(fieldc - wiltp);</div>
<div class="line">                        intcpt = 1 - fieldc * slp;</div>
<div class="line">                        wsPhoto = slp * awc + intcpt ;</div>
<div class="line">                }<span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">if</span>(wsFun == 1){</div>
<div class="line">                        phi10 = (fieldc + wiltp)/2;</div>
<div class="line">                        wsPhoto = 1/(1 + exp((phi10 - awc)/ phi1));</div>
<div class="line">                }<span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">if</span>(wsFun == 2){</div>
<div class="line">                        slp = (1 - wiltp)/(fieldc - wiltp);</div>
<div class="line">                        intcpt = 1 - fieldc * slp;</div>
<div class="line">                        theta = slp * awc + intcpt ;</div>
<div class="line">                        wsPhoto = (1 - exp(-2.5 * (theta - wiltp)/(1 - wiltp))) / (1 - exp(-2.5));</div>
<div class="line">                }<span class="keywordflow">else</span></div>
<div class="line">                <span class="keywordflow">if</span>(wsFun == 3){</div>
<div class="line">                        wsPhoto = 1;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(wsPhoto &lt;= 0 )</div>
<div class="line">                        wsPhoto = 1e-20; <span class="comment">/* This can be mathematically lower than zero in some cases but I should prevent that. */</span></div>
<div class="line"></div>
<div class="line">                wsPhotoCol += wsPhoto;</div>
<div class="line"></div>
<div class="line">                wsSpleaf = pow(awc,phi2)/pow(fieldc,phi2); </div>
<div class="line">                <span class="keywordflow">if</span>(wsFun == 3){ </div>
<div class="line">                        wsSpleaf = 1;</div>
<div class="line">                }</div>
<div class="line">                wsSpleafCol += wsSpleaf;</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">if</span>(waterIn &gt; 0){ </div>
<div class="line">                drainage = waterIn;</div>
<div class="line">                <span class="comment">/* Need to convert to units used in the Parton et al 1988 paper. */</span></div>
<div class="line">                <span class="comment">/* The data comes in mm/hr and it needs to be in cm/month */</span></div>
<div class="line">                Nleach = drainage * 0.1 * (1/24*30) / (18 * (0.2 + 0.7 * soTexS.<a class="code" href="structsoil_text__str.html#a4fcef85764276271df64bd49ff7667fb">sand</a>));</div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"><span class="comment">/* returning the structure */</span></div>
<div class="line">        tmp.rcoefPhoto = (wsPhotoCol/layers);</div>
<div class="line">        tmp.drainage = <a class="code" href="structsoil_m_l__str.html#a6b156f63a9c5f2185dcb004e85518998">drainage</a>;</div>
<div class="line">        tmp.Nleach = <a class="code" href="structsoil_m_l__str.html#a26953bee326ec08f079e24838fc8feb6">Nleach</a>;</div>
<div class="line">        tmp.rcoefSpleaf = (wsSpleafCol/layers);</div>
<div class="line">        tmp.SoilEvapo = Sevap;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span>(tmp);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ad0cee1190847413e2ecb82e96f6b71c6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="structdbp__sugarcane__str.html">dbp_sugarcane_str</a> SUGARCANE_DBP_CUADRA </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>TT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>TT0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>TTseed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Tmaturity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Alm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Arm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Clstem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Ilstem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Cestem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Iestem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Clsuc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Ilsuc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Cesuc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Iesuc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temperature</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L240">240</a> of file <a class="el" href="">AuxcaneGro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structdbp__sugarcane__str.html">dbp_sugarcane_str</a> dbp;</div>
<div class="line">        <span class="keywordtype">double</span> F1, F2, F3, F4;</div>
<div class="line">        <span class="keywordtype">double</span> Aa,Astem,Al,Ar,Asuc,Astuc,Afib;</div>
<div class="line">        <span class="keywordtype">double</span> RM;</div>
<div class="line">        <span class="keywordtype">double</span> cutemp1,cutemp2,RM0;</div>
<div class="line">        </div>
<div class="line"><span class="comment">/* Germination Phase */</span></div>
<div class="line">        </div>
<div class="line">        <span class="keywordflow">if</span>(TT &lt; TT0)</div>
<div class="line">        {</div>
<div class="line">                </div>
<div class="line">                dbp.<a class="code" href="structdbp__sugarcane__str.html#ac99cccaa39474eb44da7927824bf1590">kLeaf</a>=0.001;</div>
<div class="line">                dbp.kStem=0.7;</div>
<div class="line">                dbp.kRoot=0.299;</div>
<div class="line">                dbp.kSeedcane=(-1)*0.693*(0.0053*Temperature-0.0893);</div>
<div class="line">                dbp.kSugar=0.0;</div>
<div class="line">                dbp.kFiber=0.0;</div>
<div class="line">                <span class="keywordflow">return</span>(dbp);            </div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        </div>
<div class="line"></div>
<div class="line">        dbp.kSeedcane=0;</div>
<div class="line">        <span class="comment">/* Calculate Relative Maturity and correct it for germination phase* */</span></div>
<div class="line">        <span class="comment">/* Now reference thermal time has changed from 0 to TT0 */</span></div>
<div class="line">        RM=(TT-TT0)*100.0/Tmaturity;</div>
<div class="line"><span class="comment">/*      RM0=TT0*100.0/Tmaturity;</span></div>
<div class="line"><span class="comment">        RM=RM-RM0;   */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Criteria for linear increase in stem biomass*/</span></div>
<div class="line">        F1=RM*Clstem-Ilstem*Clstem;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/*Criteria for log increase in stem biomass */</span></div>
<div class="line">        F2=1-exp((RM*Cestem)-(Iestem*Cestem));</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Fraction of aerial biomass */</span></div>
<div class="line">        cutemp1=(1-exp((-1)*Rd*RM));</div>
<div class="line">        Aa=(1.0-Arm)*((cutemp1&lt;1.0) ? cutemp1 :1.0);</div>
<div class="line"></div>
<div class="line">        <span class="comment">/*Fraction of stem biomass */</span></div>
<div class="line">        cutemp1=(1.0-Alm-Arm);</div>
<div class="line">        <span class="keywordflow">if</span> ((F1&lt;=0)&amp;&amp;(F2&lt;=0))</div>
<div class="line">        {</div>
<div class="line">                cutemp2=0.0;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">                cutemp2=Aa*((F1&gt;F2)?F1:F2);</div>
<div class="line">        }</div>
<div class="line">        Astem = (cutemp2&lt;cutemp1)?cutemp2:cutemp1;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Fraction of leaf biomass */</span></div>
<div class="line">        Al=Aa-Astem;</div>
<div class="line">        <span class="comment">/* Fraction of root biomass */</span></div>
<div class="line">        Ar=1-Aa;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Partiitoning of stem between structural and sugar component */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Criteria for linear increase */</span></div>
<div class="line">        F3=RM*Clsuc-Ilsuc*Clsuc;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/*Criteria for log increase */</span></div>
<div class="line">        F4=1-exp((RM*Cesuc)-(Iesuc*Cesuc));</div>
<div class="line">  </div>
<div class="line">       <span class="comment">/*fraction of sucrose with respective to total stem allocation */</span> </div>
<div class="line">        cutemp2=0;</div>
<div class="line">        <span class="keywordflow">if</span> ((F3&lt;=0)&amp;&amp;(F4&lt;=0))</div>
<div class="line">        {</div>
<div class="line">                cutemp2=0;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">        {</div>
<div class="line">                cutemp2=Astem*((F3&gt;F4)?F3:F4);</div>
<div class="line">        }</div>
<div class="line">        Asuc=cutemp2;</div>
<div class="line">        Afib=Astem-Asuc;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/*fraction of structural component of stem */</span></div>
<div class="line">        Astuc=Astem-Asuc;</div>
<div class="line"></div>
<div class="line">                dbp.kLeaf=Al;</div>
<div class="line">                dbp.kStem=Astem;</div>
<div class="line">                dbp.kRoot=Ar;</div>
<div class="line">                dbp.kSugar=Asuc;</div>
<div class="line">                dbp.kFiber=Astuc;</div>
<div class="line"><span class="comment">//              dbp.kSeedcane=-0.00005; </span></div>
<div class="line">        <span class="keywordflow">return</span>(dbp);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="_auxcane_gro_8c.html">AuxcaneGro.c</a></li>
    <li class="footer">Generated on Wed Jan 22 2014 09:27:25 for BioCro by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.1.2 </li>
  </ul>
</div>
</body>
</html>
