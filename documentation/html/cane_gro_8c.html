<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>BioCro: src/caneGro.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BioCro
   &#160;<span id="projectnumber">0.92</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('cane_gro_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">caneGro.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;R.h&gt;</code><br/>
<code>#include &lt;math.h&gt;</code><br/>
<code>#include &lt;Rmath.h&gt;</code><br/>
<code>#include &lt;Rinternals.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="">AuxBioCro.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">Century.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">BioCro.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">AuxcaneGro.h</a>&quot;</code><br/>
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for caneGro.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="cane_gro_8c__incl.png" border="0" usemap="#src_2cane_gro_8c" alt=""/></div>
<map name="src_2cane_gro_8c" id="src_2cane_gro_8c">
<area shape="rect" id="node11" href="_aux_bio_cro_8h.html" title="AuxBioCro.h" alt="" coords="368,83,464,112"/><area shape="rect" id="node13" href="_century_8h.html" title="Century.h" alt="" coords="488,83,565,112"/><area shape="rect" id="node15" href="_bio_cro_8h.html" title="BioCro.h" alt="" coords="589,83,661,112"/><area shape="rect" id="node17" href="_auxcane_gro_8h.html" title="AuxcaneGro.h" alt="" coords="685,83,789,112"/></map>
</div>
</div>
<p><a href="">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a769df64c6a88e961ec89814e5000b537"><td class="memItemLeft" align="right" valign="top">SEXP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="cane_gro_8c.html#a769df64c6a88e961ec89814e5000b537">caneGro</a> (SEXP LAT, SEXP DOY, SEXP HR, SEXP SOLAR, SEXP TEMP, SEXP RH, SEXP WINDSPEED, SEXP PRECIP, SEXP KD, SEXP CHILHF, SEXP NLAYERS, SEXP RHIZOME, SEXP IRTL, SEXP SENCOEFS, SEXP TIMESTEP, SEXP VECSIZE, SEXP SPLEAF, SEXP SPD, SEXP DBPCOEFS, SEXP THERMALP, SEXP VMAX, SEXP ALPHA, SEXP KPARM, SEXP THETA, SEXP BETA, SEXP RD, SEXP CATM, SEXP B0, SEXP B1, SEXP WS, SEXP SOILCOEFS, SEXP ILEAFN, SEXP KLN, SEXP VMAXB1, SEXP ALPHAB1, SEXP MRESP, SEXP SOILTYPE, SEXP WSFUN, SEXP CENTCOEFS, SEXP CENTTIMESTEP, SEXP CENTKS, SEXP SOILLAYERS, SEXP SOILDEPTHS, SEXP CWS, SEXP HYDRDIST, SEXP SECS, SEXP KPLN, SEXP LNB0, SEXP LNB1, SEXP LNFUN, SEXP SUGARCOEFS, SEXP UPPERTEMP, SEXP LOWERTEMP, SEXP MAXLN, SEXP MINLN, SEXP DAYMAXLN, SEXP LEAFTURNOVER, SEXP ROOTTURNOVER, SEXP LEAFREMOBILIZE, SEXP OPTIONTOCALCULATEROOTDEPTH, SEXP ROOTFRONTVELOCITY, SEXP NNITROP, SEXP IRRIG, SEXP FROSTP)</td></tr>
</table>
<h2>Function Documentation</h2>
<a class="anchor" id="a769df64c6a88e961ec89814e5000b537"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">SEXP caneGro </td>
          <td>(</td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>DOY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>HR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SOLAR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>TEMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>WINDSPEED</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>PRECIP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>KD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CHILHF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>NLAYERS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>RHIZOME</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>IRTL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SENCOEFS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>TIMESTEP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>VECSIZE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SPLEAF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SPD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>DBPCOEFS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>THERMALP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>VMAX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>ALPHA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>KPARM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>THETA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>BETA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>RD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CATM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>B0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>B1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>WS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SOILCOEFS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>ILEAFN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>KLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>VMAXB1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>ALPHAB1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>MRESP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SOILTYPE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>WSFUN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CENTCOEFS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CENTTIMESTEP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CENTKS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SOILLAYERS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SOILDEPTHS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>CWS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>HYDRDIST</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SECS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>KPLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LNB0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LNB1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LNFUN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>SUGARCOEFS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>UPPERTEMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LOWERTEMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>MAXLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>MINLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>DAYMAXLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LEAFTURNOVER</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>ROOTTURNOVER</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>LEAFREMOBILIZE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>OPTIONTOCALCULATEROOTDEPTH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>ROOTFRONTVELOCITY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>NNITROP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>IRRIG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">SEXP&#160;</td>
          <td class="paramname"><em>FROSTP</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">SUGARCOEFS</td><td><hr/>
 </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="#L28">28</a> of file <a class="el" href="">caneGro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">int</span> vecsize = INTEGER(VECSIZE)[0];</div>
<div class="line">        </div>
<div class="line">        <span class="keywordtype">double</span> *newLeafcol=malloc(vecsize*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line">                                  <span class="keywordflow">if</span>(newLeafcol==NULL)</div>
<div class="line">                                  { </div>
<div class="line">                                    Rprintf(<span class="stringliteral">&quot;Out of Memory for newLeafcol\n&quot;</span>);</div>
<div class="line">                                    exit;</div>
<div class="line">                                  }</div>
<div class="line">        <span class="keywordtype">double</span> *newStemcol=malloc(vecsize*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line">                                  <span class="keywordflow">if</span>(newStemcol==NULL)</div>
<div class="line">                                  { </div>
<div class="line">                                    Rprintf(<span class="stringliteral">&quot;Out of Memory for newStemcol\n&quot;</span>);</div>
<div class="line">                                    exit;</div>
<div class="line">                                  }</div>
<div class="line">        <span class="keywordtype">double</span> *newRootcol=malloc(vecsize*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line">                                  <span class="keywordflow">if</span>(newRootcol==NULL)</div>
<div class="line">                                  { </div>
<div class="line">                                    Rprintf(<span class="stringliteral">&quot;Out of Memory for newRootcol\n&quot;</span>);</div>
<div class="line">                                    exit;</div>
<div class="line">                                  }</div>
<div class="line">        <span class="keywordtype">double</span> *newRhizomecol=malloc(vecsize*<span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line">                                  <span class="keywordflow">if</span>(newRhizomecol==NULL)</div>
<div class="line">                                  { </div>
<div class="line">                                    Rprintf(<span class="stringliteral">&quot;Out of Memory for newRhizomecol\n&quot;</span>);</div>
<div class="line">                                    exit;</div>
<div class="line">                                  }</div>
<div class="line"></div>
<div class="line">                                  <span class="keywordtype">double</span> upperT=REAL(UPPERTEMP)[0];</div>
<div class="line">                                  <span class="keywordtype">double</span> lowerT=REAL(LOWERTEMP)[0];                              </div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structnitro_parms.html">nitroParms</a> nitroparms;</div>
<div class="line">        <span class="keywordtype">double</span> TEMPdoubletoint;</div>
<div class="line">        nitroparms.<a class="code" href="structnitro_parms.html#a81548389d7bb414fbf85c27cc1df21ad">ileafN</a>=REAL(NNITROP)[0];</div>
<div class="line">        nitroparms.kln=REAL(NNITROP)[1];</div>
<div class="line">        nitroparms.Vmaxb1=REAL(NNITROP)[2];</div>
<div class="line">        nitroparms.Vmaxb0=REAL(NNITROP)[3];</div>
<div class="line">        nitroparms.alphab1=REAL(NNITROP)[4];</div>
<div class="line">        nitroparms.alphab0=REAL(NNITROP)[5];</div>
<div class="line">        nitroparms.Rdb1=REAL(NNITROP)[6];</div>
<div class="line">        nitroparms.Rdb0=REAL(NNITROP)[7];</div>
<div class="line">        nitroparms.kpLN=REAL(NNITROP)[8];</div>
<div class="line">        nitroparms.lnb0=REAL(NNITROP)[9];</div>
<div class="line">        nitroparms.lnb1=REAL(NNITROP)[10];</div>
<div class="line">        TEMPdoubletoint=REAL(NNITROP)[11];</div>
<div class="line">        nitroparms.lnFun=(int)TEMPdoubletoint;</div>
<div class="line">        nitroparms.maxln=REAL(NNITROP)[12];</div>
<div class="line">        nitroparms.minln=REAL(NNITROP)[13];</div>
<div class="line">        nitroparms.daymaxln=REAL(NNITROP)[14];</div>
<div class="line"></div>
<div class="line">  <span class="keyword">struct </span><a class="code" href="structfrost_parms.html">frostParms</a> frostparms;</div>
<div class="line">  frostparms.<a class="code" href="structfrost_parms.html#ac6561f3ade0d5d8062369c736983abe6">leafT0</a>=REAL(FROSTP)[0];</div>
<div class="line">  frostparms.leafT100=REAL(FROSTP)[1];</div>
<div class="line">  frostparms.stemT0=REAL(FROSTP)[2];</div>
<div class="line">  frostparms.stemT100=REAL(FROSTP)[3];</div>
<div class="line">  <span class="keywordtype">double</span> leaffrostdamage;</div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line"></div>
<div class="line">        <span class="comment">/* This creates vectors which will collect the senesced plant</span></div>
<div class="line"><span class="comment">           material. This is needed to calculate litter and therefore carbon</span></div>
<div class="line"><span class="comment">           in the soil and then N in the soil. */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> iSp, Sp , propLeaf;</div>
<div class="line">        <span class="keywordtype">int</span> i, i2, i3;</div>
<div class="line">        <span class="keywordtype">int</span> dailyvecsize;</div>
<div class="line">        <span class="keywordtype">double</span> rootfrontvelocity=REAL(ROOTFRONTVELOCITY)[0];</div>
<div class="line">        <span class="keywordtype">int</span> optiontocalculaterootdepth = INTEGER(OPTIONTOCALCULATEROOTDEPTH)[0];</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> vmax1;</div>
<div class="line">        <span class="keywordtype">double</span> alpha1;</div>
<div class="line">        <span class="keywordtype">double</span> kparm1;</div>
<div class="line">        <span class="keywordtype">double</span> theta;</div>
<div class="line">        <span class="keywordtype">double</span> beta;</div>
<div class="line">        <span class="keywordtype">double</span> Rd1, Ca;</div>
<div class="line">        <span class="keywordtype">double</span> b01, b11;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> Leaf, Stem, Root, LAI, Grain = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> TTc = 0.0,TT12c=0.0;</div>
<div class="line">        <span class="keywordtype">double</span> kLeaf = 0.0, kStem = 0.0, kRoot = 0.0, kSeedcane = 0.0, kGrain = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> newLeaf, newStem = 0.0, newRoot, newRhizome, newGrain = 0.0;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Variables needed for collecting litter */</span></div>
<div class="line">        <span class="keywordtype">double</span> LeafLitter_d = 0.0, StemLitter_d = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> RootLitter_d = 0.0, RhizomeLitter_d = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> ALitter = 0.0, BLitter = 0.0;</div>
<div class="line">        <span class="comment">/* Maintenance respiration */</span></div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> mrc1 = REAL(MRESP)[0];</div>
<div class="line">        <span class="keywordtype">double</span> mrc2 = REAL(MRESP)[1]; </div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> waterCont;</div>
<div class="line">        <span class="keywordtype">double</span> StomWS = 1, LeafWS = 1,SugarStress=1,deepak_temp;</div>
<div class="line">        <span class="keywordtype">int</span> timestep;</div>
<div class="line">        <span class="keywordtype">double</span> CanopyA, CanopyT;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> Rhizome;</div>
<div class="line">        <span class="keywordtype">double</span> Sugar,newSugar,SeneSeedcane;</div>
<div class="line">        <span class="keywordtype">double</span> laimax;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Soil Parameters*/</span></div>
<div class="line">        <span class="keywordtype">double</span> FieldC, WiltP, phi1, phi2, soilDepth;</div>
<div class="line">        <span class="keywordtype">int</span> soilType, wsFun;</div>
<div class="line">        <span class="keywordtype">double</span> LeafNmax = REAL(MAXLN)[0]; <span class="comment">/* max N conc of top leaf in mmol/m2*/</span></div>
<div class="line">        <span class="keywordtype">double</span> LeafNmin = REAL(MINLN)[0];  <span class="comment">/* min N conc of top leaf in mmol/m2 */</span></div>
<div class="line">        <span class="keywordtype">double</span> dayofMaxLeafN = REAL(DAYMAXLN)[0]; <span class="comment">/* day when maxm leaf N occuers */</span></div>
<div class="line">        <span class="keywordtype">double</span> LeafN, kLN,currentday;</div>
<div class="line">        <span class="keywordtype">double</span> soilEvap, TotEvap;</div>
<div class="line">        <span class="keywordtype">int</span> soillayers = INTEGER(SOILLAYERS)[0];</div>
<div class="line">        <span class="keywordtype">double</span> cwsVec[soillayers];</div>
<div class="line">        <span class="keywordflow">for</span>(i2=0;i2&lt;soillayers;i2++){</div>
<div class="line">                cwsVec[i2] = REAL(CWS)[i2];</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordtype">double</span> cwsVecSum = 0.0;</div>
<div class="line">        <span class="comment">/* Some soil related empirical coefficients */</span></div>
<div class="line">        <span class="keywordtype">double</span> rfl = REAL(SECS)[0];  <span class="comment">/* root factor lambda */</span></div>
<div class="line">        <span class="keywordtype">double</span> rsec = REAL(SECS)[1]; <span class="comment">/* radiation soil evaporation coefficient */</span></div>
<div class="line">        <span class="keywordtype">double</span> rsdf = REAL(SECS)[2]; <span class="comment">/* root soil depth factor */</span></div>
<div class="line">        <span class="keywordtype">double</span> scsf = REAL(SOILCOEFS)[6]; <span class="comment">/* stomatal conductance sensitivity factor */</span> <span class="comment">/* Rprintf(&quot;scsf %.2f&quot;,scsf); */</span></div>
<div class="line">        <span class="keywordtype">double</span> transpRes = REAL(SOILCOEFS)[7]; <span class="comment">/* Resistance to transpiration from soil to leaf */</span></div>
<div class="line">        <span class="keywordtype">double</span> leafPotTh = REAL(SOILCOEFS)[8]; <span class="comment">/* Leaf water potential threshold */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Parameters for calculating leaf water potential */</span></div>
<div class="line">        <span class="keywordtype">double</span> LeafPsim = 0.0;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Effect of Nitrogen */</span></div>
<div class="line">        <span class="keywordtype">double</span> kpLN = REAL(KPLN)[0];</div>
<div class="line">        <span class="keywordtype">double</span> lnb0 = REAL(LNB0)[0]; </div>
<div class="line">        <span class="keywordtype">double</span> lnb1 = REAL(LNB1)[0];</div>
<div class="line">        <span class="keywordtype">int</span> lnfun = INTEGER(LNFUN)[0];</div>
<div class="line">        <span class="keywordtype">double</span> leafrate = REAL(LEAFTURNOVER)[0];</div>
<div class="line">        <span class="keywordtype">double</span> rootrate = REAL(ROOTTURNOVER)[0];</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Variables for Respiration Calculations. I am currently using hard coded values. I shall write a function that can takes these values as input. I have used optim function and data from Liu to get these values. */</span></div>
<div class="line">        <span class="keywordtype">double</span> gRespCoeff=0.15;<span class="comment">/*This is constant fraction to calculate Growth respiration from DSSAT*/</span></div>
<div class="line">        <span class="keywordtype">double</span> Qleaf=1.58, Qstem=1.80, Qroot=1.80; <span class="comment">/* Q factors for Temp dependence on Maintenance Respiration*/</span></div>
<div class="line">        <span class="keywordtype">double</span> mRespleaf=0.012,mRespstem=0.004,mResproot=0.0088;</div>
<div class="line">        <span class="keywordtype">double</span> mResp;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> SeneLeaf, SeneStem, SeneRoot = 0.0, SeneRhizome = 0.0 ;</div>
<div class="line">        <span class="keywordtype">double</span> *sti , *sti2, *sti3, *sti4; </div>
<div class="line">        <span class="keywordtype">double</span> Remob;</div>
<div class="line">        <span class="keywordtype">int</span> k = 0, q = 0, m = 0, n = 0;</div>
<div class="line">        <span class="keywordtype">int</span> ri = 0;</div>
<div class="line"></div>
<div class="line"><span class="comment">/* all of these parameters are for Cuadra biomass partitioning */</span></div>
<div class="line">        <span class="keywordtype">double</span> TT0 = REAL(SUGARCOEFS)[0]; </div>
<div class="line">        <span class="keywordtype">double</span>  TTseed = REAL(SUGARCOEFS)[1]; </div>
<div class="line">        <span class="keywordtype">double</span> Tmaturity = REAL(SUGARCOEFS)[2]; </div>
<div class="line">        <span class="keywordtype">double</span> Rd = REAL(SUGARCOEFS)[3]; </div>
<div class="line">        <span class="keywordtype">double</span> Alm = REAL(SUGARCOEFS)[4]; </div>
<div class="line">        <span class="keywordtype">double</span> Arm = REAL(SUGARCOEFS)[5]; </div>
<div class="line">        <span class="keywordtype">double</span> Clstem = REAL(SUGARCOEFS)[6]; </div>
<div class="line">        <span class="keywordtype">double</span> Ilstem = REAL(SUGARCOEFS)[7]; </div>
<div class="line">        <span class="keywordtype">double</span> Cestem = REAL(SUGARCOEFS)[8]; </div>
<div class="line">        <span class="keywordtype">double</span> Iestem = REAL(SUGARCOEFS)[9]; </div>
<div class="line">        <span class="keywordtype">double</span> Clsuc = REAL(SUGARCOEFS)[10]; </div>
<div class="line">        <span class="keywordtype">double</span> Ilsuc = REAL(SUGARCOEFS)[11]; </div>
<div class="line">        <span class="keywordtype">double</span> Cesuc = REAL(SUGARCOEFS)[12]; </div>
<div class="line">        <span class="keywordtype">double</span> Iesuc = REAL(SUGARCOEFS)[13]; </div>
<div class="line"><span class="comment">/* variable declaration for cuadra biomass partitionign ends here */</span></div>
<div class="line">        </div>
<div class="line"></div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="struct_can___str.html">Can_Str</a> Canopy, CanopyRd;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structws__str.html">ws_str</a> WaterS;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structdbp__sugarcane__str.html">dbp_sugarcane_str</a> dbpS;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structcen_t__str.html">cenT_str</a> centS; </div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structsoil_m_l__str.html">soilML_str</a> soilMLS;</div>
<div class="line">        <span class="keyword">struct </span><a class="code" href="structsoil_text__str.html">soilText_str</a> soTexS; <span class="comment">/* , *soTexSp = &amp;soTexS; */</span></div>
<div class="line">        soTexS = <a class="code" href="_aux_bio_cro_8c.html#a72f93049960e067cda6e7291ff1ff21a">soilTchoose</a>(INTEGER(SOILTYPE)[0]);</div>
<div class="line"></div>
<div class="line">        centS.SCs[0] = 0.0;</div>
<div class="line">        centS.SCs[1] = 0.0;</div>
<div class="line">        centS.SCs[2] = 0.0;</div>
<div class="line">        centS.SCs[3] = 0.0;</div>
<div class="line">        centS.SCs[4] = 0.0;</div>
<div class="line">        centS.SCs[5] = 0.0;</div>
<div class="line">        centS.SCs[6] = 0.0;</div>
<div class="line">        centS.SCs[7] = 0.0;</div>
<div class="line">        centS.SCs[8] = 0.0;</div>
<div class="line"></div>
<div class="line">        SEXP lists, names;</div>
<div class="line"></div>
<div class="line">        SEXP DayofYear;</div>
<div class="line">        SEXP Hour;</div>
<div class="line">        SEXP <a class="code" href="_bio_cro_8h.html#a5b6e16664a459420103984ac5409b858">CanopyAssim</a>;</div>
<div class="line">        SEXP CanopyTrans;</div>
<div class="line">        SEXP <a class="code" href="_bio_cro_8h.html#abd2c9bad12951c887e8469151c778947">Leafy</a>;</div>
<div class="line">        SEXP <a class="code" href="_bio_cro_8h.html#a929d2badff7fb301509012ee6e6a12e9">Stemy</a>;</div>
<div class="line">        SEXP <a class="code" href="_bio_cro_8h.html#ad6a54d6e671d04cd9b254a8cd1c3315c">Rooty</a>;</div>
<div class="line">        SEXP Sugary;</div>
<div class="line">        SEXP Fibery;</div>
<div class="line">        SEXP Seedcaney;</div>
<div class="line">        SEXP <a class="code" href="_bio_cro_8h.html#ac656f07a64aeba7d6ac5a3a536e993c8">LAIc</a>;</div>
<div class="line">        SEXP TTTc;</div>
<div class="line">        SEXP SoilWatCont;</div>
<div class="line">        SEXP StomatalCondCoefs;</div>
<div class="line">        SEXP LeafReductionCoefs;</div>
<div class="line">        SEXP LeafNitrogen;</div>
<div class="line">        SEXP AboveLitter;</div>
<div class="line">        SEXP BelowLitter;</div>
<div class="line">        SEXP VmaxVec;</div>
<div class="line">        SEXP AlphaVec;</div>
<div class="line">        SEXP SpVec;</div>
<div class="line">        SEXP SoilEvaporation;</div>
<div class="line">        SEXP cwsMat;</div>
<div class="line">        SEXP psimMat; <span class="comment">/* Holds the soil water potential */</span></div>
<div class="line">        SEXP rdMat;</div>
<div class="line">        SEXP LeafPsimVec;</div>
<div class="line">        SEXP LeafLittervec;</div>
<div class="line">        SEXP StemLittervec;</div>
<div class="line">        SEXP RootLittervec;</div>
<div class="line">        SEXP Leafmaintenance;</div>
<div class="line">        SEXP Stemmaintenance;</div>
<div class="line">        SEXP Rootmaintenance;</div>
<div class="line">        SEXP Seedcanemaintenance;</div>
<div class="line">        SEXP kkleaf;</div>
<div class="line">        SEXP kkroot;</div>
<div class="line">        SEXP kkstem;</div>
<div class="line">        SEXP kkseedcane;</div>
<div class="line">        SEXP kkfiber;</div>
<div class="line">        SEXP kksugar;</div>
<div class="line">        SEXP dailyThermalT;</div>
<div class="line">        SEXP moisturecontent;</div>
<div class="line">        SEXP dayafterplanting;</div>
<div class="line"></div>
<div class="line">                </div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        vecsize = length(DOY);</div>
<div class="line">        dailyvecsize=(int)(vecsize/24)+1;</div>
<div class="line"></div>
<div class="line">        PROTECT(lists = allocVector(VECSXP,44)); <span class="comment">/* total of 32 variables are to be sent to R */</span></div>
<div class="line">        PROTECT(names = allocVector(STRSXP,44)); <span class="comment">/* name of 32 variables */</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        PROTECT(DayofYear = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">        PROTECT(Hour = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(CanopyAssim = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(CanopyTrans = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(Leafy = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">        PROTECT(Stemy = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">        PROTECT(Rooty = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">        PROTECT(Sugary = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">        PROTECT(Fibery = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">        PROTECT(Seedcaney = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">        PROTECT(LAIc = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">        PROTECT(TTTc = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(SoilWatCont = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(StomatalCondCoefs = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(LeafReductionCoefs = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(LeafNitrogen = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">        PROTECT(AboveLitter = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">        PROTECT(BelowLitter = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">        PROTECT(VmaxVec = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">        PROTECT(AlphaVec = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">        PROTECT(SpVec = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">        PROTECT(SoilEvaporation = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(cwsMat = allocMatrix(REALSXP,soillayers,vecsize));</div>
<div class="line">        PROTECT(psimMat = allocMatrix(REALSXP,soillayers,vecsize));</div>
<div class="line">        PROTECT(rdMat = allocMatrix(REALSXP,soillayers,vecsize));</div>
<div class="line">        PROTECT(LeafPsimVec = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(LeafLittervec = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">        PROTECT(StemLittervec = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">        PROTECT(RootLittervec = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">        PROTECT(Leafmaintenance = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(Stemmaintenance = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(Rootmaintenance = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(Seedcanemaintenance = allocVector(REALSXP,vecsize));</div>
<div class="line">        PROTECT(kkleaf = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">        PROTECT(kkroot = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">        PROTECT(kkstem = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">        PROTECT(kkseedcane = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">        PROTECT(kkfiber = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">        PROTECT(kksugar = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">        PROTECT(dailyThermalT = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">        PROTECT(moisturecontent = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">        PROTECT(dayafterplanting = allocVector(REALSXP,dailyvecsize));</div>
<div class="line">       </div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Picking vmax, alpha and kparm */</span></div>
<div class="line">        vmax1 = REAL(VMAX)[0];</div>
<div class="line">        alpha1 = REAL(ALPHA)[0];</div>
<div class="line">        kparm1 = REAL(KPARM)[0];</div>
<div class="line">        theta = REAL(THETA)[0];</div>
<div class="line">        beta = REAL(BETA)[0];</div>
<div class="line">        Rd1 = REAL(RD)[0];</div>
<div class="line">        Ca = REAL(CATM)[0];</div>
<div class="line">        b01 = REAL(B0)[0];</div>
<div class="line">        b11 = REAL(B1)[0];</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        LeafN = REAL(ILEAFN)[0]; <span class="comment">/* Initial value of N in the leaf */</span></div>
<div class="line">        kLN = REAL(KLN)[0];</div>
<div class="line">        timestep = INTEGER(TIMESTEP)[0];</div>
<div class="line">        Rhizome = REAL(RHIZOME)[0];</div>
<div class="line">        Sp = REAL(SPLEAF)[0]; </div>
<div class="line">        SeneLeaf = REAL(SENCOEFS)[0];</div>
<div class="line">        SeneStem = REAL(SENCOEFS)[1];</div>
<div class="line">        SeneRoot = REAL(SENCOEFS)[2];</div>
<div class="line">        SeneRhizome = REAL(SENCOEFS)[3];</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Soil Parameters */</span></div>
<div class="line">        FieldC = REAL(SOILCOEFS)[0];</div>
<div class="line">        WiltP = REAL(SOILCOEFS)[1];</div>
<div class="line">        phi1 = REAL(SOILCOEFS)[2];</div>
<div class="line">        phi2 = REAL(SOILCOEFS)[3];</div>
<div class="line">        soilDepth = REAL(SOILCOEFS)[4];</div>
<div class="line">        waterCont = REAL(SOILCOEFS)[5];</div>
<div class="line">        wsFun = INTEGER(WSFUN)[0];</div>
<div class="line">        soilType = INTEGER(SOILTYPE)[0];</div>
<div class="line"></div>
<div class="line">        propLeaf = REAL(IRTL)[0]; </div>
<div class="line">        Leaf=Rhizome*propLeaf;</div>
<div class="line">        <span class="comment">/* It is useful to assume that there is a small amount of</span></div>
<div class="line"><span class="comment">           leaf area at the begining of the growing season. */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Initial proportion of the rhizome that is turned</span></div>
<div class="line"><span class="comment">           into leaf the first hour */</span></div>
<div class="line">        Stem = Rhizome * 0.001;</div>
<div class="line">        Root = Rhizome * 0.001;</div>
<div class="line">        LAI = Leaf * Sp;</div>
<div class="line">        iSp = Sp;</div>
<div class="line"></div>
<div class="line"><span class="comment">/* Creating pointers to avoid calling functions REAL and INTEGER so much */</span></div>
<div class="line">        <span class="keywordtype">int</span> *pt_doy = INTEGER(DOY);</div>
<div class="line">        <span class="keywordtype">int</span> *pt_hr = INTEGER(HR);</div>
<div class="line">        <span class="keywordtype">double</span> *pt_solar = REAL(SOLAR);</div>
<div class="line">        <span class="keywordtype">double</span> *pt_temp = REAL(TEMP);</div>
<div class="line">        <span class="keywordtype">double</span> *pt_rh = REAL(RH);</div>
<div class="line">        <span class="keywordtype">double</span> *pt_windspeed = REAL(WINDSPEED);</div>
<div class="line">        <span class="keywordtype">double</span> *pt_precip = REAL(PRECIP);</div>
<div class="line">        <span class="keywordtype">double</span> lat = REAL(LAT)[0];</div>
<div class="line">        <span class="keywordtype">int</span> nlayers = INTEGER(NLAYERS)[0];</div>
<div class="line">        <span class="keywordtype">int</span> ws = INTEGER(WS)[0];</div>
<div class="line">        <span class="keywordtype">double</span> kd = REAL(KD)[0];</div>
<div class="line">        <span class="keywordtype">double</span> chil = REAL(CHILHF)[0];</div>
<div class="line">        <span class="keywordtype">double</span> hf = REAL(CHILHF)[1];</div>
<div class="line">        <span class="keywordtype">double</span> moist,ddap;</div>
<div class="line"></div>
<div class="line">        <span class="comment">/* Creation of pointers outside the loop */</span></div>
<div class="line">        sti = &amp;newLeafcol[0]; <span class="comment">/* This creates sti to be a pointer to the position 0</span></div>
<div class="line"><span class="comment">                                 in the newLeafcol vector */</span></div>
<div class="line">        sti2 = &amp;newStemcol[0];</div>
<div class="line">        sti3 = &amp;newRootcol[0];</div>
<div class="line">        sti4 = &amp;newRhizomecol[0];</div>
<div class="line">        </div>
<div class="line">        <span class="keywordtype">double</span> dailyassim=0.0;</div>
<div class="line">        <span class="keywordtype">double</span> dailytransp=0.0;</div>
<div class="line">        <span class="keywordtype">double</span> dailyLeafResp = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> dailyStemResp = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> dailyRootResp = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> dailyRhizomeResp = 0.0;</div>
<div class="line">        <span class="keywordtype">double</span> LeafResp,StemResp,RootResp,RhizomeResp,Litter;</div>
<div class="line">        <span class="keywordtype">double</span> LAIi;</div>
<div class="line">        <span class="keywordtype">double</span> delTT;</div>
<div class="line">        <span class="keywordtype">double</span> dap;</div>
<div class="line"></div>
<div class="line">        <span class="keywordtype">double</span> rootlitter,deadroot,leaflitter,deadleaf,leafREMOB;</div>
<div class="line">  <span class="keywordtype">double</span> remobilizedleaf;</div>
<div class="line">  <span class="keywordtype">double</span> Remobfactorleaf=0.5;</div>
<div class="line">        <span class="keywordtype">double</span> Fiber,newFiber;</div>
<div class="line">        <span class="keywordtype">double</span> kSugar,kFiber,SeedcaneResp,Seedcane,newSeedcane,dailySeedcaneResp;</div>
<div class="line">        <span class="keywordtype">double</span> LAIold,LAInew;</div>
<div class="line">        leafREMOB=REAL(LEAFREMOBILIZE)[0];</div>
<div class="line">        <span class="keywordtype">int</span> dayi=0; <span class="comment">/* this is idnex for days */</span></div>
<div class="line">            LAIi = Rhizome * propLeaf*Sp;</div>
<div class="line">            LAIold=LAIi; <span class="comment">/* Enter simulation with LAIold variable to track precious LAI to implement water stress */</span></div>
<div class="line">        <span class="keywordflow">for</span>(i=0;i&lt;vecsize;i++)</div>
<div class="line">        {</div>
<div class="line">                <span class="comment">/* First calculate the elapsed Thermal Time*/</span></div>
<div class="line">                <span class="comment">/* The idea is that here I need to divide by the time step</span></div>
<div class="line"><span class="comment">                   to calculate the thermal time. For example, a 3 hour time interval</span></div>
<div class="line"><span class="comment">                   would mean that the division would need to by 8 */</span></div>
<div class="line">                TTc += *(pt_temp+i) / (24/timestep); </div>
<div class="line">                <span class="keywordflow">if</span>((*(pt_temp+i))&lt;12)</div>
<div class="line">                {</div>
<div class="line">                        TT12c = TT12c;</div>
<div class="line">                        delTT=0.0;</div>
<div class="line">                }</div>
<div class="line">     <span class="comment">// Adjusting rain based on irrigation amount</span></div>
<div class="line">    <span class="comment">//   Rprintf(&quot;%f\n&quot;,REAL(IRRIG)[0]);</span></div>
<div class="line">       <span class="keywordflow">if</span> (REAL(IRRIG)[0]&gt;0) {</div>
<div class="line">       TotEvap*=0.01; <span class="comment">//To convert total ET loss from Mg/ha to mm</span></div>
<div class="line">       *(pt_precip+i)+=(TotEvap*REAL(IRRIG)[0]);</div>
<div class="line">      }</div>
<div class="line">     </div>
<div class="line">     </div>
<div class="line">                <span class="keywordflow">if</span>((*(pt_temp+i))&gt;= 12)</div>
<div class="line">                {</div>
<div class="line">                        TT12c = TT12c + (*(pt_temp+i)-12) / (24/timestep);</div>
<div class="line">                        delTT=(*(pt_temp+i)- 12)/24.0;</div>
<div class="line">                }</div>
<div class="line">                </div>
<div class="line"><span class="comment">/* This calculated TTTc based on 0 base Temperature */</span>    </div>
<div class="line"><span class="comment">/*              REAL(TTTc)[i] = TTc;</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">/* Now we are calculating TTc based on 12 base Temperature */</span></div>
<div class="line">                REAL(TTTc)[i]=TT12c;</div>
<div class="line">             </div>
<div class="line">                <span class="comment">/*  Do the magic! Calculate growth*/</span></div>
<div class="line">                Canopy = <a class="code" href="_aux_bio_cro_8c.html#ad67c5b654f4bceb23717a84244291ea0">CanAC</a>(LAI, *(pt_doy+i), *(pt_hr+i),</div>
<div class="line">                               *(pt_solar+i), *(pt_temp+i),</div>
<div class="line">                               *(pt_rh+i), *(pt_windspeed+i),</div>
<div class="line">                               lat, nlayers,</div>
<div class="line">                               vmax1,alpha1,kparm1,</div>
<div class="line">                               theta,beta,Rd1,Ca,b01,b11,StomWS,</div>
<div class="line">                               ws, kd,</div>
<div class="line">                               chil, hf,</div>
<div class="line">                               LeafN, kpLN, lnb0, lnb1, lnfun,upperT,lowerT,nitroparms);</div>
<div class="line"></div>
<div class="line"><span class="comment">/* This is an addition, which was omitted earlier */</span></div>
<div class="line"><span class="comment">/* WIMOVAC suggestsevaluating A grodd = Anet + Rd before proceeding with further calculations */</span></div>
<div class="line"></div>
<div class="line"><span class="comment">/* A better way to evaluate gross canopy assimilation would be to evaluate for individual layer in CanAC functions using leaf temperature. However, this will require changing CanAC functon, which I do not want to distrub for now.</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">                /* Collecting the results */</span></div>
<div class="line"><span class="comment">//              CanopyA = Canopy.Assim * timestep;</span></div>
<div class="line">    CanopyA = Canopy.GrossAssim * timestep;</div>
<div class="line">                CanopyT = Canopy.Trans * timestep;</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* summing up hourly results to obtain daily assimilation */</span></div>
<div class="line">                 dailyassim =  dailyassim + CanopyA;</div>
<div class="line">                 dailytransp = dailytransp + CanopyT;</div>
<div class="line">                 <span class="comment">/* updated value of daily assimilation and transpiration */</span></div>
<div class="line"></div>
<div class="line">                 <span class="comment">/*Evaluate maintenance Respiration of different plant organs */</span></div>
<div class="line">                   LeafResp=<a class="code" href="_auxcane_gro_8c.html#a5fd25059bc26f2c7be4d785b6978bccd">MRespiration</a>(Leaf, Qleaf, mRespleaf, *(pt_temp+i), timestep);</div>
<div class="line">                   REAL(Leafmaintenance)[i]=LeafResp;</div>
<div class="line">                   StemResp=<a class="code" href="_auxcane_gro_8c.html#a5fd25059bc26f2c7be4d785b6978bccd">MRespiration</a>(Stem, Qstem, mRespstem, *(pt_temp+i), timestep);</div>
<div class="line">                   REAL(Stemmaintenance)[i]=StemResp;</div>
<div class="line">                   RootResp=<a class="code" href="_auxcane_gro_8c.html#a5fd25059bc26f2c7be4d785b6978bccd">MRespiration</a>(Root, Qroot, mResproot, *(pt_temp+i), timestep);</div>
<div class="line">                     REAL(Rootmaintenance)[i]=RootResp;</div>
<div class="line">                   SeedcaneResp=<a class="code" href="_auxcane_gro_8c.html#a5fd25059bc26f2c7be4d785b6978bccd">MRespiration</a>(Seedcane, Qstem, mRespstem, *(pt_temp+i), timestep);</div>
<div class="line">                     REAL(Seedcanemaintenance)[i]=SeedcaneResp;</div>
<div class="line"></div>
<div class="line">                   <span class="comment">/*summing up hourly maintenance Respiration to determine daily maintenance respiration of each plant organ */</span></div>
<div class="line">                    dailyLeafResp =  dailyLeafResp + LeafResp;</div>
<div class="line">                    dailyStemResp =  dailyStemResp + StemResp;</div>
<div class="line">                    dailyRootResp =  dailyRootResp + RootResp;</div>
<div class="line">                    dailySeedcaneResp =  dailySeedcaneResp + SeedcaneResp;</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Inserting the multilayer model */</span></div>
<div class="line">                <span class="keywordflow">if</span>(soillayers &gt; 1){</div>
<div class="line">                        dap=(double)dayi; <span class="comment">// converting dayi to double before passing to soilML to avoid rounding error</span></div>
<div class="line">                                soilMLS = <a class="code" href="_aux_bio_cro_8c.html#a5537e2a57efaaf41b401666bb9e22062">soilML</a>(*(pt_precip+i), CanopyT, &amp;cwsVec[0], soilDepth, REAL(SOILDEPTHS), FieldC, WiltP,</div>
<div class="line">                                         phi1, phi2, soTexS, wsFun, INTEGER(SOILLAYERS)[0], Root, </div>
<div class="line">                                         LAI, 0.68, *(pt_temp+i), *(pt_solar), *(pt_windspeed+i), *(pt_rh+i), </div>
<div class="line">                                                           INTEGER(HYDRDIST)[0], rfl, rsec, rsdf);<span class="comment">//,optiontocalculaterootdepth,rootfrontvelocity, dap);</span></div>
<div class="line"></div>
<div class="line"></div>
<div class="line">                        StomWS = soilMLS.rcoefPhoto;</div>
<div class="line">                        LeafWS = soilMLS.rcoefSpleaf;</div>
<div class="line">                        soilEvap = soilMLS.SoilEvapo;</div>
<div class="line">                        <span class="keywordflow">for</span>(i3=0;i3&lt;soillayers;i3++){</div>
<div class="line">                                cwsVec[i3] = soilMLS.cws[i3];</div>
<div class="line">                                cwsVecSum += cwsVec[i3];</div>
<div class="line">                                REAL(cwsMat)[i3 + i*soillayers] = soilMLS.cws[i3];</div>
<div class="line">                                REAL(rdMat)[i3 + i*soillayers] = soilMLS.rootDist[i3];</div>
<div class="line">                        }</div>
<div class="line"></div>
<div class="line">                        waterCont = cwsVecSum / soillayers;</div>
<div class="line">                        cwsVecSum = 0.0;</div>
<div class="line"></div>
<div class="line">                }<span class="keywordflow">else</span>{</div>
<div class="line"></div>
<div class="line">                        soilEvap = <a class="code" href="_aux_bio_cro_8c.html#ac96acf762dd39d5ff20d71788b0ca566">SoilEvapo</a>(LAI, 0.68, *(pt_temp+i), *(pt_solar+i), waterCont, FieldC, WiltP, </div>
<div class="line">                                             *(pt_windspeed+i), *(pt_rh+i), rsec);</div>
<div class="line">                        TotEvap = soilEvap + CanopyT;</div>
<div class="line">                        WaterS = <a class="code" href="_aux_bio_cro_8c.html#a8dfc137af141b612fc3cde9b49b0fc5f">watstr</a>(*(pt_precip+i),TotEvap,waterCont,soilDepth,FieldC,WiltP,phi1,phi2,soilType, wsFun);   </div>
<div class="line">                        waterCont = WaterS.awc;</div>
<div class="line">                        StomWS = WaterS.rcoefPhoto ; </div>
<div class="line">                        LeafWS = WaterS.rcoefSpleaf;</div>
<div class="line">                        REAL(cwsMat)[i] = waterCont;</div>
<div class="line">                        REAL(psimMat)[i] = WaterS.psim;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line"><span class="comment">/* An alternative way of computing water stress is by doing the leaf</span></div>
<div class="line"><span class="comment"> * water potential. This is done if the wsFun is equal to 4 */</span></div>
<div class="line"></div>
<div class="line">                <span class="keywordflow">if</span>(wsFun == 4){</div>
<div class="line">                        <span class="comment">/* Calculating the leaf water potential */</span></div>
<div class="line">                        <span class="comment">/* From Campbell E = (Psim_s - Psim_l)/R or</span></div>
<div class="line"><span class="comment">                         * evaporation is equal to the soil water potential</span></div>
<div class="line"><span class="comment">                         * minus the leaf water potential divided by the resistance.</span></div>
<div class="line"><span class="comment">                         * This can be rearranged to Psim_l = Psim_s - E x R   */</span></div>
<div class="line">                        <span class="comment">/* It is assumed that total resistance is 5e6 m^4 s^-1</span></div>
<div class="line"><span class="comment">                         * kg^-1 </span></div>
<div class="line"><span class="comment">                         * Transpiration is in Mg ha-2 hr-1</span></div>
<div class="line"><span class="comment">                         * Multiply by 1e3 to go from Mg to kg</span></div>
<div class="line"><span class="comment">                         * Multiply by 1e-4 to go from ha to m^2 </span></div>
<div class="line"><span class="comment">                         * This needs to go from hours to seconds that&#39;s</span></div>
<div class="line"><span class="comment">                         * why the conversion factor is (1/3600).*/</span></div>
<div class="line">                        LeafPsim = WaterS.psim - (CanopyT * 1e3 * 1e-4 * 1.0/3600.0) * transpRes;</div>
<div class="line"></div>
<div class="line">                        <span class="comment">/* From WIMOVAVC the proposed equation to simulate the effect of water</span></div>
<div class="line"><span class="comment">                         * stress on stomatal conductance */</span></div>
<div class="line">                        <span class="keywordflow">if</span>(LeafPsim &lt; leafPotTh){</div>
<div class="line">                                <span class="comment">/* StomWS = 1 - ((LeafPsim - leafPotTh)/1000 *</span></div>
<div class="line"><span class="comment">                                 * scsf); In WIMOVAC this equation is used but</span></div>
<div class="line"><span class="comment">                                 * the absolute values are taken from the</span></div>
<div class="line"><span class="comment">                                 * potentials. Since they both should be</span></div>
<div class="line"><span class="comment">                                 * negative and leafPotTh is greater than</span></div>
<div class="line"><span class="comment">                                 * LeafPsim this can be rearranged to*/</span> </div>
<div class="line">                                StomWS = 1 - ((leafPotTh - LeafPsim)/1000 * scsf);</div>
<div class="line">                                <span class="comment">/* StomWS = 1; */</span></div>
<div class="line">                                <span class="keywordflow">if</span>(StomWS &lt; 0.1) StomWS = 0.1;</div>
<div class="line">                        }<span class="keywordflow">else</span>{</div>
<div class="line">                                StomWS = 1;</div>
<div class="line">                        }</div>
<div class="line">                }<span class="keywordflow">else</span>{</div>
<div class="line">                        LeafPsim = 0;</div>
<div class="line">                }</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* Picking the dry biomass partitioning coefficients */</span></div>
<div class="line"><span class="comment">/*              dbpS = sel_dbp_coef(REAL(DBPCOEFS), REAL(THERMALP), TT12c); */</span></div>
<div class="line">                <span class="comment">/*      dbpS=SUGARCANE_DBP(TT12c); */</span></div>
<div class="line">                <span class="comment">/*See Details to check arguments ot CUADRA biomass partitionign function */</span></div>
<div class="line"></div>
<div class="line">                <span class="comment">/* A new day starts here */</span></div>
<div class="line">                <span class="keywordflow">if</span>( (i % 24) ==0) </div>
<div class="line">                {</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* daily loss of assimilated CO2 via growth respiration */</span></div>
<div class="line">                <span class="comment">/* Here I am calling function to calculate Growth Respiration. Currently Using a fraction of 0.242 is lost via growth respiration. This fraction is taken from DSSAT                 4.5 manual for Sugarcane: parameter RespGcf *****/</span></div>
<div class="line">                  dailyassim=<a class="code" href="_auxcane_gro_8c.html#ad761e63b259cb267cff0d44f686ef513">GrowthRespiration</a>(dailyassim, gRespCoeff); <span class="comment">/* Plant growth continues during day and night*/</span></div>
<div class="line"></div>
<div class="line">                <span class="comment">/* daily loss via  maintenance respirations of different plant organs */</span></div>
<div class="line"><span class="comment">/*                dailyassim=dailyassim-dailyLeafResp-dailyStemResp- dailyRootResp- dailyRhizomeResp;  */</span><span class="comment">/* This is available photosynthate available for plant growth */</span></div>
<div class="line"></div>
<div class="line">                  </div>
<div class="line">                <span class="comment">/* call the biomass partitioning function */</span></div>
<div class="line"></div>
<div class="line">                  dbpS = <a class="code" href="_auxcane_gro_8c.html#ad0cee1190847413e2ecb82e96f6b71c6">SUGARCANE_DBP_CUADRA</a>(TT12c,TT0,TTseed,Tmaturity,Rd,Alm,Arm,Clstem,Ilstem,Cestem,Iestem,Clsuc,Ilsuc,Cesuc,Iesuc,*(pt_temp+i));</div>
<div class="line">        </div>
<div class="line">                  </div>
<div class="line">                  <span class="comment">/*         dbpS.kLeaf=0.001;</span></div>
<div class="line"><span class="comment">                   dbpS.kStem=0.7;</span></div>
<div class="line"><span class="comment">                   dbpS.kRoot=0.299;</span></div>
<div class="line"><span class="comment">                   dbpS.kSeedcane=dbpS.kSeedcane;</span></div>
<div class="line"><span class="comment">                   dbpS.kSugar=0;</span></div>
<div class="line"><span class="comment">                   dbpS.kFiber=0;</span></div>
<div class="line"><span class="comment">                  */</span></div>
<div class="line">                          </div>
<div class="line">                   kLeaf = dbpS.kLeaf;</div>
<div class="line">                   kStem = dbpS.kStem;</div>
<div class="line">                   kRoot = dbpS.kRoot;</div>
<div class="line">                   kSeedcane = dbpS.kSeedcane;</div>
<div class="line">                   kSugar = dbpS.kSugar;</div>
<div class="line">                   kFiber=dbpS.kFiber;</div>
<div class="line">                   </div>
<div class="line"></div>
<div class="line">                   REAL(kkleaf)[dayi] = dbpS.kLeaf;</div>
<div class="line">                   REAL(kkstem)[dayi] = dbpS.kStem;</div>
<div class="line">                   REAL(kksugar)[dayi]= dbpS.kSugar;</div>
<div class="line">                   REAL(kkfiber)[dayi]= dbpS.kFiber;</div>
<div class="line">                   REAL(kkroot)[dayi] = dbpS.kRoot;</div>
<div class="line">                   REAL(kkseedcane)[dayi] = dbpS.kSeedcane;</div>
<div class="line">                   REAL(dailyThermalT)[dayi]= TT12c;</div>
<div class="line">                </div>
<div class="line"></div>
<div class="line">                                <span class="keywordflow">if</span>(kLeaf &gt;= 0)</div>
<div class="line">                                {</div>
<div class="line">                                        newLeaf =  dailyassim * kLeaf-dailyLeafResp;</div>
<div class="line">                            *(sti+i) = newLeaf; </div>
<div class="line">                                         </div>
<div class="line">                         }</div>
<div class="line">                                  <span class="keywordflow">else</span></div>
<div class="line">                                  {</div>
<div class="line">                                          warning(<span class="stringliteral">&quot;kleaf is negative&quot;</span>);</div>
<div class="line">          }</div>
<div class="line">                </div>
<div class="line">                </div>
<div class="line">                     <span class="keywordflow">if</span>(TT12c &lt; SeneLeaf)</div>
<div class="line">                                 {</div>
<div class="line">                                   Leaf += newLeaf;</div>
<div class="line">                                   leaflitter=leaflitter+0.0;</div>
<div class="line">                                   REAL(LeafLittervec)[dayi]= leaflitter;</div>
<div class="line">                                 }</div>
<div class="line">                                 <span class="keywordflow">else</span></div>
<div class="line">                                 {</div>
<div class="line">                                 deadleaf=(leafrate*Leaf)/100.0;  <span class="comment">/* biomass of dead leaf */</span></div>
<div class="line">         remobilizedleaf&lt;-deadleaf*Remobfactorleaf;</div>
<div class="line">                                 leaflitter=leaflitter+deadleaf-remobilizedleaf; <span class="comment">/*40% of dead leaf goes to leaf litter */</span></div>
<div class="line">                                 Leaf =Leaf+newLeaf-deadleaf+remobilizedleaf*33;</div>
<div class="line">         Stem=Stem+remobilizedleaf*0.33;</div>
<div class="line">         Root=Root+remobilizedleaf*0.33;</div>
<div class="line">                                 REAL(LeafLittervec)[dayi]= leaflitter; <span class="comment">/* Collecting the leaf litter */</span> </div>
<div class="line">                                 <span class="comment">/*      REAL(LeafLittervec)[dayi]=Litter * 0.4;  */</span> <span class="comment">/* Collecting the leaf litter */</span>       </div>
<div class="line">                                 }</div>
<div class="line">                                  <span class="keywordflow">if</span>(kStem &gt;= 0)</div>
<div class="line">                                  {</div>
<div class="line">                                  newStem =  dailyassim* kStem-dailyStemResp ;</div>
<div class="line">                                        newSugar= dailyassim *kSugar-dailyStemResp*(kSugar/kStem);</div>
<div class="line">                                        newFiber=dailyassim *kFiber-dailyStemResp*(kFiber/kStem);</div>
<div class="line">                                  }</div>
<div class="line">                                  <span class="keywordflow">else</span></div>
<div class="line">                                  {</div>
<div class="line">                                          warning(<span class="stringliteral">&quot;kstem is negative&quot;</span>);</div>
<div class="line">                                  }</div>
<div class="line">                </div>
<div class="line">                                  <span class="keywordflow">if</span>(TT12c &lt; SeneStem)</div>
<div class="line">                                  {</div>
<div class="line">                                   Stem += newStem;</div>
<div class="line">                                   Fiber+=newFiber;</div>
<div class="line">                                   Sugar+=newSugar;</div>
<div class="line">                                  }</div>
<div class="line">                                  <span class="keywordflow">else</span></div>
<div class="line">                                  {</div>
<div class="line">                                       Stem=Stem+newStem;  </div>
<div class="line">                                       Fiber=Fiber+newFiber;</div>
<div class="line">                                       Sugar=Sugar+newSugar;</div>
<div class="line">                                          </div>
<div class="line">                                  }</div>
<div class="line">           <span class="keywordflow">if</span>(kRoot &gt;= 0)</div>
<div class="line">                      {           </div>
<div class="line">                                         newRoot =  dailyassim * kRoot ;</div>
<div class="line">                                         <span class="keywordflow">if</span>(newRoot&gt;=dailyRootResp)</div>
<div class="line">                                          {</div>
<div class="line">                                           newRoot=newRoot-dailyRootResp;</div>
<div class="line">                    *(sti3+i) = newRoot;</div>
<div class="line">                                          }</div>
<div class="line">                                        <span class="keywordflow">else</span></div>
<div class="line">                                        {</div>
<div class="line">                                          newRoot=0.0;</div>
<div class="line">                                          newSugar=newRoot-dailyRootResp; <span class="comment">//Stem growth can not be negative. Set it zero and rest is taken care by sugar</span></div>
<div class="line">                }</div>
<div class="line">                         </div>
<div class="line">                      }</div>
<div class="line">                                 <span class="keywordflow">else</span></div>
<div class="line">                                 {</div>
<div class="line">                                          error(<span class="stringliteral">&quot;kRoot should be positive&quot;</span>);</div>
<div class="line">                                 }</div>
<div class="line"></div>
<div class="line">        </div>
<div class="line">                                 <span class="keywordflow">if</span>(TT12c &lt; SeneRoot)</div>
<div class="line">                                 {</div>
<div class="line">                                   Root += newRoot;</div>
<div class="line">           rootlitter=0.0;</div>
<div class="line">                                   REAL(RootLittervec)[dayi]= rootlitter;</div>
<div class="line">                                  </div>
<div class="line">                                 }</div>
<div class="line">                                 <span class="keywordflow">else</span></div>
<div class="line">                                 {</div>
<div class="line">                                    deadroot=(rootrate*Root)/100.0;  <span class="comment">/* biomass of dead root */</span></div>
<div class="line">                                    Root =Root+newRoot-deadroot;</div>
<div class="line">                                    rootlitter=rootlitter+deadroot;</div>
<div class="line">                                    REAL(RootLittervec)[dayi]= rootlitter; </div>
<div class="line">                                 }</div>
<div class="line">        </div>
<div class="line">                                 <span class="keywordflow">if</span>(kSeedcane &gt; 0)</div>
<div class="line">                                    {</div>
<div class="line">                                    newSeedcane = dailyassim * kSeedcane ;      </div>
<div class="line">                                           <span class="keywordflow">if</span>(newSeedcane&gt;0)</div>
<div class="line">                                             {</div>
<div class="line">                                              *(sti4+ri) = newSeedcane;</div>
<div class="line">                                             }</div>
<div class="line">                                           <span class="keywordflow">else</span></div>
<div class="line">                                           {</div>
<div class="line">                                                   newSeedcane=0;</div>
<div class="line">                                           }</div>
<div class="line">                                    ri++;</div>
<div class="line">                                  }</div>
<div class="line">                                 <span class="keywordflow">else</span></div>
<div class="line">                                 {</div>
<div class="line">                                  <span class="keywordflow">if</span>(Seedcane &lt; 0){</div>
<div class="line">                                                     Seedcane = 1e-4;</div>
<div class="line">                                                     warning(<span class="stringliteral">&quot;Seedcane became negative&quot;</span>);</div>
<div class="line">                                                  }</div>
<div class="line"></div>
<div class="line">                                newSeedcane = Seedcane * kSeedcane;</div>
<div class="line">                                Root += kRoot * -newSeedcane ;</div>
<div class="line">                                Stem += kStem * -newSeedcane ;</div>
<div class="line">                                Leaf += kLeaf * -newSeedcane ;</div>
<div class="line">                               newSeedcane=newSeedcane-dailySeedcaneResp;       </div>
<div class="line">                                 }</div>
<div class="line">                </div>
<div class="line">                                 <span class="comment">/*      newSugar=newStem*dbpS.kSugar;</span></div>
<div class="line"><span class="comment">                                         Sugar=Sugar+newSugar;   */</span></div>
<div class="line">                                        </div>
<div class="line">                                 ALitter = REAL(LeafLittervec)[i] + REAL(StemLittervec)[i];</div>
<div class="line">                                 BLitter = REAL(RootLittervec)[i];</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">                </div>
<div class="line">                <span class="comment">/*daily update of specific leaf area*/</span></div>
<div class="line">                Sp = Sp - REAL(SPD)[0];</div>
<div class="line">                <span class="keywordflow">if</span> (Sp &lt; 0.5)Sp=0.5;</div>
<div class="line"></div>
<div class="line">                <span class="comment">/* new value of leaf area index */</span></div>
<div class="line">                LAInew = Leaf * Sp ;</div>
<div class="line">    <span class="keywordflow">if</span>(wsFun!=3){</div>
<div class="line">      LAI=(LAInew-LAIold)*LeafWS+LAIold;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span> {</div>
<div class="line">      LAI=LAInew;</div>
<div class="line">    }</div>
<div class="line">                <span class="comment">/* apply leaf water stress based on rainfed (wsFun=0,1,2) or irrigated system (wsFun=3)*/</span></div>
<div class="line"></div>
<div class="line">                <span class="comment">//              if(wsFun ==3)</span></div>
<div class="line">                <span class="comment">//              { </span></div>
<div class="line">                <span class="comment">//               LAI=LAInew;</span></div>
<div class="line">                <span class="comment">//              }</span></div>
<div class="line">                <span class="comment">//              else</span></div>
<div class="line">                <span class="comment">//              { </span></div>
<div class="line">                <span class="comment">//               LAI=LAIold+(LAInew-LAIold)*LeafWS;</span></div>
<div class="line">                <span class="comment">//              }</span></div>
<div class="line">                <span class="comment">//              LAIold=LAI;</span></div>
<div class="line"></div>
<div class="line">                  <span class="comment">// Implementing LeafWS on Leaf Area  Index</span></div>
<div class="line">     <span class="comment">//LAI=LAInew;                </span></div>
<div class="line"></div>
<div class="line">                <span class="comment">/* daily update of leaf-N, vmac, and alpga  based on cyclic seasonal variation */</span></div>
<div class="line">                currentday=*(pt_doy+i);</div>
<div class="line">                LeafN=<a class="code" href="_auxcane_gro_8c.html#a29197dc7c796929a4c9c6d1e758a630c">seasonal</a>(LeafNmax,LeafNmin ,currentday,dayofMaxLeafN,365.0,lat);</div>
<div class="line">                                <span class="keywordflow">if</span>(nitroparms.lnFun == 0){</div>
<div class="line">                                        vmax1 = vmax1;</div>
<div class="line">                                        Rd1=Rd1;</div>
<div class="line">                                        alpha1=alpha1;</div>
<div class="line">                                }<span class="keywordflow">else</span>{</div>
<div class="line">                                        vmax1=nitroparms.Vmaxb1*LeafN+nitroparms.Vmaxb0;</div>
<div class="line">                                        <span class="keywordflow">if</span>(vmax1&lt;0) vmax1=0.0;</div>
<div class="line">                                        alpha1=nitroparms.alphab1*LeafN+nitroparms.alphab0;</div>
<div class="line">                                        Rd1=nitroparms.Rdb1*LeafN+nitroparms.Rdb0;</div>
<div class="line">                                   }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">                    <span class="comment">// Here, I am checking for maximum LAI based on minimum SLN = 50 is required</span></div>
<div class="line">                    <span class="comment">// If LAI &gt; LAI max then additional senescence of leaf take place</span></div>
<div class="line">                laimax=(-1)*log((50.0/LeafN))/(kpLN);</div>
<div class="line">                                 <span class="keywordflow">if</span>(LAI&gt;laimax)</div>
<div class="line">                                 {</div>
<div class="line">                                         LAI=laimax;</div>
<div class="line">                                         deadleaf=(LAI-laimax)/Sp;  <span class="comment">/* biomass of dead leaf */</span></div>
<div class="line">            remobilizedleaf&lt;-deadleaf*Remobfactorleaf;</div>
<div class="line">                         leaflitter=leaflitter+deadleaf-remobilizedleaf; <span class="comment">/*40% of dead leaf goes to leaf litter */</span></div>
<div class="line">                                 Leaf =Leaf-deadleaf+remobilizedleaf*33;</div>
<div class="line">         Stem=Stem+remobilizedleaf*0.33;</div>
<div class="line">         Root=Root+remobilizedleaf*0.33;</div>
<div class="line">                                 }</div>
<div class="line">         <span class="comment">// Here I am simulating leaf Frost damage</span></div>
<div class="line">         <span class="keywordflow">if</span>((*pt_temp+i)&lt;frostparms.leafT0)</div>
<div class="line">         {</div>
<div class="line">         deadleaf=<a class="code" href="_auxcane_gro_8h.html#ae2c9413db58fa28b450e41b376bc1ac8">getFrostdamage</a>(frostparms.leafT0,frostparms.leafT100,*(pt_temp+i), Leaf);</div>
<div class="line">         remobilizedleaf&lt;-deadleaf*Remobfactorleaf;</div>
<div class="line">                 leaflitter=leaflitter+deadleaf-remobilizedleaf; <span class="comment">/*40% of dead leaf goes to leaf litter */</span></div>
<div class="line">                                 Leaf =Leaf-deadleaf+remobilizedleaf*0.0;</div>
<div class="line">         Stem=Stem+remobilizedleaf*0.50;</div>
<div class="line">         Root=Root+remobilizedleaf*0.50;</div>
<div class="line">         }</div>
<div class="line"></div>
<div class="line">                <span class="comment">/*reset daily assimilation and daily transpiratin to zero for the next day */</span></div>
<div class="line">                dailyassim=0.0;</div>
<div class="line">                dailytransp=0.0;</div>
<div class="line"></div>
<div class="line">                <span class="comment">/*reset daily maintenance respiration to zero for the next day */</span></div>
<div class="line">                 dailyLeafResp = 0.0;</div>
<div class="line">                 dailyStemResp = 0.0;</div>
<div class="line">                 dailyRootResp = 0.0;</div>
<div class="line">                 dailyRhizomeResp = 0.0;</div>
<div class="line">            </div>
<div class="line">                REAL(DayofYear)[dayi] =  INTEGER(DOY)[i];         </div>
<div class="line">                REAL(Leafy)[dayi] = Leaf;</div>
<div class="line">                REAL(Stemy)[dayi] = Stem;</div>
<div class="line">                REAL(Rooty)[dayi] =  Root;</div>
<div class="line">                REAL(Seedcaney)[dayi] = Seedcane;</div>
<div class="line">                REAL(LAIc)[dayi] = LAI;</div>
<div class="line">                REAL(LeafNitrogen)[dayi] = LeafN;</div>
<div class="line">                REAL(AboveLitter)[dayi] = ALitter;</div>
<div class="line">                REAL(BelowLitter)[dayi] = BLitter;</div>
<div class="line">                REAL(VmaxVec)[dayi] = vmax1;</div>
<div class="line">                REAL(AlphaVec)[dayi] = alpha1;</div>
<div class="line">                REAL(SpVec)[dayi] = Sp;</div>
<div class="line">                REAL(Fibery)[dayi]=Fiber;</div>
<div class="line">                REAL(Sugary)[dayi]=Sugar;</div>
<div class="line">                ddap=(double)dayi;</div>
<div class="line">                REAL(dayafterplanting)[dayi]=ddap;</div>
<div class="line">                moist=(5.72*Stem-7.16*Sugar);</div>
<div class="line">                REAL(moisturecontent)[dayi]=moist;</div>
<div class="line">                dayi=dayi+1;</div>
<div class="line">                } <span class="comment">/*daily loop ends here */</span></div>
<div class="line">                </div>
<div class="line">                </div>
<div class="line"></div>
<div class="line">                <span class="comment">/* here I am writing REMAINING variables at hourly time step */</span></div>
<div class="line">                REAL(Hour)[i] =  INTEGER(HR)[i];</div>
<div class="line">                REAL(CanopyAssim)[i] =  CanopyA;</div>
<div class="line">                REAL(CanopyTrans)[i] =  CanopyT; </div>
<div class="line">                REAL(SoilWatCont)[i] = waterCont;</div>
<div class="line">                REAL(StomatalCondCoefs)[i] = StomWS;</div>
<div class="line">                REAL(LeafReductionCoefs)[i] = LeafWS;</div>
<div class="line">                REAL(SoilEvaporation)[i] = soilEvap;</div>
<div class="line">                REAL(LeafPsimVec)[i] = LeafPsim;</div>
<div class="line">      </div>
<div class="line"></div>
<div class="line">        }</div>
<div class="line"></div>
<div class="line"></div>
<div class="line"></div>
<div class="line">        SET_VECTOR_ELT(lists,0,DayofYear);</div>
<div class="line">        SET_VECTOR_ELT(lists,1,Hour);</div>
<div class="line">        SET_VECTOR_ELT(lists,2,CanopyAssim);</div>
<div class="line">        SET_VECTOR_ELT(lists,3,CanopyTrans);</div>
<div class="line">        SET_VECTOR_ELT(lists,4,Leafy);</div>
<div class="line">        SET_VECTOR_ELT(lists,5,Stemy);</div>
<div class="line">        SET_VECTOR_ELT(lists,6,Rooty);</div>
<div class="line">        SET_VECTOR_ELT(lists,7,Sugary);</div>
<div class="line">        SET_VECTOR_ELT(lists,8,Fibery);</div>
<div class="line">        SET_VECTOR_ELT(lists,9,Seedcaney);</div>
<div class="line">        SET_VECTOR_ELT(lists,10,LAIc);</div>
<div class="line">        SET_VECTOR_ELT(lists,11,TTTc);</div>
<div class="line">        SET_VECTOR_ELT(lists,12,SoilWatCont);</div>
<div class="line">        SET_VECTOR_ELT(lists,13,StomatalCondCoefs);</div>
<div class="line">        SET_VECTOR_ELT(lists,14,LeafReductionCoefs);</div>
<div class="line">        SET_VECTOR_ELT(lists,15,LeafNitrogen);</div>
<div class="line">        SET_VECTOR_ELT(lists,16,AboveLitter);</div>
<div class="line">        SET_VECTOR_ELT(lists,17,BelowLitter);</div>
<div class="line">        SET_VECTOR_ELT(lists,18,VmaxVec);</div>
<div class="line">        SET_VECTOR_ELT(lists,19,AlphaVec);</div>
<div class="line">        SET_VECTOR_ELT(lists,20,SpVec);</div>
<div class="line">        SET_VECTOR_ELT(lists,21,SoilEvaporation);</div>
<div class="line">        SET_VECTOR_ELT(lists,22,cwsMat);</div>
<div class="line">        SET_VECTOR_ELT(lists,23,psimMat);</div>
<div class="line">        SET_VECTOR_ELT(lists,24,rdMat);</div>
<div class="line">        SET_VECTOR_ELT(lists,25,LeafPsimVec);</div>
<div class="line">        SET_VECTOR_ELT(lists,26,LeafLittervec);</div>
<div class="line">        SET_VECTOR_ELT(lists,27,StemLittervec);</div>
<div class="line">        SET_VECTOR_ELT(lists,28,RootLittervec);</div>
<div class="line">        SET_VECTOR_ELT(lists,29,Leafmaintenance);</div>
<div class="line">        SET_VECTOR_ELT(lists,30,Stemmaintenance);</div>
<div class="line">        SET_VECTOR_ELT(lists,31,Rootmaintenance);</div>
<div class="line">        SET_VECTOR_ELT(lists,32,Seedcanemaintenance);</div>
<div class="line">        SET_VECTOR_ELT(lists,33,kkleaf);</div>
<div class="line">        SET_VECTOR_ELT(lists,34,kkroot);</div>
<div class="line">        SET_VECTOR_ELT(lists,35,kkstem);</div>
<div class="line">        SET_VECTOR_ELT(lists,36,kkseedcane);</div>
<div class="line">        SET_VECTOR_ELT(lists,37,kkfiber);</div>
<div class="line">        SET_VECTOR_ELT(lists,38,kksugar);</div>
<div class="line">        SET_VECTOR_ELT(lists,39,dailyThermalT);</div>
<div class="line">        SET_VECTOR_ELT(lists,40,moisturecontent);</div>
<div class="line">        SET_VECTOR_ELT(lists,41,dayafterplanting);</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">       </div>
<div class="line"></div>
<div class="line">        SET_STRING_ELT(names,0,mkChar(<span class="stringliteral">&quot;DayofYear&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,1,mkChar(<span class="stringliteral">&quot;Hour&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,2,mkChar(<span class="stringliteral">&quot;CanopyAssim&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,3,mkChar(<span class="stringliteral">&quot;CanopyTrans&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,4,mkChar(<span class="stringliteral">&quot;Leaf&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,5,mkChar(<span class="stringliteral">&quot;Stem&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,6,mkChar(<span class="stringliteral">&quot;Root&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,7,mkChar(<span class="stringliteral">&quot;Sugar&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,8,mkChar(<span class="stringliteral">&quot;Fiber&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,9,mkChar(<span class="stringliteral">&quot;Seedcane&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,10,mkChar(<span class="stringliteral">&quot;LAI&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,11,mkChar(<span class="stringliteral">&quot;ThermalT&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,12,mkChar(<span class="stringliteral">&quot;SoilWatCont&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,13,mkChar(<span class="stringliteral">&quot;StomatalCondCoefs&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,14,mkChar(<span class="stringliteral">&quot;LeafReductionCoefs&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,15,mkChar(<span class="stringliteral">&quot;LeafNitrogen&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,16,mkChar(<span class="stringliteral">&quot;AboveLitter&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,17,mkChar(<span class="stringliteral">&quot;BelowLitter&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,18,mkChar(<span class="stringliteral">&quot;VmaxVec&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,19,mkChar(<span class="stringliteral">&quot;AlphaVec&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,20,mkChar(<span class="stringliteral">&quot;SpVec&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,21,mkChar(<span class="stringliteral">&quot;SoilEvaporation&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,22,mkChar(<span class="stringliteral">&quot;cwsMat&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,23,mkChar(<span class="stringliteral">&quot;psimMat&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,24,mkChar(<span class="stringliteral">&quot;rdMat&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,25,mkChar(<span class="stringliteral">&quot;LeafPsimVec&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,26,mkChar(<span class="stringliteral">&quot;LeafLittervec&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,27,mkChar(<span class="stringliteral">&quot;StemLittervec&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,28,mkChar(<span class="stringliteral">&quot;RootLittervec&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,29,mkChar(<span class="stringliteral">&quot;Leafmaintenance&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,30,mkChar(<span class="stringliteral">&quot;Stemmaintenance&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,31,mkChar(<span class="stringliteral">&quot;Rootmaintenance&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,32,mkChar(<span class="stringliteral">&quot;Seedcanemaintenance&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,33,mkChar(<span class="stringliteral">&quot;kkleaf&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,34,mkChar(<span class="stringliteral">&quot;kkroot&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,35,mkChar(<span class="stringliteral">&quot;kkstem&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,36,mkChar(<span class="stringliteral">&quot;kkseedcane&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,37,mkChar(<span class="stringliteral">&quot;kkfiber&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,38,mkChar(<span class="stringliteral">&quot;kksugar&quot;</span>));</div>
<div class="line">        SET_STRING_ELT(names,39,mkChar(<span class="stringliteral">&quot;dailyThermalT&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,40,mkChar(<span class="stringliteral">&quot;moisturecontent&quot;</span>));</div>
<div class="line">  SET_STRING_ELT(names,41,mkChar(<span class="stringliteral">&quot;dayafterplanting&quot;</span>));</div>
<div class="line">        setAttrib(lists,R_NamesSymbol,names);</div>
<div class="line">        UNPROTECT(44);  <span class="comment">/* 34= 32+2, 2 comes from the very first two PROTECT statement for variable list and name */</span></div>
<div class="line"></div>
<div class="line">        free(newLeafcol);</div>
<div class="line">        free(newStemcol);</div>
<div class="line">        free(newRootcol);</div>
<div class="line">        free(newRhizomecol);</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">return</span>(lists);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="cane_gro_8c.html">caneGro.c</a></li>
    <li class="footer">Generated on Wed Jan 22 2014 09:27:25 for BioCro by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.1.2 </li>
  </ul>
</div>
</body>
</html>
