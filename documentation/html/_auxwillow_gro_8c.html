<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>BioCro: src/AuxwillowGro.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">BioCro
   &#160;<span id="projectnumber">0.92</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.1.2 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_auxwillow_gro_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Macros</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">AuxwillowGro.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;R.h&gt;</code><br/>
<code>#include &lt;Rmath.h&gt;</code><br/>
<code>#include &lt;Rinternals.h&gt;</code><br/>
<code>#include &quot;<a class="el" href="">c3photo.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">AuxBioCro.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">BioCro.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">AuxwillowGro.h</a>&quot;</code><br/>
<code>#include &quot;<a class="el" href="">c3canopy.h</a>&quot;</code><br/>
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for AuxwillowGro.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="_auxwillow_gro_8c__incl.png" border="0" usemap="#src_2_auxwillow_gro_8c" alt=""/></div>
<map name="src_2_auxwillow_gro_8c" id="src_2_auxwillow_gro_8c">
<area shape="rect" id="node9" href="c3photo_8h.html" title="c3photo.h" alt="" coords="308,83,385,112"/><area shape="rect" id="node11" href="_aux_bio_cro_8h.html" title="AuxBioCro.h" alt="" coords="409,83,505,112"/><area shape="rect" id="node13" href="_bio_cro_8h.html" title="BioCro.h" alt="" coords="529,83,601,112"/><area shape="rect" id="node15" href="_auxwillow_gro_8h.html" title="AuxwillowGro.h" alt="" coords="625,83,737,112"/><area shape="rect" id="node17" href="c3canopy_8h.html" title="c3canopy.h" alt="" coords="145,83,233,112"/></map>
</div>
</div>
<p><a href="">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ac76a61a6bb1df6d8edfcf84ef826c32c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_auxwillow_gro_8c.html#ac76a61a6bb1df6d8edfcf84ef826c32c">createCanopy</a> (struct <a class="el" href="structcanopy.html">canopy</a> *<a class="el" href="structcanopy.html">canopy</a>, int Nlayers, double LAItotal)</td></tr>
<tr class="memitem:a6227c845c706959b38921e90ec099311"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_auxwillow_gro_8c.html#a6227c845c706959b38921e90ec099311">discretizeCanopy</a> (struct <a class="el" href="structcanopy.html">canopy</a> *<a class="el" href="structcanopy.html">canopy</a>)</td></tr>
<tr class="memitem:a5b569d4b9b8006b06c35d0aee5ec51ea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_auxwillow_gro_8c.html#a5b569d4b9b8006b06c35d0aee5ec51ea">getcanopylightme</a> (struct <a class="el" href="structcanopy.html">canopy</a> *<a class="el" href="structcanopy.html">canopy</a>, double lat, double DOY, int td, double solarR)</td></tr>
<tr class="memitem:af5829d0791e03458b6fa02f8c5b50989"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_auxwillow_gro_8c.html#af5829d0791e03458b6fa02f8c5b50989">getCanopysunML</a> (struct <a class="el" href="structcanopy.html">canopy</a> *<a class="el" href="structcanopy.html">canopy</a>, double kd, double chil, double heightf)</td></tr>
<tr class="memitem:ae42513b789aea0a0523e01aa6e757f35"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_auxwillow_gro_8c.html#ae42513b789aea0a0523e01aa6e757f35">getcanopyWINDprofile</a> (struct <a class="el" href="structcanopy.html">canopy</a> *<a class="el" href="structcanopy.html">canopy</a>, double WindSpeed)</td></tr>
<tr class="memitem:ac827965d6919349d51719e982298f72e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_auxwillow_gro_8c.html#ac827965d6919349d51719e982298f72e">getcanopyRHprof</a> (struct <a class="el" href="structcanopy.html">canopy</a> *<a class="el" href="structcanopy.html">canopy</a>, double RH)</td></tr>
<tr class="memitem:a962f1edaba4e3276bcf5e5b4be25055a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_auxwillow_gro_8c.html#a962f1edaba4e3276bcf5e5b4be25055a">getcanopyLNprof</a> (struct <a class="el" href="structcanopy.html">canopy</a> *<a class="el" href="structcanopy.html">canopy</a>, double LeafN, double kpLN)</td></tr>
<tr class="memitem:ae4fbabce7c710d9d71c428f3b4622b52"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_auxwillow_gro_8c.html#ae4fbabce7c710d9d71c428f3b4622b52">freecanopy</a> (struct <a class="el" href="structcanopy.html">canopy</a> *<a class="el" href="structcanopy.html">canopy</a>)</td></tr>
<tr class="memitem:af2fd78212ed1cfbe6bd2d77f6ec851ec"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="struct_can___str.html">Can_Str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_auxwillow_gro_8c.html#af2fd78212ed1cfbe6bd2d77f6ec851ec">c3CanAC</a> (double LAI, int DOY, int hr, double solarR, double Temp, double RH, double WindSpeed, double lat, int nlayers, double Vmax, double Jmax, double Rd, double Catm, double o2, double b0, double b1, double theta, double kd, double heightf, double leafN, double kpLN, double lnb0, double lnb1, int lnfun, double StomWS, int ws)</td></tr>
<tr class="memitem:a5a18f68430b9e6ed1be3d294b179f8a6"><td class="memItemLeft" align="right" valign="top">struct <a class="el" href="struct_can___str.html">Can_Str</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_auxwillow_gro_8c.html#a5a18f68430b9e6ed1be3d294b179f8a6">newc3CanAC</a> (double LAI, int DOY, int hr, double solarR, double Temp, double RH, double WindSpeed, double lat, int nlayers, double Vmax, double Jmax, double Rd, double Catm, double o2, double b0, double b1, double theta, double kd, double heightf, double leafN, double kpLN, double lnb0, double lnb1, int lnfun, double StomWS, int ws)</td></tr>
</table>
<h2>Function Documentation</h2>
<a class="anchor" id="af2fd78212ed1cfbe6bd2d77f6ec851ec"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="struct_can___str.html">Can_Str</a> c3CanAC </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>DOY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>solarR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>WindSpeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Vmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Jmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Catm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>o2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>heightf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>leafN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kpLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lnfun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>StomWS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ws</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L295">295</a> of file <a class="el" href="">AuxwillowGro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line"></div>
<div class="line">   <span class="keyword">struct </span><a class="code" href="struct_e_t___str.html">ET_Str</a> tmp5_ET , tmp6_ET; </div>
<div class="line">   <span class="keyword">struct </span><a class="code" href="structc3__str.html">c3_str</a> tmpc3={0,0,0,0};</div>
<div class="line">   <span class="keyword">struct </span><a class="code" href="structc3__str.html">c3_str</a> tmpc32={0,0,0,0}; </div>
<div class="line">   <span class="keyword">struct </span><a class="code" href="struct_can___str.html">Can_Str</a> ans={0,0,0};</div>
<div class="line"></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> cf = 3600 * 1e-6 * 30 * 1e-6 * 10000;</div>
<div class="line"><span class="comment">/* Need a different conversion factor for transpiration */</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> cf2 = 3600 * 1e-3 * 18 * 1e-6 * 10000; </div>
<div class="line">        </div>
<div class="line">  <span class="keywordtype">int</span> i;</div>
<div class="line">  <span class="keywordtype">double</span> Idir, Idiff, cosTh;</div>
<div class="line">  <span class="keywordtype">double</span> <a class="code" href="_bio_cro_8h.html#ac656f07a64aeba7d6ac5a3a536e993c8">LAIc</a>;</div>
<div class="line">  <span class="keywordtype">double</span> IDir, IDiff, Itot,rh, WindS;</div>
<div class="line">  <span class="keywordtype">double</span> TempIdir,TempIdiff,AssIdir,AssIdiff;</div>
<div class="line">  <span class="keywordtype">double</span>  pLeafsun, pLeafshade;</div>
<div class="line">  <span class="keywordtype">double</span> Leafsun, Leafshade;</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">double</span> CanopyA = 0.0;</div>
<div class="line">  <span class="keywordtype">double</span> GCanopyA = 0.0;</div>
<div class="line">  <span class="keywordtype">double</span> GAssIdir = 0.0;</div>
<div class="line">  <span class="keywordtype">double</span> GAssIdiff = 0.0; </div>
<div class="line">  <span class="keywordtype">double</span> CanopyT =0.0;;</div>
<div class="line">  <span class="keywordtype">double</span> CanopyPe = 0.0;</div>
<div class="line">  <span class="keywordtype">double</span> CanopyPr = 0.0;</div>
<div class="line">  <span class="keywordtype">double</span> CanopyC = 0.0;</div>
<div class="line">  <span class="keywordtype">double</span> chil=1.0;</div>
<div class="line">  <span class="keywordtype">double</span> CanHeight;</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">double</span> vmax1;</div>
<div class="line">  <span class="keywordtype">double</span> leafN_lay;</div>
<div class="line">  </div>
<div class="line"> <span class="comment">/* double StomWS;</span></div>
<div class="line"><span class="comment"> /* int ws;</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">        /* For Assimilation */</span></div>
<div class="line">        <span class="comment">/* 3600 converts seconds to hours */</span></div>
<div class="line">        <span class="comment">/* 1e-6 converts micro mols to mols */</span></div>
<div class="line">        <span class="comment">/* 30 is the grams in one mol of CO2 */</span></div>
<div class="line">        <span class="comment">/* 1e-6 converts g to Mg */</span></div>
<div class="line">        <span class="comment">/* 10000 scales from meter squared to hectare */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* For Transpiration */</span></div>
<div class="line">        <span class="comment">/* 3600 converts seconds to hours */</span></div>
<div class="line">        <span class="comment">/* 1e-3 converts mili mols to mols */</span></div>
<div class="line">        <span class="comment">/* 18 is the grams in one mol of H20 */</span></div>
<div class="line">        <span class="comment">/* 1e-6 converts g to Mg */</span></div>
<div class="line">        <span class="comment">/* 10000 scales from meter squared to hectare */</span></div>
<div class="line"></div>
<div class="line">         <a class="code" href="_aux_bio_cro_8c.html#a46827eb56108821fe82228553f535293">lightME</a>(lat,DOY,hr);</div>
<div class="line"></div>
<div class="line">  Idir = <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[0] * solarR;</div>
<div class="line">  Idiff = <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[1] * solarR;</div>
<div class="line">  cosTh = <a class="code" href="_aux_bio_cro_8h.html#aab252cacb5d92c011d673d2db55cba0d">tmp1</a>[2];</div>
<div class="line"></div>
<div class="line"><span class="comment">/* sun multilayer model. As a side effect it populates the layIdir, layItotal, layFsun, layHeight,</span></div>
<div class="line"><span class="comment">layIdiff, layShade vectors. */</span></div>
<div class="line">    </div>
<div class="line">    <a class="code" href="_aux_bio_cro_8c.html#acb415c4c261f9fc0140240ad46007c87">sunML</a>(Idir,Idiff,LAI,nlayers,cosTh,kd,chil,heightf);</div>
<div class="line"></div>
<div class="line">    <span class="comment">/* results from multilayer model */</span></div>
<div class="line">    LAIc = LAI / nlayers;</div>
<div class="line">    <span class="comment">/* Next I need the RH and wind profile */</span></div>
<div class="line"></div>
<div class="line">    <a class="code" href="_aux_bio_cro_8c.html#a247148ac54cf7d8c851326de6093b71e">RHprof</a>(RH,nlayers);</div>
<div class="line">    <span class="comment">/* It populates tmp4. */</span></div>
<div class="line"></div>
<div class="line">     <a class="code" href="_aux_bio_cro_8c.html#a43b0d68a959084dc4f4dc099c8901107">WINDprof</a>(WindSpeed,LAI,nlayers);</div>
<div class="line">    <span class="comment">/* It populates tmp3. */</span></div>
<div class="line"></div>
<div class="line">     <a class="code" href="_aux_bio_cro_8c.html#aa65c89edaec63830e4dd568a89d12fa2">LNprof</a>(leafN, LAI, nlayers, kpLN);</div>
<div class="line">    <span class="comment">/* It populates tmp5 */</span></div>
<div class="line"></div>
<div class="line">    <span class="comment">/* Next use the EvapoTrans function */</span></div>
<div class="line">    CanopyA=0.0;</div>
<div class="line">    CanopyT=0.0;</div>
<div class="line">    GCanopyA=0.0;</div>
<div class="line">    <span class="keywordflow">for</span>(i=0;i&lt;nlayers;i++)</div>
<div class="line">    {</div>
<div class="line"><span class="comment">/* vmax depends on leaf nitrogen and this in turn depends on the layer */</span></div>
<div class="line">      leafN_lay = <a class="code" href="_aux_bio_cro_8h.html#aaa2add75bf14b805a4da749043e7be33">tmp5</a>[--<a class="code" href="_aux_bio_cro_8h.html#a39f70a6dfb72439e2f4e0f03f27c0813">tp5</a>];</div>
<div class="line">            <span class="keywordflow">if</span>(lnfun == 0){</div>
<div class="line">                    vmax1 = Vmax;</div>
<div class="line">            }<span class="keywordflow">else</span>{</div>
<div class="line">                    vmax1 = leafN_lay * lnb1 + lnb0;</div>
<div class="line"><span class="comment">/* For now alpha is not affected by leaf nitrogen */</span></div>
<div class="line">            }</div>
<div class="line"></div>
<div class="line">            IDir = <a class="code" href="_aux_bio_cro_8h.html#ab0638a2083d3e8d4c1ac43a116da1ad8">layIdir</a>[--<a class="code" href="_aux_bio_cro_8h.html#a287f9452c1f62b4c5c9ec0616503fb8e">sp1</a>];</div>
<div class="line">            Itot = <a class="code" href="_aux_bio_cro_8h.html#a1e5f45a584d3c5541472f92c5875e4ea">layItotal</a>[--<a class="code" href="_aux_bio_cro_8h.html#a959c4cc4acdec59096dac039bfdb627b">sp3</a>];</div>
<div class="line">            </div>
<div class="line">            rh = <a class="code" href="_aux_bio_cro_8h.html#acfad88ff5207b2ab57fc1dca17271065">tmp4</a>[--<a class="code" href="_aux_bio_cro_8h.html#a36e4d9011835445995335074adedad9a">tp4</a>];</div>
<div class="line">            WindS = <a class="code" href="_aux_bio_cro_8h.html#a15219c620f8cdf6d8cf731e485e2c668">tmp3</a>[--<a class="code" href="_aux_bio_cro_8h.html#af8b40a97721000892ae5e0ac624af4c6">tp3</a>];</div>
<div class="line"></div>
<div class="line">            pLeafsun = <a class="code" href="_aux_bio_cro_8h.html#a029005f88756e3761a72c104fae0d57b">layFsun</a>[--<a class="code" href="_aux_bio_cro_8h.html#a25e1abfffbd0ba6bcb9e7d2b6c847c04">sp4</a>];</div>
<div class="line">            CanHeight = <a class="code" href="_aux_bio_cro_8h.html#a5ebe5f68c3871953059c08a083acdb9c">layHeight</a>[--<a class="code" href="_aux_bio_cro_8h.html#ac86af9361847656ad3514e64ad9e9842">sp6</a>];</div>
<div class="line">            Leafsun = LAIc * pLeafsun;</div>
<div class="line"><span class="comment">/* Need a new evapo transpiration function specifically for c3*/</span></div>
<div class="line">            tmp5_ET = <a class="code" href="_auxwillow_gro_8h.html#a14fc4c1327518e9237f587b37400ac97">c3EvapoTrans</a>(IDir,Itot,Temp,rh,WindS,LAIc,CanHeight,</div>
<div class="line">                                 Vmax,Jmax,Rd,b0,b1,Catm,o2,theta);</div>
<div class="line">            TempIdir = Temp + tmp5_ET.Deltat;</div>
<div class="line">            tmpc3 = <a class="code" href="c3photo_8c.html#ad30b1a99fb440301345822cb38fb5cbe">c3photoC</a>(IDir,TempIdir,rh,Vmax,Jmax,Rd,b0,b1,Catm,o2,theta,StomWS,ws);</div>
<div class="line">            AssIdir = tmpc3.<a class="code" href="structc3__str.html#a7adeee8f55ac1ffe5e9c226823ae4251">Assim</a>;</div>
<div class="line">      GAssIdir =tmpc3.<a class="code" href="structc3__str.html#ac2cb333c4e7bdd22c4c9672c80ed977f">GrossAssim</a>;</div>
<div class="line"></div>
<div class="line">            IDiff = <a class="code" href="_aux_bio_cro_8h.html#a0b8103786ef18d899e25c932a2eb5b88">layIdiff</a>[--<a class="code" href="_aux_bio_cro_8h.html#a972c42de1800efab3685fc8a47e05da5">sp2</a>];</div>
<div class="line">            pLeafshade = <a class="code" href="_aux_bio_cro_8h.html#a5a00a948cd8575f53c71ee1f4b799da5">layFshade</a>[--<a class="code" href="_aux_bio_cro_8h.html#a048d95ccd2cc9d2f00c78c97343c9a6a">sp5</a>];</div>
<div class="line">            Leafshade = LAIc * pLeafshade;</div>
<div class="line">            tmp6_ET = <a class="code" href="_auxwillow_gro_8h.html#a14fc4c1327518e9237f587b37400ac97">c3EvapoTrans</a>(IDiff,Itot,Temp,rh,WindS,LAIc,CanHeight,</div>
<div class="line">                         Vmax,Jmax,Rd,b0,b1,Catm,o2,theta);</div>
<div class="line">            TempIdiff = Temp + tmp6_ET.Deltat;</div>
<div class="line">            tmpc32 = <a class="code" href="c3photo_8c.html#ad30b1a99fb440301345822cb38fb5cbe">c3photoC</a>(IDiff,TempIdir,rh,Vmax,Jmax,Rd,b0,b1,Catm,o2,theta,StomWS,ws);</div>
<div class="line">            AssIdiff = tmpc32.<a class="code" href="structc3__str.html#a7adeee8f55ac1ffe5e9c226823ae4251">Assim</a>;</div>
<div class="line">      GAssIdiff = tmpc32.<a class="code" href="structc3__str.html#ac2cb333c4e7bdd22c4c9672c80ed977f">GrossAssim</a>;</div>
<div class="line"></div>
<div class="line">                CanopyA =CanopyA + Leafsun * AssIdir + Leafshade * AssIdiff;</div>
<div class="line">                CanopyT = CanopyT+Leafsun * tmp5_ET.TransR + Leafshade * tmp6_ET.TransR;</div>
<div class="line">    GCanopyA =GCanopyA+ Leafsun * GAssIdir + Leafshade * GAssIdiff;</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">/*## These are micro mols of CO2 per m2 per sec for Assimilation</span></div>
<div class="line"><span class="comment">          ## and mili mols of H2O per m2 per sec for Transpiration</span></div>
<div class="line"><span class="comment">          ## Need to convert to </span></div>
<div class="line"><span class="comment">          ## 3600 converts seconds to hours</span></div>
<div class="line"><span class="comment">          ## 10^-6 converts micro mols to mols</span></div>
<div class="line"><span class="comment">          ## 30 converts mols of CO2 to grams</span></div>
<div class="line"><span class="comment">          ## (1/10^6) converts grams to Mg</span></div>
<div class="line"><span class="comment">          ## 10000 scales up to ha */</span></div>
<div class="line"><span class="comment">/* A similar conversion is made for water but</span></div>
<div class="line"><span class="comment">   replacing 30 by 18 and mili mols are converted to</span></div>
<div class="line"><span class="comment">   mols (instead of micro) */</span></div>
<div class="line">        ans.<a class="code" href="struct_can___str.html#a7adeee8f55ac1ffe5e9c226823ae4251">Assim</a> = cf * CanopyA ;</div>
<div class="line">        ans.<a class="code" href="struct_can___str.html#af8fba6423eb33d2551d878ee6675cb79">Trans</a> = cf2 * CanopyT; </div>
<div class="line">  ans.<a class="code" href="struct_can___str.html#ac2cb333c4e7bdd22c4c9672c80ed977f">GrossAssim</a>=cf*GCanopyA;</div>
<div class="line"><span class="comment">//  Rprintf(&quot;CF= %f ,Gross Canopy = %f \n&quot;, cf,GCanopyA);</span></div>
<div class="line"><span class="comment">//  Rprintf(&quot;C3photo function is returnin Direst Anet=%f, Agross=%f. Diffuses Anet=%f, Agross=%f \n&quot;,AssIdir,GAssIdir,AssIdiff,GAssIdiff);</span></div>
<div class="line"><span class="comment">//  Rprintf(&quot;C3 Can function is returning CanA=%f, CanT=%f, CanGrossA =%f\n&quot;,ans.Assim, ans.Trans, ans.GrossAssim);</span></div>
<div class="line">        <span class="keywordflow">return</span>(ans);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac76a61a6bb1df6d8edfcf84ef826c32c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void createCanopy </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcanopy.html">canopy</a> *&#160;</td>
          <td class="paramname"><em>canopy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>Nlayers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAItotal</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L39">39</a> of file <a class="el" href="">AuxwillowGro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="comment">/**********************************************</span></div>
<div class="line"><span class="comment">   * Purpose:</span></div>
<div class="line"><span class="comment">   * creare a NULL canopy structure</span></div>
<div class="line"><span class="comment">   * allocate memory based on number of layers</span></div>
<div class="line"><span class="comment">   * initialize all the components of canopy structure</span></div>
<div class="line"><span class="comment">   * ***********************************************/</span></div>
<div class="line">  <span class="keywordtype">int</span> i;</div>
<div class="line">  canopy-&gt;<a class="code" href="structcanopy.html#ac849e7160ff1d625eaac54c5b8992db0">Nlayers</a>=Nlayers;</div>
<div class="line">  canopy-&gt;<a class="code" href="structcanopy.html#ae9da79a864273ae0b9f186593ec33766">Idirtop</a>=0.0;</div>
<div class="line">  canopy-&gt;<a class="code" href="structcanopy.html#aedddaa0b7079a117ba6f8cfd64eb5ca1">Idifftop</a>=0.0;</div>
<div class="line">  canopy-&gt;<a class="code" href="structcanopy.html#ad29629692a0d9d13f09a05f94789c47d">CosZenithAngle</a> =0.0;</div>
<div class="line">  canopy-&gt;<a class="code" href="structcanopy.html#a17cbba40a9200a0b3473cebc58c87f3b">LAItotal</a>= LAItotal;</div>
<div class="line">  canopy-&gt;<a class="code" href="structcanopy.html#a0350fe373203592057a8eba790733c4e">ENV</a> =  malloc((Nlayers+1)*<span class="keyword">sizeof</span>(*canopy-&gt;<a class="code" href="structcanopy.html#a0350fe373203592057a8eba790733c4e">ENV</a>));</div>
<div class="line">  canopy-&gt;<a class="code" href="structcanopy.html#adf45b4b4621ef960d8fe7536e839834e">Leaf</a> = malloc((Nlayers+1)*<span class="keyword">sizeof</span>(*canopy-&gt;<a class="code" href="structcanopy.html#adf45b4b4621ef960d8fe7536e839834e">Leaf</a>));</div>
<div class="line">  canopy-&gt;<a class="code" href="structcanopy.html#afdd9fd9f2ef8702568ea149d7ea535c2">OUT</a> = malloc((Nlayers+1)*<span class="keyword">sizeof</span>(*canopy-&gt;<a class="code" href="structcanopy.html#afdd9fd9f2ef8702568ea149d7ea535c2">OUT</a>));</div>
<div class="line">  <span class="keywordflow">for</span> (i =0; i&lt;Nlayers; i++)</div>
<div class="line">  {</div>
<div class="line">      canopy-&gt;<a class="code" href="structcanopy.html#a0350fe373203592057a8eba790733c4e">ENV</a>[i].<a class="code" href="structcanopy_env.html#a517a3f4381501a07eaf435abaf505036">Idir</a>=0.0;</div>
<div class="line">      canopy-&gt;<a class="code" href="structcanopy.html#a0350fe373203592057a8eba790733c4e">ENV</a>[i].<a class="code" href="structcanopy_env.html#a7b44f9b02093a720da43213e4230466b">Idiff</a>=0.0;</div>
<div class="line">      canopy-&gt;<a class="code" href="structcanopy.html#a0350fe373203592057a8eba790733c4e">ENV</a>[i].<a class="code" href="structcanopy_env.html#ab1547ef7e75f10b8c575b5301aaee5f4">Itotal</a>=0.0;</div>
<div class="line">      canopy-&gt;<a class="code" href="structcanopy.html#a0350fe373203592057a8eba790733c4e">ENV</a>[i].<a class="code" href="structcanopy_env.html#a19532976fea010b59d78084cb47e79b0">RH</a>=0.0;</div>
<div class="line">      canopy-&gt;<a class="code" href="structcanopy.html#a0350fe373203592057a8eba790733c4e">ENV</a>[i].<a class="code" href="structcanopy_env.html#a44364bb96e8d72080f9e82fb0325d6aa">windspeed</a>=0.0;</div>
<div class="line">      canopy-&gt;<a class="code" href="structcanopy.html#a0350fe373203592057a8eba790733c4e">ENV</a>[i].<a class="code" href="structcanopy_env.html#ab48a68073683c5cc2d2b9ab468242e3a">Catm</a>=0.0;</div>
<div class="line">      canopy-&gt;<a class="code" href="structcanopy.html#a0350fe373203592057a8eba790733c4e">ENV</a>[i].<a class="code" href="structcanopy_env.html#a30b2ceb495b99ab029b438563e5f22fa">Temp</a>=0.0;   </div>
<div class="line">    </div>
<div class="line">      canopy-&gt;<a class="code" href="structcanopy.html#adf45b4b4621ef960d8fe7536e839834e">Leaf</a>[i].<a class="code" href="structcanopy_leaf.html#af2896a94dc4bf29566d632587e9c54f1">LAI</a>=0.0;</div>
<div class="line">      canopy-&gt;<a class="code" href="structcanopy.html#adf45b4b4621ef960d8fe7536e839834e">Leaf</a>[i].<a class="code" href="structcanopy_leaf.html#ab2e1f98b44db7479f97be119766270ef">LeafN</a>=0.0;</div>
<div class="line">      canopy-&gt;<a class="code" href="structcanopy.html#adf45b4b4621ef960d8fe7536e839834e">Leaf</a>[i].<a class="code" href="structcanopy_leaf.html#affd2258e348a38ff904bcda150fc3a31">pLeafsun</a>=0.0;</div>
<div class="line">      canopy-&gt;<a class="code" href="structcanopy.html#adf45b4b4621ef960d8fe7536e839834e">Leaf</a>[i].<a class="code" href="structcanopy_leaf.html#a27667cdee7bbfb679803cf36256c4cd5">pLeafshade</a>=0.0;   </div>
<div class="line">      canopy-&gt;<a class="code" href="structcanopy.html#adf45b4b4621ef960d8fe7536e839834e">Leaf</a>[i].<a class="code" href="structcanopy_leaf.html#a6f4001fadc078e666bce2ddd7676fff5">heightf</a>=0.0;  </div>
<div class="line"></div>
<div class="line">      canopy-&gt;<a class="code" href="structcanopy.html#afdd9fd9f2ef8702568ea149d7ea535c2">OUT</a>[i].<a class="code" href="structcanopyoutput.html#a31967f81cd843ba446625ea1c097b531">sunlittemp</a>=0.0;</div>
<div class="line">      canopy-&gt;<a class="code" href="structcanopy.html#afdd9fd9f2ef8702568ea149d7ea535c2">OUT</a>[i].<a class="code" href="structcanopyoutput.html#a8ad52f751228018a07d26916949f26b9">shadedtemp</a>=0.0;</div>
<div class="line">      canopy-&gt;<a class="code" href="structcanopy.html#afdd9fd9f2ef8702568ea149d7ea535c2">OUT</a>[i].<a class="code" href="structcanopyoutput.html#a464378798147ceedbc7ec44c2a7b55ea">TotalAnet</a>=0.0;</div>
<div class="line">      canopy-&gt;<a class="code" href="structcanopy.html#afdd9fd9f2ef8702568ea149d7ea535c2">OUT</a>[i].<a class="code" href="structcanopyoutput.html#ae791a96b55303a27fa23d06f98655a37">TotalAgross</a>=0.0;</div>
<div class="line">      canopy-&gt;<a class="code" href="structcanopy.html#afdd9fd9f2ef8702568ea149d7ea535c2">OUT</a>[i].<a class="code" href="structcanopyoutput.html#a505245413b183273f5f4979c1c1257a9">TotalTrans</a>=0.0;</div>
<div class="line">      canopy-&gt;<a class="code" href="structcanopy.html#afdd9fd9f2ef8702568ea149d7ea535c2">OUT</a>[i].<a class="code" href="structcanopyoutput.html#a3546a9419a506debbb59bfe8b6c62de9">shadedAnet</a>=0.0;</div>
<div class="line">      canopy-&gt;<a class="code" href="structcanopy.html#afdd9fd9f2ef8702568ea149d7ea535c2">OUT</a>[i].<a class="code" href="structcanopyoutput.html#a3a7921702915c4b18ddd2d89091ef812">shadedAgross</a>=0.0;</div>
<div class="line">      canopy-&gt;<a class="code" href="structcanopy.html#afdd9fd9f2ef8702568ea149d7ea535c2">OUT</a>[i].<a class="code" href="structcanopyoutput.html#ac4ffdd62da93119561b8db0927edd646">sunlitAnet</a>=0.0;</div>
<div class="line">      canopy-&gt;<a class="code" href="structcanopy.html#afdd9fd9f2ef8702568ea149d7ea535c2">OUT</a>[i].<a class="code" href="structcanopyoutput.html#a409c5f8083acd4d9b4f08d4fa234850d">sunlitAgross</a>=0.0;</div>
<div class="line">      canopy-&gt;<a class="code" href="structcanopy.html#afdd9fd9f2ef8702568ea149d7ea535c2">OUT</a>[i].<a class="code" href="structcanopyoutput.html#a52337aac5319bd29fb958562cf8153f7">shadedTemp</a>=0.0;</div>
<div class="line">      canopy-&gt;<a class="code" href="structcanopy.html#afdd9fd9f2ef8702568ea149d7ea535c2">OUT</a>[i].<a class="code" href="structcanopyoutput.html#ad703c329b0426ad58d9071922f32613e">sunlitTemp</a>=0.0;</div>
<div class="line">      canopy-&gt;<a class="code" href="structcanopy.html#afdd9fd9f2ef8702568ea149d7ea535c2">OUT</a>[i].<a class="code" href="structcanopyoutput.html#a1355c38db79733fa2c02e45ca3262f4c">shadedTranspiration</a>=0.0;</div>
<div class="line">      canopy-&gt;<a class="code" href="structcanopy.html#afdd9fd9f2ef8702568ea149d7ea535c2">OUT</a>[i].<a class="code" href="structcanopyoutput.html#a9c24624fc997fb5581bd59b7e56c1d67">sunlitTranspiration</a>=0.0;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a6227c845c706959b38921e90ec099311"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void discretizeCanopy </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcanopy.html">canopy</a> *&#160;</td>
          <td class="paramname"><em>canopy</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L89">89</a> of file <a class="el" href="">AuxwillowGro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="comment">/******************************************************************************</span></div>
<div class="line"><span class="comment">   * Purpose:</span></div>
<div class="line"><span class="comment">   * This function discretize the canopy  by assigning total LAI into each canopy layer equally</span></div>
<div class="line"><span class="comment">   * In Future, this function can be changed to accomodate Leaf Area Density</span></div>
<div class="line"><span class="comment">   ******************************************************************************/</span></div>
<div class="line">  <span class="keywordtype">int</span> i;</div>
<div class="line">  </div>
<div class="line">  <span class="keywordflow">for</span> (i=0;i&lt;(canopy-&gt;<a class="code" href="structcanopy.html#ac849e7160ff1d625eaac54c5b8992db0">Nlayers</a>);i++)</div>
<div class="line">  {</div>
<div class="line">    canopy-&gt;<a class="code" href="structcanopy.html#adf45b4b4621ef960d8fe7536e839834e">Leaf</a>[i].<a class="code" href="structcanopy_leaf.html#af2896a94dc4bf29566d632587e9c54f1">LAI</a>=canopy-&gt;<a class="code" href="structcanopy.html#a17cbba40a9200a0b3473cebc58c87f3b">LAItotal</a>/canopy-&gt;<a class="code" href="structcanopy.html#ac849e7160ff1d625eaac54c5b8992db0">Nlayers</a>;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae4fbabce7c710d9d71c428f3b4622b52"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void freecanopy </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcanopy.html">canopy</a> *&#160;</td>
          <td class="paramname"><em>canopy</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L287">287</a> of file <a class="el" href="">AuxwillowGro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  free(canopy-&gt;<a class="code" href="structcanopy.html#a0350fe373203592057a8eba790733c4e">ENV</a>);</div>
<div class="line">  free(canopy-&gt;<a class="code" href="structcanopy.html#adf45b4b4621ef960d8fe7536e839834e">Leaf</a>);</div>
<div class="line">  free(canopy-&gt;<a class="code" href="structcanopy.html#afdd9fd9f2ef8702568ea149d7ea535c2">OUT</a>);</div>
<div class="line">  <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5b569d4b9b8006b06c35d0aee5ec51ea"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getcanopylightme </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcanopy.html">canopy</a> *&#160;</td>
          <td class="paramname"><em>canopy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>DOY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>td</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>solarR</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L105">105</a> of file <a class="el" href="">AuxwillowGro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  </div>
<div class="line">  <span class="comment">/***********************************************************************</span></div>
<div class="line"><span class="comment">   * Purpose: To calculate direct and diffused sunlight at the top of the canopy</span></div>
<div class="line"><span class="comment">   * Input</span></div>
<div class="line"><span class="comment">   * lat:- Latitude</span></div>
<div class="line"><span class="comment">   * DOY:- Day of Year</span></div>
<div class="line"><span class="comment">   * td= Time of day</span></div>
<div class="line"><span class="comment">   * solarR :- Incoming Solar Radiation</span></div>
<div class="line"><span class="comment">   * Output:</span></div>
<div class="line"><span class="comment">   * canopy structure is updated for the following variables</span></div>
<div class="line"><span class="comment">   * Idirtop :- direct light at the top of the canopy</span></div>
<div class="line"><span class="comment">   * Idifftop:- Diffused light at the top of the canopy</span></div>
<div class="line"><span class="comment">   * CosZenithAngle:- Zenith Angle, to be used in the subsequent calculations</span></div>
<div class="line"><span class="comment">   * Reference:</span></div>
<div class="line"><span class="comment">   * Humphries Thesis</span></div>
<div class="line"><span class="comment">   * page 51</span></div>
<div class="line"><span class="comment">   * ***********************************************************************/</span></div>
<div class="line">        <span class="keywordtype">double</span> omega, delta0, delta, deltaR;</div>
<div class="line">        <span class="keywordtype">double</span> tf, SSin, CCos, PPo;</div>
<div class="line">        <span class="keywordtype">double</span> CosZenithAngle, CosHour;</div>
<div class="line">        <span class="keywordtype">double</span> CosHourDeg;</div>
<div class="line">        <span class="keywordtype">double</span> Idir, Idiff, propIdir, propIdiff;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> DTR = <a class="code" href="denitrify_8c.html#ae71449b1cc6e6250b91f539153a7a0d3">M_PI</a>/180;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> tsn = 12.0;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> alpha = 0.85;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> SolarConstant = 2650;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> atmP = 1e5;</div>
<div class="line"></div>
<div class="line">        omega = lat * DTR;</div>
<div class="line">        delta0 = 360.0 * ((DOY + 10)/365.0);</div>
<div class="line">        delta = -23.5 * cos(delta0*DTR);</div>
<div class="line">        deltaR = delta * DTR;</div>
<div class="line"></div>
<div class="line">        tf = (15.0*(td - tsn))*DTR;</div>
<div class="line">        SSin = sin(deltaR) * sin(omega);</div>
<div class="line">        CCos = cos(deltaR) * cos(omega);</div>
<div class="line"></div>
<div class="line">        CosZenithAngle = SSin + CCos * cos(tf);</div>
<div class="line">        <span class="keywordflow">if</span>(CosZenithAngle &lt; pow(10,-10))</div>
<div class="line">                CosZenithAngle = pow(10,-10);</div>
<div class="line"></div>
<div class="line">        CosHour = -tan(omega) * tan(deltaR);</div>
<div class="line">        CosHourDeg = (1/DTR)*CosHour;</div>
<div class="line">        <span class="keywordflow">if</span>(CosHourDeg &lt; -57)</div>
<div class="line">                CosHour = -0.994;</div>
<div class="line"></div>
<div class="line">        PPo = 1e5 / atmP;</div>
<div class="line">        Idir = SolarConstant * (pow(alpha,(PPo/CosZenithAngle)));</div>
<div class="line">        Idiff = 0.3 * SolarConstant *(1 - pow(alpha,(PPo/CosZenithAngle))) * CosZenithAngle ;</div>
<div class="line"></div>
<div class="line">        propIdir = Idir / (Idir + Idiff);</div>
<div class="line">        propIdiff = Idiff / (Idir + Idiff);</div>
<div class="line">        </div>
<div class="line">        canopy-&gt;<a class="code" href="structcanopy.html#ae9da79a864273ae0b9f186593ec33766">Idirtop</a>=propIdir*solarR;</div>
<div class="line">        canopy-&gt;<a class="code" href="structcanopy.html#aedddaa0b7079a117ba6f8cfd64eb5ca1">Idifftop</a>= propIdiff*solarR ;</div>
<div class="line">        canopy-&gt;<a class="code" href="structcanopy.html#ad29629692a0d9d13f09a05f94789c47d">CosZenithAngle</a> =CosZenithAngle;</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a962f1edaba4e3276bcf5e5b4be25055a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getcanopyLNprof </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcanopy.html">canopy</a> *&#160;</td>
          <td class="paramname"><em>canopy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LeafN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kpLN</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L263">263</a> of file <a class="el" href="">AuxwillowGro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="comment">/*******************************************************************</span></div>
<div class="line"><span class="comment">   * This function calculates Leaf N distrivution of different canopy layers</span></div>
<div class="line"><span class="comment">   * Leaf N will subsequently be used in calculation of photosynthesis parameters</span></div>
<div class="line"><span class="comment">   * Input parameters</span></div>
<div class="line"><span class="comment">   * Leaf N: Leaf N at the top of the canopy</span></div>
<div class="line"><span class="comment">   * kpLN: Extinction coefficient for exponential decline in leaf N with LAI</span></div>
<div class="line"><span class="comment">   * ************************************************************************/</span></div>
<div class="line">   </div>
<div class="line">   </div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <span class="keywordtype">double</span> leafNla,CumLAI;</div>
<div class="line"></div>
<div class="line">        CumLAI=0.0;</div>
<div class="line">        <span class="keywordflow">for</span>(i=0;i&lt;(canopy-&gt;<a class="code" href="structcanopy.html#ac849e7160ff1d625eaac54c5b8992db0">Nlayers</a>);i++)</div>
<div class="line">        {</div>
<div class="line">                canopy-&gt;<a class="code" href="structcanopy.html#adf45b4b4621ef960d8fe7536e839834e">Leaf</a>[i].<a class="code" href="structcanopy_leaf.html#ab2e1f98b44db7479f97be119766270ef">LeafN</a>= LeafN * exp(-kpLN * CumLAI);</div>
<div class="line">                CumLAI = CumLAI+canopy-&gt;<a class="code" href="structcanopy.html#adf45b4b4621ef960d8fe7536e839834e">Leaf</a>[i].<a class="code" href="structcanopy_leaf.html#af2896a94dc4bf29566d632587e9c54f1">LAI</a>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ac827965d6919349d51719e982298f72e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getcanopyRHprof </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcanopy.html">canopy</a> *&#160;</td>
          <td class="paramname"><em>canopy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RH</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L244">244</a> of file <a class="el" href="">AuxwillowGro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">       <span class="keywordtype">int</span> i;</div>
<div class="line">        <span class="keywordtype">double</span> kh, hsla, j;</div>
<div class="line"></div>
<div class="line">        kh = 1 - RH;</div>
<div class="line">       </div>
<div class="line">        <span class="keywordflow">for</span>(i=0;i&lt;(canopy-&gt;<a class="code" href="structcanopy.html#ac849e7160ff1d625eaac54c5b8992db0">Nlayers</a>);i++)</div>
<div class="line">        {</div>
<div class="line">                j = i + 1;</div>
<div class="line">                hsla = RH * exp(kh * (j/canopy-&gt;<a class="code" href="structcanopy.html#ac849e7160ff1d625eaac54c5b8992db0">Nlayers</a>));</div>
<div class="line"><span class="comment">//              /*hsla = RH * exp(-kh * (j/nlayers));  /*new simpler version from Joe Iverson*/</span></div>
<div class="line">                <span class="keywordflow">if</span>(hsla &gt; 1) hsla = 0.99; </div>
<div class="line">                canopy-&gt;<a class="code" href="structcanopy.html#a0350fe373203592057a8eba790733c4e">ENV</a>[i].<a class="code" href="structcanopy_env.html#a19532976fea010b59d78084cb47e79b0">RH</a> = hsla;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="af5829d0791e03458b6fa02f8c5b50989"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getCanopysunML </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcanopy.html">canopy</a> *&#160;</td>
          <td class="paramname"><em>canopy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>chil</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>heightf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L167">167</a> of file <a class="el" href="">AuxwillowGro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">  <span class="comment">/****************************************************************************************************</span></div>
<div class="line"><span class="comment">   * Purpose:</span></div>
<div class="line"><span class="comment">   * Calculate fraction of shaded and sunlit leaves  in each of the canopy layers</span></div>
<div class="line"><span class="comment">   * Also, Calculate Direct, diffused and Scattered Light for each of the canopy layer</span></div>
<div class="line"><span class="comment">   * </span></div>
<div class="line"><span class="comment">   * Input</span></div>
<div class="line"><span class="comment">   * Direct Sun Light at the Top of the Canopy</span></div>
<div class="line"><span class="comment">   * Diffused Light at the TOp of the Canopy</span></div>
<div class="line"><span class="comment">   * LAI Total Leaf Area Index of the Canopy</span></div>
<div class="line"><span class="comment">   * Nlayers Number of Canopy Layers</span></div>
<div class="line"><span class="comment">   * cosTheta: Cosine of Zenith Angel</span></div>
<div class="line"><span class="comment">   * Chil: Factor determining leaf angle distribtion of the canopy</span></div>
<div class="line"><span class="comment">   * heightF: Height Factor of the Canopy</span></div>
<div class="line"><span class="comment">   * </span></div>
<div class="line"><span class="comment">   * Output</span></div>
<div class="line"><span class="comment">   * Fraction of Sunlit Leaves in Each Layer</span></div>
<div class="line"><span class="comment">   * Fraction of Shaded leaves in Each layer</span></div>
<div class="line"><span class="comment">   * Amount of Light (Direct + Diffuses+Scattered) on the sunlit leaves of each layer</span></div>
<div class="line"><span class="comment">   * Amount of Light (Diffused+Scattered) on the shaded leaves of each layer</span></div>
<div class="line"><span class="comment">   * *****************************************************************************************/</span></div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <span class="keywordtype">double</span> k0, k1, k;</div>
<div class="line">        <span class="keywordtype">double</span> LAIi, CumLAI;</div>
<div class="line">        <span class="keywordtype">double</span> Isolar, Idiffuse, Ibeam, Iscat, Itotal,alphascatter;</div>
<div class="line">        <span class="keywordtype">double</span> Ls, Ld;</div>
<div class="line">        <span class="keywordtype">double</span> Fsun, Fshade;</div>
<div class="line">        alphascatter=0.8;</div>
<div class="line">        k0 = sqrt(pow(chil ,2) + pow(tan(acos(canopy-&gt;<a class="code" href="structcanopy.html#ad29629692a0d9d13f09a05f94789c47d">CosZenithAngle</a>)),2));</div>
<div class="line">        k1 = chil + 1.744*pow((chil+1.183),-0.733);</div>
<div class="line">        k = k0/k1;</div>
<div class="line">        <span class="keywordflow">if</span>(k&lt;0)</div>
<div class="line">                k = -k;</div>
<div class="line"></div>
<div class="line">        LAIi = canopy-&gt;<a class="code" href="structcanopy.html#a17cbba40a9200a0b3473cebc58c87f3b">LAItotal</a> / canopy-&gt;<a class="code" href="structcanopy.html#ac849e7160ff1d625eaac54c5b8992db0">Nlayers</a>;</div>
<div class="line"></div>
<div class="line">        <span class="keywordflow">for</span>(i=0;i&lt;canopy-&gt;<a class="code" href="structcanopy.html#ac849e7160ff1d625eaac54c5b8992db0">Nlayers</a>;i++)</div>
<div class="line">        {</div>
<div class="line">                CumLAI = LAIi * (i+0.5);          </div>
<div class="line">                Ibeam=canopy-&gt;<a class="code" href="structcanopy.html#ae9da79a864273ae0b9f186593ec33766">Idirtop</a>*canopy-&gt;<a class="code" href="structcanopy.html#ad29629692a0d9d13f09a05f94789c47d">CosZenithAngle</a>;</div>
<div class="line">                Iscat = Ibeam * exp(-k *sqrt(alphascatter)* CumLAI)-Ibeam * exp(-k * CumLAI);     </div>
<div class="line">                Isolar = Ibeam*k;</div>
<div class="line">                Idiffuse = canopy-&gt;<a class="code" href="structcanopy.html#aedddaa0b7079a117ba6f8cfd64eb5ca1">Idifftop</a> * exp(-kd * CumLAI) + Iscat;                </div>
<div class="line">                Ls = (1-exp(-k*LAIi))*exp(-k*CumLAI)/k;</div>
<div class="line">                Ld=LAIi-Ls;</div>
<div class="line">                Fsun=Ls/(Ls+Ld);</div>
<div class="line">                Fshade=Ld/(Ls+Ld);</div>
<div class="line">                canopy-&gt;<a class="code" href="structcanopy.html#adf45b4b4621ef960d8fe7536e839834e">Leaf</a>[i].<a class="code" href="structcanopy_leaf.html#affd2258e348a38ff904bcda150fc3a31">pLeafsun</a>=Fsun;</div>
<div class="line">                canopy-&gt;<a class="code" href="structcanopy.html#adf45b4b4621ef960d8fe7536e839834e">Leaf</a>[i].<a class="code" href="structcanopy_leaf.html#a27667cdee7bbfb679803cf36256c4cd5">pLeafshade</a>=Fshade;</div>
<div class="line">                canopy-&gt;<a class="code" href="structcanopy.html#adf45b4b4621ef960d8fe7536e839834e">Leaf</a>[i].<a class="code" href="structcanopy_leaf.html#a6f4001fadc078e666bce2ddd7676fff5">heightf</a> = CumLAI/heightf;</div>
<div class="line">                <span class="comment">/*fraction intercepted*/</span></div>
<div class="line">                Itotal =(Fsun*Isolar + Idiffuse) * (1-exp(-k*LAIi))/k;</div>
<div class="line">                <span class="comment">/* collecting the results */</span></div>
<div class="line">                canopy-&gt;<a class="code" href="structcanopy.html#a0350fe373203592057a8eba790733c4e">ENV</a>[i].<a class="code" href="structcanopy_env.html#a517a3f4381501a07eaf435abaf505036">Idir</a>= Isolar+Idiffuse ;</div>
<div class="line">                canopy-&gt;<a class="code" href="structcanopy.html#a0350fe373203592057a8eba790733c4e">ENV</a>[i].<a class="code" href="structcanopy_env.html#a7b44f9b02093a720da43213e4230466b">Idiff</a> = Idiffuse;</div>
<div class="line">                canopy-&gt;<a class="code" href="structcanopy.html#a0350fe373203592057a8eba790733c4e">ENV</a>[i].<a class="code" href="structcanopy_env.html#ab1547ef7e75f10b8c575b5301aaee5f4">Itotal</a> = Itotal;                </div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ae42513b789aea0a0523e01aa6e757f35"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void getcanopyWINDprofile </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structcanopy.html">canopy</a> *&#160;</td>
          <td class="paramname"><em>canopy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>WindSpeed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L229">229</a> of file <a class="el" href="">AuxwillowGro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">        <span class="keywordtype">int</span> i;</div>
<div class="line">        <span class="keywordtype">double</span> k=0.7;</div>
<div class="line">        <span class="keywordtype">double</span> CumLAI;</div>
<div class="line">        </div>
<div class="line">          CumLAI=0.0;</div>
<div class="line">        <span class="keywordflow">for</span>(i=0;i&lt;(canopy-&gt;<a class="code" href="structcanopy.html#ac849e7160ff1d625eaac54c5b8992db0">Nlayers</a>);i++)</div>
<div class="line">        {</div>
<div class="line">               canopy-&gt;<a class="code" href="structcanopy.html#a0350fe373203592057a8eba790733c4e">ENV</a>[i].<a class="code" href="structcanopy_env.html#a44364bb96e8d72080f9e82fb0325d6aa">windspeed</a>= WindSpeed * exp(-k * CumLAI);</div>
<div class="line">               CumLAI+=canopy-&gt;<a class="code" href="structcanopy.html#adf45b4b4621ef960d8fe7536e839834e">Leaf</a>[i].<a class="code" href="structcanopy_leaf.html#af2896a94dc4bf29566d632587e9c54f1">LAI</a>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span>;</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="a5a18f68430b9e6ed1be3d294b179f8a6"></a>
<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">struct <a class="el" href="struct_can___str.html">Can_Str</a> newc3CanAC </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>LAI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>DOY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>hr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>solarR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Temp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>RH</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>WindSpeed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>nlayers</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Vmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Jmax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Rd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>Catm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>o2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>b1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>heightf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>leafN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>kpLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lnb1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>lnfun</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>StomWS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>ws</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">read</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="#L442">442</a> of file <a class="el" href="">AuxwillowGro.c</a>.</p>
<div class="fragment"><div class="line">{</div>
<div class="line"></div>
<div class="line">   <span class="keyword">struct </span><a class="code" href="struct_e_t___str.html">ET_Str</a> deepaktmp5_ET,deepaktmp6_ET; </div>
<div class="line">   <span class="keyword">struct </span><a class="code" href="structc3__str.html">c3_str</a> deepaktmpc3;</div>
<div class="line">   <span class="keyword">struct </span><a class="code" href="structc3__str.html">c3_str</a> deepaktmpc32;</div>
<div class="line">   <span class="keyword">struct </span><a class="code" href="struct_can___str.html">Can_Str</a> ans;</div>
<div class="line"></div>
<div class="line"></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> cf = 3600 * 1e-6 * 30 * 1e-6 * 10000;</div>
<div class="line"><span class="comment">/* Need a different conversion factor for transpiration */</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> cf2 = 3600 * 1e-3 * 18 * 1e-6 * 10000; </div>
<div class="line">        </div>
<div class="line">  <span class="keywordtype">int</span> i;</div>
<div class="line">  <span class="keywordtype">double</span> TempIdir,TempIdiff;</div>
<div class="line">  <span class="keywordtype">double</span> Leafsun, Leafshade;</div>
<div class="line"></div>
<div class="line">  <span class="keywordtype">double</span> CanopyA = 0.0;</div>
<div class="line">  <span class="keywordtype">double</span> GCanopyA = 0.0;</div>
<div class="line">  <span class="keywordtype">double</span> CanopyT =0.0;;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">double</span> CanHeight=0.0;;</div>
<div class="line">  <span class="keywordtype">double</span> chil =0.0;</div>
<div class="line"></div>
<div class="line">   <span class="keywordtype">double</span> vmax1;</div>
<div class="line"><span class="comment">//  double leafN_lay;</span></div>
<div class="line">  </div>
<div class="line"> <span class="comment">/* double StomWS;</span></div>
<div class="line"><span class="comment"> /* int ws;</span></div>
<div class="line"><span class="comment"></span></div>
<div class="line"><span class="comment">        /* For Assimilation */</span></div>
<div class="line">        <span class="comment">/* 3600 converts seconds to hours */</span></div>
<div class="line">        <span class="comment">/* 1e-6 converts micro mols to mols */</span></div>
<div class="line">        <span class="comment">/* 30 is the grams in one mol of CO2 */</span></div>
<div class="line">        <span class="comment">/* 1e-6 converts g to Mg */</span></div>
<div class="line">        <span class="comment">/* 10000 scales from meter squared to hectare */</span></div>
<div class="line"></div>
<div class="line">        <span class="comment">/* For Transpiration */</span></div>
<div class="line">        <span class="comment">/* 3600 converts seconds to hours */</span></div>
<div class="line">        <span class="comment">/* 1e-3 converts mili mols to mols */</span></div>
<div class="line">        <span class="comment">/* 18 is the grams in one mol of H20 */</span></div>
<div class="line">        <span class="comment">/* 1e-6 converts g to Mg */</span></div>
<div class="line">        <span class="comment">/* 10000 scales from meter squared to hectare */</span></div>
<div class="line"></div>
<div class="line">  <span class="keyword">struct </span><a class="code" href="structcanopy.html">canopy</a> ccanopy;</div>
<div class="line">  <a class="code" href="_auxwillow_gro_8c.html#ac76a61a6bb1df6d8edfcf84ef826c32c">createCanopy</a> (&amp;ccanopy,nlayers, LAI);  </div>
<div class="line">  <a class="code" href="_auxwillow_gro_8c.html#a6227c845c706959b38921e90ec099311">discretizeCanopy</a>(&amp;ccanopy);</div>
<div class="line">  </div>
<div class="line">  <a class="code" href="_auxwillow_gro_8c.html#a5b569d4b9b8006b06c35d0aee5ec51ea">getcanopylightme</a>(&amp;ccanopy,lat, DOY,hr,solarR);</div>
<div class="line">  <a class="code" href="_auxwillow_gro_8c.html#af5829d0791e03458b6fa02f8c5b50989">getCanopysunML</a>(&amp;ccanopy,kd,chil,heightf);</div>
<div class="line">  <a class="code" href="_auxwillow_gro_8c.html#ac827965d6919349d51719e982298f72e">getcanopyRHprof</a>(&amp;ccanopy, RH);</div>
<div class="line">  <a class="code" href="_auxwillow_gro_8c.html#ae42513b789aea0a0523e01aa6e757f35">getcanopyWINDprofile</a>(&amp;ccanopy,WindSpeed);</div>
<div class="line">  <a class="code" href="_auxwillow_gro_8c.html#a962f1edaba4e3276bcf5e5b4be25055a">getcanopyLNprof</a>(&amp;ccanopy,leafN,kpLN);</div>
<div class="line"></div>
<div class="line">      <span class="keywordflow">for</span>(i=0;i&lt;(ccanopy.Nlayers);i++)</div>
<div class="line">    {</div>
<div class="line">            <span class="keywordflow">if</span>(lnfun == 0){</div>
<div class="line">                    vmax1 = Vmax;</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span>{</div>
<div class="line">                    vmax1 = ccanopy.Leaf[i].LeafN * lnb1 + lnb0;</div>
<div class="line">            } </div>
<div class="line">     </div>
<div class="line">            Leafsun = ccanopy.Leaf[i].LAI *ccanopy.Leaf[i].pLeafsun;</div>
<div class="line">   </div>
<div class="line">      deepaktmp5_ET= <a class="code" href="_auxwillow_gro_8h.html#a14fc4c1327518e9237f587b37400ac97">c3EvapoTrans</a>(ccanopy.ENV[i].Idir,ccanopy.ENV[i].Itotal,Temp,ccanopy.ENV[i].RH,ccanopy.ENV[i].windspeed,ccanopy.Leaf[i].LAI,ccanopy.Leaf[i].heightf,</div>
<div class="line">                                                   Vmax,Jmax,Rd,b0,b1,Catm,o2,theta);</div>
<div class="line">            TempIdir = Temp + deepaktmp5_ET.Deltat;</div>
<div class="line">      ccanopy.OUT[i].sunlittemp=TempIdir;</div>
<div class="line">      ccanopy.OUT[i].sunlitTranspiration=deepaktmp5_ET.TransR;</div>
<div class="line">     </div>
<div class="line">      deepaktmpc3 = <a class="code" href="c3photo_8c.html#ad30b1a99fb440301345822cb38fb5cbe">c3photoC</a>(ccanopy.ENV[i].Idir,ccanopy.OUT[i].sunlittemp,ccanopy.ENV[i].RH,Vmax,Jmax,Rd,b0,b1,Catm,o2,theta,StomWS,ws);</div>
<div class="line">            ccanopy.OUT[i].sunlitAnet=deepaktmpc3.Assim;</div>
<div class="line">      ccanopy.OUT[i].sunlitAgross=deepaktmpc3.GrossAssim;</div>
<div class="line"><span class="comment">//      Rprintf(&quot;%f, %f,%f\n&quot;,deepaktmpc3.Assim,deepaktmpc3.GrossAssim,ccanopy.ENV[i].Idir);</span></div>
<div class="line"></div>
<div class="line">            Leafshade = ccanopy.Leaf[i].LAI *ccanopy.Leaf[i].pLeafshade;</div>
<div class="line">      deepaktmp6_ET=<a class="code" href="_auxwillow_gro_8h.html#a14fc4c1327518e9237f587b37400ac97">c3EvapoTrans</a>(ccanopy.ENV[i].Idiff,ccanopy.ENV[i].Itotal,Temp,ccanopy.ENV[i].RH,ccanopy.ENV[i].windspeed,ccanopy.Leaf[i].LAI,ccanopy.Leaf[i].heightf,</div>
<div class="line">                 Vmax,Jmax,Rd,b0,b1,Catm,o2,theta);</div>
<div class="line">      TempIdiff=Temp + deepaktmp6_ET.Deltat;</div>
<div class="line">      ccanopy.OUT[i].shadedtemp=TempIdiff;</div>
<div class="line">      ccanopy.OUT[i].shadedTranspiration=deepaktmp6_ET.TransR;</div>
<div class="line">      deepaktmpc32=<a class="code" href="c3photo_8c.html#ad30b1a99fb440301345822cb38fb5cbe">c3photoC</a>(ccanopy.ENV[i].Idiff,ccanopy.OUT[i].shadedtemp,ccanopy.ENV[i].RH,Vmax,Jmax,Rd,b0,b1,Catm,o2,theta,StomWS,ws);</div>
<div class="line">            ccanopy.OUT[i].shadedAnet=deepaktmpc32.Assim;</div>
<div class="line">      ccanopy.OUT[i].shadedAgross=deepaktmpc32.GrossAssim;</div>
<div class="line">      </div>
<div class="line">     ccanopy.OUT[i].TotalAnet =Leafsun* ccanopy.OUT[i].sunlitAnet + Leafshade*ccanopy.OUT[i].shadedAnet;</div>
<div class="line">     ccanopy.OUT[i].TotalAgross=Leafsun* ccanopy.OUT[i].sunlitAgross + Leafshade*ccanopy.OUT[i].shadedAgross;</div>
<div class="line">     ccanopy.OUT[i].TotalTrans =Leafsun* ccanopy.OUT[i].sunlitTranspiration + Leafshade*ccanopy.OUT[i].shadedTranspiration;</div>
<div class="line">    </div>
<div class="line">   </div>
<div class="line">                 CanopyA = CanopyA + ccanopy.OUT[i].TotalAnet;</div>
<div class="line">                 GCanopyA =GCanopyA+ ccanopy.OUT[i].TotalAgross;</div>
<div class="line">     CanopyT = GCanopyA+ ccanopy.OUT[i].TotalTrans;</div>
<div class="line"><span class="comment">//     Rprintf(&quot;Inside Layers: net= %f, Gross=%f \n&quot;,ccanopy.OUT[i].TotalAnet,ccanopy.OUT[i].TotalAgross);</span></div>
<div class="line">        }</div>
<div class="line">        <span class="comment">/*## These are micro mols of CO2 per m2 per sec for Assimilation</span></div>
<div class="line"><span class="comment">          ## and mili mols of H2O per m2 per sec for Transpiration</span></div>
<div class="line"><span class="comment">          ## Need to convert to </span></div>
<div class="line"><span class="comment">          ## 3600 converts seconds to hours</span></div>
<div class="line"><span class="comment">          ## 10^-6 converts micro mols to mols</span></div>
<div class="line"><span class="comment">          ## 30 converts mols of CO2 to grams</span></div>
<div class="line"><span class="comment">          ## (1/10^6) converts grams to Mg</span></div>
<div class="line"><span class="comment">          ## 10000 scales up to ha */</span></div>
<div class="line"><span class="comment">/* A similar conversion is made for water but</span></div>
<div class="line"><span class="comment">   replacing 30 by 18 and mili mols are converted to</span></div>
<div class="line"><span class="comment">   mols (instead of micro) */</span></div>
<div class="line"> </div>
<div class="line">        ans.Assim = cf * CanopyA ;</div>
<div class="line">  ans.Trans= cf2 * CanopyT; </div>
<div class="line">  ans.GrossAssim=cf*GCanopyA;</div>
<div class="line"><span class="comment">//   Rprintf(&quot;output;-Net Assimilation = %f, Gross Assimilation = %f \n&quot;, CanopyA,GCanopyA );</span></div>
<div class="line"><span class="comment">//  Rprintf(&quot;returning structure;-Net Assimilation = %f, Gross Assimilation = %f \n&quot;, ans.Assim, ans.GrossAssim);</span></div>
<div class="line">        <span class="keywordflow">return</span>(ans);</div>
<div class="line">}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="_auxwillow_gro_8c.html">AuxwillowGro.c</a></li>
    <li class="footer">Generated on Wed Jan 22 2014 09:27:25 for BioCro by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.1.2 </li>
  </ul>
</div>
</body>
</html>
