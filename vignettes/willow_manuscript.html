<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Title: Predict short rotation coppice willow (Salix spp.) production in contiguous US</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>




</head>

<body>
<h1>Title: Predict short rotation coppice willow (Salix spp.) production in contiguous US</h1>

<p>Authors: </p>

<ul>
<li>Wang, Jaiswal, LeBauer, </li>
<li>(Wertin, Leakey, your name here ?), </li>
<li>Long</li>
</ul>

<h2>Abstract</h2>

<p>The cultivation of fast-growing willow (Salix spp.) within short rotation coppice (SRC) can provide a potentially sustainable energy source which can decrease net greenhouse gas emission. Predictions of willow growth under various growing conditions, soils and climates are critical to evaluate the feasibility of its production in different environments. Previous mathematical models which can accurately predict willow biomass potential under different conditions estimate biomass growth using a concept of radiation use efficiency (RUE), which is based on simple diurnal representation of environmental factors without much consideration given to biochemical and biophysical characteristics of plants.  </p>

<p>Here, we described in detail the biochemical and physiological processes of a previously published generic mechanistic eco-physiological model, BioCro, which was adapted and developed from WIMOVAC. BioCro was parameterized for willow in coppicing subroutine, perennating, leaf-photosynthesis, canopy CO2 assimilation, allocation, phenology and growth. The model was able to realistically predict biomass yield at a range of 16 sites from European studies and 3 sites from US studies. The regional projection suggests that willow yield varies considerably with differences in soil and climate, and reaching as much as 52 Mg ha-1 in Eastern, the upper Midwest and New England regions after 3-year growth. This study provides forest managers and policy makers with a process-based modeling approach to estimate the yield potential of willow for a given climate and soil and thus could guide further research, policy and management decisions.</p>

<h2>Introduction</h2>

<p>As a renewable energy source, bioenergy benefit the society with a secure and sustainale energy supply and the potential to reduce the use of fossil fuels and thus the greenhouse gas emissions (Somerville et al. 2010). In the US the Advanced Energy Initiative (AEI) mandates that renewable bioethanol displace 30% of 2005 petroleum use in the transportation sector by 2030 (Milliken et al. 2007). To meet that goal, the AEI supports the production of ethanol from cellulose and hemi-cellulose from perennial grasses, wood chips, and agricultural residues which could reduce the conflict between food and fuel (Heaton et al. 2008; Somerville et al. 2010; Wang et al. 2010, 2012). Woody species managed in a short rotation coppicing (SRC) system have advantages over first generation annual crops in enhanced biological diversity (Rowe et al. 2009) and carbon sequestration (Baum et al. 2009; Don et al. 2011), and reduced need for annual inputs of labor, pesticides and fertilization, which minimizes the use of fossil fuels during production and improve the overall energy balance of woody species as biofuel (Hill et al. 2006). </p>

<p>Hybrid willows are among the most widely cultivated hardwood species for its rapid growth rate, ease of resprouting and ability to adapt to a wide variety of soils (Mead 2005). These crops typically are coppiced on a 3-5 yr rotation cycle and remain viable for 15-30 yr (Aylott et al. 2008). Willow yield varied considerably across different climates, soils and also depended on the choice of genotypes and management. A review of historic data (available at the Biofuel Ecophysiological Traits and Yield Database (BETY-db) at <a href="http://www.ebi-forecast.igb.uiuc.edu">www.ebi-forecast.igb.uiuc.edu</a>) indicated that willow has a mean annual yield of 7.3 (n=349, sd=4.5) Mg ha-1yr-1 when averaged globally, with field trials of willow plantations mostly reported from the Europe (Nordh et al. 2004; Aylott et al. 2008) and few from the US (Volk et al. 2011; Randall et al. 2010). Currently willow is not commercially planted at large scale in the United States, being limited mostly to experimental plots. Since yield data are critical to the development of the secondary bioenergy industry and little is known of how these crops will perform in the US at a spatial scale, it is fundamentally important to provide clear and concise predictions regarding the spatial characteristics of willow biomass productivity. Therefore there is an urgent need for the development and parameterization of process-based crop models that can provide reliable predictions of carbon assimilation, growth and yield at spatial scales ranging from site to regional. In the present study, we predict yield potentials of willow for regions within the coterminous United States and suggest management under different soil properties and climate conditions.</p>

<p>Previous empirical models using partial least squares regression between yields with multiple driving factors including soil chemical composition, diurnal temperature range and seasonal climatic variations, has been shown effective for simulating willow yield (Aylott et al. 2010). Another simple analytical gap probability model by improving the Lambert-Beer’s law well represented the light-plant interaction for four different willow varieties (Cerasuolo et al. 2013).These models are appealing due to their simplicity by their design but tend to ignore detailed description of processes driving photosynthesis and resource usages and hard to provide insights into the linkages between climate change scenarios and productivity. To evaluate and fully understand the physiological, biophysical and physical processes, a process-based model for plant growth which considers leaf dynamics (leaf phenology and leaf area duration) and efficiency in carbon fixation and photosynthesis should be more appropriate and efficient in making reasonable yield predictions of newly developed varieties, over a large geospatial region under current and future climate, and with different management regimes. ForestGrowth-SRC was a process-based model which could predict reasonable willow yield compared with measured data (Tallis et al. 2012), however, the coppicing routine was lack in this model and the model was not evaluated in the US climate and soils.</p>

<p>BioCro is a generic plant production model adapted from WIMOVAC, relying on the key physiological and biophysical processes underlying plant production (Humphries &amp; Long, 1995). BioCro has previously been used for predicting biomass yield and LAI of switchgrass and  miscanthus (Miguez et al., 2009) and sugarcane (Jaswel et al. unpublished). This is the first effort to use BioCro to simulate C3 woody plants growth and yield. In this study we predict hybrid willow yield at a national scale under varying growing conditions using BioCro. The specific objectives of the present study are to (1) parameterize BioCro for willow in coppicing subroutine, perennating, leaf-photosynthesis, canopy CO2 assimilation, allocation, phenology and growth; (2) compare model performance to observations from field across diverse areas in the United Kingdom and US (iii) to upscale the model to provide high resolution regional predictions for the US in current and future climatic conditions. 
.</p>

<h2>Model Description</h2>

<p>The sub-models in BioCro have been extensively described elsewhere (Miguetz et al. 2009, Jaiswal et al. unpublished), so the following description will focus on processes and parameters specific to the present study. </p>

<p>Macroclimate
The macroclimate data (i.e. light, temperature, relative humidity, rainfall, and wind speed) were obtained were obtained either from the individual studies, where reported, or from NARR. Day, time, and latitude were used to determine the solar declination and solar zenith angle. Soil textural classes were assigned from published literature or the STATSGO database. </p>

<p>Gas exchange and carbon assimilation
Leaf CO2 uptake rate (A) was predicted from the steady state model of  Farquhar et al. (1980) and von Caemmerer &amp; Farquhar (1981) combined with additions from Long (1991) and Bernacchi et al. (2009). The photosynthesis model coupled with the C3 version of the Ball et al. (1987) stomatal conductance model provides a robust phenomenological description of the stomatal behaviour. To mimic decrease in stomatal conductance (gs) with water stress, a linear relationship was assumed between reduction in A and the decrease of leaf water potential. Using hourly weather records, the model then calculates direct and diffuse light for dynamically changing sunlit and shaded portions of the canopy layers and computes carbon and water exchange with the atmosphere and through the canopy for each hour of the day, each day of the year.
Respiration
Growth respiration is assumed to be a constant proportion to gross photosynthesis. Maintenance respiration is proportional to biomass growth in the leaf, stem, storage and root pools respectively. Temperature dependent maintenance and growth respiration are estimated using a Q10 function and subtracted from gross canopy assimilate to calculate net canopy photosynthesis. </p>

<p>Phenology
The annual cycle of growth is described by four phonological phases as reported by Arora and Boer (2005). They are states of maximum growth, normal growth, leaf fall, and dormancy/no leaves. In winter, deciduous trees are in a dormant/no leaf state until the arrival of favorable weather in spring when the trees enter the maximum growth state and preferred allocation is made to leaves. After leaf-out the normal growth state is attained and assimilated carbon is also allocated to the stem and the roots. The arrival of unfavorable weather conditions in autumn triggers leaf fall, when allocation to leaves ceases but continues to the stem and root. Eventually, there is a reversion to the dormant/no-leaf state until the arrival of favorable weather the next spring. These phenological stages were controlled by thermal periods defined by the sum of average daily temperatures from the start of the growing season. Leaf-out and leaf-off was also controlled by a threshold temperature in spring and fall.</p>

<p>Growth, partitioning and allocation
Daily partitioning of net canopy photosynthate to different plant organs (stem, root, leaf and storage) was dependent on phenological phase, which was triggered by accumulated thermal time. Carbon allocation was determined by dry biomass partitioning coefficients which depend on phenological stages. Thus, by varying these coefficients (-1 to 1), the dynamic source/sink demands of the plant during development were modeled. The total carbon available for growth during a given developmental stage was the total of net photosynthetic assimilation and leaf/storage root remobilization. The new leaf area, stem or root length was simulated based on allocated carbon resources for each tissue and the specific leaf area, specific stem length, and specific root length, respectively. New leaf growth was assumed to occur uniformly with respect to height in the canopy. Constant senescence rates of leaf, stem, and root were included in daily updating of plant biomass. Reduction in leaves due to frost damage was expressed as a fraction of LAI simulated using a linear function of ambient temperature.</p>

<p>Coppicing and perenating
  Coppicing is treated as a removal of 95% the above ground stem biomass, with some portion of the 5% of remaining stem and roots being the storage pool for the next year growth. </p>

<p>Model parameterization 
The C3 photosynthesis parameters (Table 1) were obtained from Farquer et al. (1992) and validated using data from Wang et al. (2013, unpublished) and Bernancchi et al. (2003).
Parameters to model the effects of temperature and water stress on coupled stomatal conductance-photosynthesis at the leaf level are provided in Table 1. Parameters to model canopy CO2 assimilation are provided in Table 2. Parameters to estimate respirations losses were obtained using data from Liu and  Bull (2001).  Parameters for describing phenology and biomass partitioning coefficients determined empirically from the measurements of Beale &amp; Long (1997) in Sweden (citation). With this additional information, the dry biomass partitioning coefficients were obtained (Table). This parameterization showed an acceptable agreement between model simulations and observed dry biomass (Fig. 2). This model was then tested, without further parameter adjustment, against data for the same genotype at eight study sites elsewhere in Europe (Table). For the purpose of model validation, BioCro was used to estimate poplar yield at 17 additional field sites (Table 2). The initial planting density and stem diameter at breast height (DBH) at each site was set using values reported in the literature when available and set to 1 stem/m2 and 1cm, respectively, if not reported. The field trials used in the validation step include diverse climates, soils, and growing conditions across the forested regions of the Europe and US. The species tested in these field trails included over ten hybrid poplars and 3 native species (Coyle et al. 2006; Dowell et al. 2009). Modeled poplar yield was compared to the observed yield of the highest yielding clone and the average yield of multiple clones to evaluate model performance with respect to regional yield estimation. Model calibration was performed with respect to following output variables: (1) stem biomass, (2) leaf biomass, (3) root biomass, (4) leaf litter biomass, and (5) LAI. Leaf litter biomass at the calibration site was estimated using total above ground biomass (Appendix 12). Description of the study site to perform model calibration is provided in Table 3. Initial values for coefficients for dry biomass partitioning. was evaluated for Trichobel (Populus trichocarpa Torr. &amp; A. Gray x P. trichocarpa) and for Joruun (Salix viminalis L. x S. viminalis) based on field measurements from the UK SRC field trials (Armstrong, 1997; Casella &amp; Sinoquet, 2003; Aylott et al., 2008a,b).  The trials (n = 3 plots per site), established with a stocking density of 10000 cuttings ha_1 were designed to generate an extensive database on SRC poplar and willow yields for model developments (Aylott et al., 2008a, 2010). Plots were cut back after a single establishment year to initiate a multistemmed coppice re-growth and there after harvested on a 3- year cycle, as typical for the United Kingdom (DEFRA, 2004). BioCro simulate the establishment year and then simulates a rotation period as what reported in the literature (Table S1). For the purpose of model evaluation monoclonal trial sites were selected, and these trails provided yield data over two 3-year rotations (coppice stool ages of 1–6 years). Of those, seven sites (the intensive sites, Armstrong, 1997) had all suitable soil data and daily weather data to drive the model and were chosen to cover different soil and climate characteristics (Fig. 2; Tables 1 and 2).</p>

<p>2.5 Regional projections under current and future climate change scenarios
    Regional simulations were run for thirteen years (1996-2008) on a half-degree grid over the contiguous US. Soil textural classes were assigned from the STATSGO database and meteorological drivers were obtained from NARR reanalysis data (Mesinger et al. 2006). Initial planting density was 1/m2. To assess the model response to changes in increase in temperature and atmospheric carbon dioxide concentration ([CO2]), yield was also assessed by increasing [CO2] to 550 ppm and results were compared with experimental data from a coppice Free-Air CO2 Enrichment (FACE) experiment (Liberloo et al., 2009). Future climate change scenarios include temperature increase of 1, 2, and 3 ºC above current temperature at ambient (400ppm) and elevated (550ppm) CO2.</p>

<p>2.6 Analysis</p>

<p>WE looked at AGB for the contenental US</p>

<h2>Results</h2>

<p>The predicted photosynthetic assimilation rate and stomatal conductance Salix correlated well with measurements taken in the field for Salix (Wang et al. 2013) (Fig. 1). The field diurnal photosynthetic assimilation rate of three Populus species was closely simulated at 
both ambient (370ppm) and elevated (550ppm) CO2 (Fig.2).</p>

<pre><code class="r">require(ggplot2)
</code></pre>

<pre><code>## Loading required package: ggplot2
</code></pre>

<pre><code class="r">library(BioCro)
</code></pre>

<pre><code>## Loading required package: lattice
</code></pre>

<pre><code class="r">library(latticeExtra)
</code></pre>

<pre><code>## Loading required package: RColorBrewer
</code></pre>

<pre><code>## Attaching package: &#39;latticeExtra&#39;
</code></pre>

<pre><code>## The following object(s) are masked from &#39;package:ggplot2&#39;:
## 
## layer
</code></pre>

<pre><code class="r">library(Agreement)
</code></pre>

<pre><code>## Loading required package: R2HTML
</code></pre>

<pre><code class="r">source(&quot;/home/dwng/willowfigure/validation.R&quot;)
willowaq2011 &lt;- read.csv(&quot;~/biocro/inst/extdata/willowaq2011.csv&quot;, header=T)
Qps &lt;- willowaq2011$PARi
Tls &lt;- willowaq2011$Tleaf
rhs &lt;- willowaq2011$RH_R/100
dat1 &lt;- data.frame(Qp=Qps,Tl=Tls,RH=rhs)
#dat1 &lt;- data.frame(expand.grid(Qp=Qps,Tl=Tls,RH=rhs))
model &lt;- c3photo(dat1$Qp,dat1$Tl,dat1$RH,vcmax=120,Ca=370)
modelassim&lt;- cbind(model$Assim,willowaq2011)

df1=modelassim[,c(&quot;Photo&quot;,&quot;model$Assim&quot;)]
names(df1)=c(&quot;x&quot;,&quot;y&quot;)

lm_eqn = function(df1){
  m = lm(y ~ x, df1);
  eq &lt;- substitute(italic(y) == a + b %.% italic(x)*&quot;,&quot;~~italic(r)^2~&quot;=&quot;~r2,
                   list(a = format(coef(m)[1], digits = 2), 
                        b = format(coef(m)[2], digits = 2), 
                        r2 = format(summary(m)$r.squared, digits = 2)))
  #p = format(summary(m)$coefficients[8],digits=2))
  as.character(as.expression(eq));                 
}

rassim &lt;-ggplot(modelassim,aes(Photo,model$Assim))+geom_point(size=3,alpha=0.75)+stat_smooth(method=&quot;lm&quot;)+
  scale_x_continuous(expression(paste(&quot;Observed assimilation (&quot;,
                 mu,mol,&quot; &quot;,m^-2,&quot; &quot;,s^-1,&quot;)&quot;))) + # have tick marks for each session
  scale_y_continuous(expression(paste(&quot;Modelled assimilation (&quot;,
                                      mu,mol,&quot; &quot;,m^-2,&quot; &quot;,s^-1,&quot;)&quot;))) +# rescale Y axis slightly
  theme_bw() + # make the theme black-and-white rather than grey (do this before font changes, or it overrides them)
  opts(#title = &quot;Observed vs modeled net carbon assimilation&quot;,
    #plot.title = theme_text(face=&quot;bold&quot;, size=14), # use theme_get() to see available options
    axis.title.x = theme_text(face=&quot;bold&quot;, size=12),
    axis.title.y = theme_text(face=&quot;bold&quot;, size=12, angle=90),
    panel.grid.major = theme_blank(), # switch off major gridlines
    panel.grid.minor = theme_blank() # switch off minor gridlines
    )
</code></pre>

<pre><code>## &#39;opts&#39; is deprecated. Use &#39;theme&#39; instead. (Deprecated; last used in
## version 0.9.1)
</code></pre>

<pre><code>## theme_text is deprecated. Use &#39;element_text&#39; instead. (Deprecated; last
## used in version 0.9.1)
</code></pre>

<pre><code>## theme_text is deprecated. Use &#39;element_text&#39; instead. (Deprecated; last
## used in version 0.9.1)
</code></pre>

<pre><code>## &#39;theme_blank&#39; is deprecated. Use &#39;element_blank&#39; instead. (Deprecated;
## last used in version 0.9.1)
</code></pre>

<pre><code>## &#39;theme_blank&#39; is deprecated. Use &#39;element_blank&#39; instead. (Deprecated;
## last used in version 0.9.1)
</code></pre>

<pre><code class="r">rassim &lt;- rassim+geom_text(aes(x =8, y = 22, label = lm_eqn(df1)), parse = TRUE,colour=&quot;black&quot;)+geom_text(aes(x=2,y=30,label=&quot;A&quot;))

modelgs&lt;- cbind(model$Gs/1000,willowaq2011)
df2=modelgs[,c(&quot;Cond&quot;,&quot;model$Gs/1000&quot;)][1:9,]
names(df2)=c(&quot;x&quot;,&quot;y&quot;)

lm_eqn = function(df2){
  m = lm(y ~ x, df2);
  eq &lt;- substitute(italic(y) == a + b %.% italic(x)*&quot;,&quot;~~italic(r)^2~&quot;=&quot;~r2,
                   list(a = format(coef(m)[1], digits = 2), 
                        b = format(coef(m)[2], digits = 2), 
                        r2 = format(summary(m)$r.squared, digits = 2)))
  #p = format(summary(m)$coefficients[8],digits=2))
  as.character(as.expression(eq));                 
}

rgs &lt;-ggplot(df2,aes(x,y))+geom_point(size=3,alpha=0.75)+stat_smooth(method=&quot;lm&quot;)+
  scale_x_continuous(expression(paste(&quot;Observed stomatal conductance (&quot;,
                                      mol,&quot; &quot;,m^-2,&quot; &quot;,s^-1,&quot;)&quot;))) + # have tick marks for each session
  scale_y_continuous(expression(paste(&quot;Modelled stomatal conductance (&quot;,
                                      mol,&quot; &quot;,m^-2,&quot; &quot;,s^-1,&quot;)&quot;))) +# rescale Y axis slightly
  theme_bw() + # make the theme black-and-white rather than grey (do this before font changes, or it overrides them)
  opts(#title = &quot;Observed vs modeled stomatal conductance&quot;,
    #plot.title = theme_text(face=&quot;bold&quot;, size=14), # use theme_get() to see available options
    axis.title.x = theme_text(face=&quot;bold&quot;, size=12),
    axis.title.y = theme_text(face=&quot;bold&quot;, size=12, angle=90),
    panel.grid.major = theme_blank(), # switch off major gridlines
    panel.grid.minor = theme_blank() # switch off minor gridlines
   )
</code></pre>

<pre><code>## &#39;opts&#39; is deprecated. Use &#39;theme&#39; instead. (Deprecated; last used in
## version 0.9.1)
</code></pre>

<pre><code>## theme_text is deprecated. Use &#39;element_text&#39; instead. (Deprecated; last
## used in version 0.9.1)
</code></pre>

<pre><code>## theme_text is deprecated. Use &#39;element_text&#39; instead. (Deprecated; last
## used in version 0.9.1)
</code></pre>

<pre><code>## &#39;theme_blank&#39; is deprecated. Use &#39;element_blank&#39; instead. (Deprecated;
## last used in version 0.9.1)
</code></pre>

<pre><code>## &#39;theme_blank&#39; is deprecated. Use &#39;element_blank&#39; instead. (Deprecated;
## last used in version 0.9.1)
</code></pre>

<pre><code class="r">rgs &lt;- rgs+geom_text(aes(x =0.17, y = 0.25, label = lm_eqn(df2)), parse = TRUE,colour=&quot;black&quot;)+geom_text(aes(x =0.16, y = 0.31, label = &quot;B&quot;), parse = TRUE,colour=&quot;black&quot;)

jpeg(&quot;../willowfigure/c3photovalidation.jpeg&quot;,width=10,height=5,unit=&#39;in&#39;,res=600)
grid.arrange(rassim,rgs,
             nrow=1,ncol=2)
</code></pre>

<pre><code>## Error: could not find function &quot;grid.arrange&quot;
</code></pre>

<pre><code class="r">dev.off()
</code></pre>

<pre><code>## pdf 
##   2
</code></pre>

<pre><code class="r">

poplar &lt;- read.csv(&quot;~/willowfigure/poplarphotosynthesis.csv&quot;, header=T)
palba=poplar[1:14,]
pnigra=poplar[15:28,]
peura=poplar[29:42,]
Qps &lt;- poplar$par
Tls &lt;- poplar$temp
rhs &lt;- poplar$RH/100
Qps = c(25,70,1400,1100,1900,1800,1850,1750,1700,1200,700,300,145,17)
dat1 &lt;- data.frame(Qp=Qps,Tl=Tls,RH=rhs)
modelpalba370 &lt;- c3photo(dat1$Qp[1:14],dat1$Tl[1:14],dat1$RH[1:14],vcmax=65,Ca=370,jmax=196,Rd=4.3,b1=4)
modelpalba550 &lt;- c3photo(dat1$Qp[1:14],dat1$Tl[1:14],dat1$RH[1:14],vcmax=70,Ca=550,jmax=184,Rd=2.1)
modelpnigra370 &lt;- c3photo(dat1$Qp[15:28],dat1$Tl[15:28],dat1$RH[15:28],vcmax=75,Ca=370,jmax=193,Rd=3.4,b1=4)
modelpnigra550 &lt;- c3photo(dat1$Qp[15:28],dat1$Tl[15:28],dat1$RH[15:28],vcmax=70,Ca=550,jmax=181,Rd=1.1)
modelpeura370 &lt;- c3photo(dat1$Qp[29:42],dat1$Tl[29:42],dat1$RH[29:42],vcmax=80,Ca=370,jmax=188,Rd=3.3,b1=4)
modelpeura550 &lt;- c3photo(dat1$Qp[29:42],dat1$Tl[29:42],dat1$RH[29:42],vcmax=75,Ca=550,jmax=186,Rd=1.1)


alba&lt;- cbind(modelpalba370$Assim,palba)
alba$A550m=modelpalba550$Assim
names(alba)[1]=&quot;A370m&quot;
alba$time=c(5.5,6.8,8.6,9.6,10.8,12.2,13.4,14.5,16,16.7,18.1,19,19.8,20.9)

nigra&lt;- cbind(modelpnigra370$Assim,pnigra)
nigra$A550m=modelpnigra550$Assim
names(nigra)[1]=&quot;A370m&quot;
nigra$time=c(5.5,6.8,8.6,9.6,10.8,12.2,13.4,14.5,16,16.7,18.1,19,19.8,20.9)


eura&lt;- cbind(modelpeura370$Assim,peura)
eura$A550m=modelpeura550$Assim
names(eura)[1]=&quot;A370m&quot;
eura$time=c(5.5,6.8,8.6,9.6,10.8,12.2,13.4,14.5,16,16.7,18.1,19,19.8,20.9)



jpeg(&quot;../willowfigure/c3photovalidation2.jpeg&quot;,width=5,height=15,unit=&#39;in&#39;,res=600)
par(mfrow=c(3,1))
par(mar=c(4,4,2,1))

plot(alba$time,alba$A370,type=&#39;b&#39;,lwd=1,ylab=expression(paste(&quot;Assimilation (&quot;,
                                                                mu,mol,&quot; &quot;,m^-2,&quot; &quot;,s^-1,&quot;)&quot;)),
     ylim=range(-1:40),xlab=&quot;Time (h)&quot;,pch=19,lty=1)
</code></pre>

<pre><code>## Error: could not open file &#39;../willowfigure/c3photovalidation2.jpeg&#39;
</code></pre>

<pre><code class="r">
lines(alba$time,alba$A370m,lty=3,type=&#39;b&#39;,pch=21)
</code></pre>

<pre><code>## Error: plot.new has not been called yet
</code></pre>

<pre><code class="r">lines(alba$time,alba$A550,lty=1,type=&#39;b&#39;,pch=17)
</code></pre>

<pre><code>## Error: plot.new has not been called yet
</code></pre>

<pre><code class="r">lines(alba$time,alba$A550m,lty=3,type=&quot;b&quot;,pch=2)
</code></pre>

<pre><code>## Error: plot.new has not been called yet
</code></pre>

<pre><code class="r">text(x=21,y=38,c(&quot;A&quot;))       
</code></pre>

<pre><code>## Error: plot.new has not been called yet
</code></pre>

<pre><code class="r">
legend(&#39;topleft&#39;,c(&quot;Observed at 370ppm&quot;,&quot;Modelled at 370ppm&quot;,&quot;Observed at 550ppm&quot;,&quot;Modelled at 550ppm&quot;),lty=c(1,3,1,3),pch=c(19,21,17,2),cex=1,lwd=1) 
</code></pre>

<pre><code>## Error: plot.new has not been called yet
</code></pre>

<pre><code class="r">

plot(nigra$time,nigra$A370,type=&#39;b&#39;,lwd=1,ylab=expression(paste(&quot;Assimilation (&quot;,
                                                                mu,mol,&quot; &quot;,m^-2,&quot; &quot;,s^-1,&quot;)&quot;)),
     ylim=range(-1:40),xlab=&quot;Time (h)&quot;,pch=19,lty=1)
</code></pre>

<pre><code>## Error: could not open file &#39;../willowfigure/c3photovalidation2.jpeg&#39;
</code></pre>

<pre><code class="r">
lines(nigra$time,nigra$A370m,lty=3,type=&#39;b&#39;,pch=21)
</code></pre>

<pre><code>## Error: plot.new has not been called yet
</code></pre>

<pre><code class="r">lines(nigra$time,nigra$A550,lty=1,type=&#39;b&#39;,pch=17)
</code></pre>

<pre><code>## Error: plot.new has not been called yet
</code></pre>

<pre><code class="r">lines(nigra$time,nigra$A550m,lty=3,type=&quot;b&quot;,pch=2)
</code></pre>

<pre><code>## Error: plot.new has not been called yet
</code></pre>

<pre><code class="r">text(x=21,y=38,c(&quot;B&quot;))       
</code></pre>

<pre><code>## Error: plot.new has not been called yet
</code></pre>

<pre><code class="r">legend(&#39;topleft&#39;,c(&quot;Observed at 370ppm&quot;,&quot;Modelled at 370ppm&quot;,&quot;Observed at 550ppm&quot;,&quot;Modelled at 550ppm&quot;),lty=c(1,3,1,3),pch=c(19,21,17,2),cex=1,lwd=1) 
</code></pre>

<pre><code>## Error: plot.new has not been called yet
</code></pre>

<pre><code class="r">
plot(eura$time,eura$A370,type=&#39;b&#39;,lwd=1,ylab=expression(paste(&quot;Assimilation (&quot;,
                                                                mu,mol,&quot; &quot;,m^-2,&quot; &quot;,s^-1,&quot;)&quot;)),
     ylim=range(-1:40),xlab=&quot;Time (h)&quot;,pch=19,lty=1)
</code></pre>

<pre><code>## Error: could not open file &#39;../willowfigure/c3photovalidation2.jpeg&#39;
</code></pre>

<pre><code class="r">
lines(eura$time,eura$A370m,lty=3,type=&#39;b&#39;,pch=21)
</code></pre>

<pre><code>## Error: plot.new has not been called yet
</code></pre>

<pre><code class="r">lines(eura$time,eura$A550,lty=1,type=&#39;b&#39;,pch=17)
</code></pre>

<pre><code>## Error: plot.new has not been called yet
</code></pre>

<pre><code class="r">lines(eura$time,eura$A550m,lty=3,type=&quot;b&quot;,pch=2)
</code></pre>

<pre><code>## Error: plot.new has not been called yet
</code></pre>

<pre><code class="r">text(x=21,y=38,c(&quot;C&quot;))       
</code></pre>

<pre><code>## Error: plot.new has not been called yet
</code></pre>

<pre><code class="r">
legend(&#39;topleft&#39;,c(&quot;Observed at 370ppm&quot;,&quot;Modelled at 370ppm&quot;,&quot;Observed at 550ppm&quot;,&quot;Modelled at 550ppm&quot;),lty=c(1,3,1,3),pch=c(19,21,17,2),cex=1,lwd=1) 
</code></pre>

<pre><code>## Error: plot.new has not been called yet
</code></pre>

<pre><code class="r">

dev.off()
</code></pre>

<pre><code>## pdf 
##   2
</code></pre>

<p>At the single plot scale, simulated biomass accumulation allocated to leaf, stem and root closely followed observed measurementts (Lindh et al. 1994).</p>

<pre><code class="r">require(ggplot2)
library(BioCro)
library(latticeExtra)
canwillow &lt;- willowcanopyParms(Sp = 1.1, kd = 0.37, GrowthRespFraction = 0.3)

senwillow &lt;- willowseneParms(senLeaf = 1600, senStem = 5500, senRoot = 5500, 
    senRhiz = 5500, Tfrosthigh = 5, Tfrostlow = 0, leafdeathrate = 5)


phewillow &lt;- willowphenoParms(tp1 = 250, tp2 = 350, tp3 = 900, tp4 = 1200, tp5 = 3939, 
    tp6 = 7000, kStem1 = 0.01, kLeaf1 = 0.98, kRoot1 = 0.01, kRhizome1 = -8e-04, 
    kStem2 = 0.01, kLeaf2 = 0.98, kRoot2 = 0.003, kRhizome2 = 0.007, kStem3 = 0.7, 
    kLeaf3 = 0.15, kRoot3 = 0.045, kRhizome3 = 0.105, kStem4 = 0.7, kLeaf4 = 0.15, 
    kRoot4 = 0.045, kRhizome4 = 0.105, kStem5 = 0.7, kLeaf5 = 1e-05, kRoot5 = 0.15, 
    kRhizome5 = 0.15, kStem6 = 0.7, kLeaf6 = 1e-06, kRoot6 = 0.15, kRhizome6 = 0.15)


soilwillow &lt;- soilParms(phi2 = 2, WiltP = 0.16, wsFun = c(&quot;linear&quot;))
## site 1 for calibration Lindroth et al 1994 planting density is 20000/ha


LAI1988 &lt;- c(1.12349, 4.32988, 7.0629, 4.96791, 1.58874)  #from june to october
LAI1986 &lt;- c(2.41172, 3.61459, 5.22936, 3.28399, 0.499657)  #from june to october
stem1988 &lt;- c(9.58217, 13.4864, 17.3891, 19.3025, 19.3984)
stem1986 &lt;- c(6.19766, 9.19511, 16.6033, 18.2752, 18.3713)
leaf1988 &lt;- c(1.78692, 2.61024, 3.55331, 3.2308, 0.733343)
leaf1986 &lt;- c(1.24298, 3.51604, 5.06361, 4.6804, 2.24378)
root1988 &lt;- c(0, 3.27545, 2.94922, 5.22448, 7.37904)

obs &lt;- data.frame(DAP = c(500, 1000, 1500, 1800, 2200), leaf1986 = leaf1986, 
    leaf1988 = leaf1988, stem1986 = stem1986, stem1988 = stem1988, root1988 = root1988, 
    lai1986 = LAI1986, lai1988 = LAI1988)
# obs &lt;-
# data.frame(DAP=c(1500),leaf1986=max(leaf1986),stem1986=max(stem1986),lai1986=max(LAI1986),leaf1988=max(leaf1988),stem1988=max(stem1988),lai1988=max(LAI1988))
load(&quot;/home/dwng/willowgrowclimate.RData&quot;)
willowgrowclimate[willowgrowclimate$RH &gt; 1, ]$RH &lt;- 1
wet1984 &lt;- willowgrowclimate[willowgrowclimate$year == 1984, ]
wet1985 &lt;- willowgrowclimate[willowgrowclimate$year == 1985, ]
wet1986 &lt;- willowgrowclimate[willowgrowclimate$year == 1986, ]
wet1987 &lt;- willowgrowclimate[willowgrowclimate$year == 1987, ]
wet1988 &lt;- willowgrowclimate[willowgrowclimate$year == 1988, ]

iplant0 &lt;- iwillowParms(iRhizome = 1, iStem = 1, iLeaf = 0, iRoot = 1, ifrRhizome = 0.01, 
    ifrStem = 0.01, ifrLeaf = 0, ifrRoot = 0)
## before coppicing
res0 &lt;- willowGro(wet1984, day1 = 120, dayn = 330, canopyControl = canwillow, 
    willowphenoControl = phewillow, seneControl = senwillow, iPlantControl = iplant0, 
    soilControl = soilwillow)
leaf0 &lt;- max(res0$Leaf, na.rm = T)
stem0 &lt;- res0$Stem[length(res0$Stem)]
root0 &lt;- res0$Root[length(res0$Root)]
rhiz0 &lt;- res0$Rhizome[length(res0$Rhizome)]



## Growing season 1
stem0 = stem0 * 0.05
# day1= wet1985[wet1985$Temp &gt;=6,]$doy[1]
day1 = 120
iplant1 &lt;- iwillowParms(iRhizome = rhiz0, iStem = stem0, iLeaf = 0, iRoot = root0, 
    ifrRhizome = 0.01, ifrStem = 0.01, ifrLeaf = 0, ifrRoot = 0)
res1 &lt;- willowGro(wet1985, day1 = day1, dayn = 330, canopyControl = canwillow, 
    willowphenoControl = phewillow, seneControl = senwillow, iPlantControl = iplant1, 
    soilControl = soilwillow)
stem1 &lt;- res1$Stem[length(res1$Stem)]
root1 &lt;- res1$Root[length(res1$Root)]
rhiz1 &lt;- res1$Rhizome[length(res1$Rhizome)]




stem1 = stem1 * 0.8
## Growing season 2 day1= wet1986[wet1986$Temp &gt;=6,]$doy[1]
day1 = 120
iplant2 &lt;- iwillowParms(iRhizome = rhiz1, iStem = stem1, iLeaf = 0, iRoot = root1, 
    ifrRhizome = 0.01, ifrStem = 0.01, ifrLeaf = 0, ifrRoot = 0)
res2 &lt;- willowGro(wet1986, day1 = day1, dayn = 330, canopyControl = canwillow, 
    willowphenoControl = phewillow, seneControl = senwillow, iPlantControl = iplant2, 
    soilControl = soilwillow)
stem2 &lt;- res2$Stem[length(res2$Stem)]
root2 &lt;- res2$Root[length(res2$Root)]
rhiz2 &lt;- res2$Rhizome[length(res2$Rhizome)]
ans.dat &lt;- as.data.frame(unclass(res2)[1:11])
sel.rows &lt;- seq(1, nrow(ans.dat), length.out = 5)
simDat2 &lt;- ans.dat[sel.rows, c(&quot;ThermalT&quot;, &quot;Stem&quot;, &quot;Leaf&quot;, &quot;Root&quot;, &quot;Rhizome&quot;, 
    &quot;Grain&quot;, &quot;LAI&quot;)]
simDat2$Rhizome = 0
simDat2$Root = 0
simDat2$ThermalT = obs$DAP
simDat2$Leaf = 0
simDat2$LAI = obs$lai1986
simDat2$Stem = obs$stem1986

res = res2
pred1986 = data.frame(doy = res$DayofYear, gdd = round(res$ThermalT, digit = 0), 
    stem = res$Stem, leaf = res$Leaf, LAI = res$LAI, root = res$Root, et = res$SoilEvaporation, 
    soilwater = res$SoilWatCont)
modelled1986 = pred1986[c(906, 1528, 2184, 2582, 3251), ]

# coppicing at jan
stem2 = stem2 * 0.05
# day1= wet1987[wet1987$Temp &gt;=6,]$doy[1]
iplant3 &lt;- iwillowParms(iRhizome = rhiz2, iStem = stem2, iLeaf = 0, iRoot = root2, 
    ifrRhizome = 0.01, ifrStem = 0.01, ifrLeaf = 0, ifrRoot = 0)
res3 &lt;- willowGro(wet1987, day1 = day1, dayn = 330, canopyControl = canwillow, 
    willowphenoControl = phewillow, seneControl = senwillow, iPlantControl = iplant3, 
    soilControl = soilwillow)
stem3 &lt;- res3$Stem[length(res3$Stem)]
root3 &lt;- res3$Root[length(res3$Root)]
rhiz3 &lt;- res3$Rhizome[length(res3$Rhizome)]

stem3 = stem3 * 0.95
# day1= 110
iplant4 &lt;- iwillowParms(iRhizome = rhiz3, iStem = stem3, iLeaf = 0, iRoot = root3, 
    ifrRhizome = 0.01, ifrStem = 0.01, ifrLeaf = 0, ifrRoot = 0)
res4 &lt;- willowGro(wet1988, day1 = day1, dayn = 330, canopyControl = canwillow, 
    willowphenoControl = phewillow, seneControl = senwillow, iPlantControl = iplant4, 
    soilControl = soilwillow)
stem4 &lt;- res4$Stem[length(res4$Stem)]
root4 &lt;- res4$Root[length(res4$Root)]
rhiz4 &lt;- res4$Rhizome[length(res4$Rhizome)]

ans.dat &lt;- as.data.frame(unclass(res4)[1:11])
sel.rows &lt;- seq(1, nrow(ans.dat), length.out = 5)
simDat4 &lt;- ans.dat[sel.rows, c(&quot;ThermalT&quot;, &quot;Stem&quot;, &quot;Leaf&quot;, &quot;Root&quot;, &quot;Rhizome&quot;, 
    &quot;Grain&quot;, &quot;LAI&quot;)]
simDat4$Rhizome = 0
simDat4$Root = 0
simDat4$ThermalT = obs$DAP
simDat4$Leaf = 0
simDat4$LAI = obs$lai1988
simDat4$Stem = obs$stem1988

res = res4
pred1988 = data.frame(doy = res$DayofYear, gdd = round(res$ThermalT, digit = 0), 
    stem = res$Stem, leaf = res$Leaf, LAI = res$LAI, root = res$Root, et = res$SoilEvaporation, 
    soilwater = res$SoilWatCont)
modelled1988 = pred1988[c(872, 1482, 2083, 2474, 3039), ]
obs1986 = data.frame(doy = modelled1986$doy, stem = obs$stem1986, leaf = obs$leaf1986, 
    lai = obs$lai1986)
obs1988 = data.frame(doy = modelled1988$doy, stem = obs$stem1988, leaf = obs$leaf1988, 
    lai = obs$lai1988, root = obs$root1988)

save(modelled1986, modelled1988, obs1986, obs1988, file = &quot;/home/dwng/willowfigure/calibration.RData&quot;)

jpeg(&quot;/home/dwng/willowfigure/calibration529.jpg&quot;, width = 10, height = 5, units = &quot;in&quot;, 
    res = 600)
par(mfrow = c(1, 2))
par(mar = c(4, 4, 2, 1))
plot(modelled1986$doy, modelled1986$stem, type = &quot;b&quot;, lwd = 1, ylab = &quot;Biomass partitioning (Mg/ha)&quot;, 
    ylim = range(1:25), xlab = &quot;Day of Year&quot;, main = &quot;A:first rotation, second year&quot;, 
    pch = 19, lty = 1)

lines(obs1986$doy, obs1986$stem, lty = 3, type = &quot;b&quot;, pch = 21)
lines(modelled1986$doy, modelled1986$leaf, lty = 1, type = &quot;b&quot;, pch = 17)
lines(obs1986$doy, obs1986$leaf, lty = 3, type = &quot;b&quot;, pch = 2)
legend(&quot;topleft&quot;, c(&quot;Modelled stem&quot;, &quot;Observed stem&quot;, &quot;Modelled leaf&quot;, &quot;Observed leaf&quot;), 
    lty = c(1, 3, 1, 3), pch = c(19, 21, 17, 2), cex = 1, lwd = 1)

plot(modelled1988$doy, modelled1988$stem, type = &quot;b&quot;, lwd = 1, ylab = &quot;Biomass partitioning (Mg/ha)&quot;, 
    ylim = range(1:25), xlab = &quot;Day of Year&quot;, main = &quot;B:Second rotation, second year&quot;, 
    pch = 19, lty = 1)

lines(obs1988$doy, obs1988$stem, lty = 3, type = &quot;b&quot;, pch = 21)
lines(modelled1988$doy, modelled1988$leaf, lty = 1, type = &quot;b&quot;, pch = 17)
lines(obs1988$doy, obs1988$leaf, lty = 3, type = &quot;b&quot;, pch = 2)
lines(modelled1988$doy, modelled1988$root, lty = 1, type = &quot;b&quot;, pch = 15)
lines(obs1988$doy[4:5], obs1988$root[4:5], lty = 3, type = &quot;b&quot;, pch = 0)

legend(&quot;topleft&quot;, c(&quot;Modelled stem&quot;, &quot;Observed stem&quot;, &quot;Modelled leaf&quot;, &quot;Observed leaf&quot;, 
    &quot;Modelled root&quot;, &quot;Observed root&quot;), lty = c(1, 3, 1, 3, 1, 3), pch = c(19, 
    21, 17, 2, 15, 0), cex = 1, lwd = 1)
dev.off()
</code></pre>

<pre><code>## pdf 
##   2
</code></pre>

<p>The modelin gof above ground biomass partitioning agreeed with the reported data (Proe et al.2002) (Table).The close agreet between simulated and observed data was observed in studies in both Europe and the US, suggesting that the model was albe to account for the variability in envrionmental conditions.</p>

<pre><code class="r">require(ggplot2)
library(BioCro)
library(latticeExtra)
</code></pre>

<pre><code class="r">require(ggplot2)
library(BioCro)
library(latticeExtra)
</code></pre>

<h2>Discussion</h2>

</body>

</html>

